<!DOCTYPE html><html><head><meta charset="UTF-8"><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-bash.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-c.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-go.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-json.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-markup.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-none.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-protobuf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-python.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-sql.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-toml.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-yaml.min.js"></script><style>
        .article {
            position: relative;
            padding-bottom: 24px;
        }
        

        .bordered-element-rounded {
            border: 1px solid #c4c4c4;
            border-radius: 7px;
            overflow: hidden;
        }
        

        .code-block {
            overflow: hidden;
            position: relative;
            padding: 0;
            border-radius: 8px;
            font-variant-ligatures: none;
            background-color: rgba(25, 25, 28, .05);
            word-break: break-all;
        }
        

        .control {
            color: #19191c;
            font-size: 16px;
            font-weight: 670;
        }
        

        .detached {
            margin-block-start: 0;
            margin-block-end: 0;
            margin-bottom: 8px;
        }
        

        .emphasis {
            color: inherit;
            font-weight: inherit;
            font-style: italic;
        }
        

        .flex {
            display: flex;
        }
        

        .header-row {
            background: #e6e6e6;
        }
        

        .inline-code {
            border-radius: 4px;
            display: inline;
            padding: 2px 1px;
            font-family: JetBrains Sans,monospace;
            background: #e6e6e6;
        }
        

        .list {
            list-style-type: disc;
            padding-left: 0;
            margin-left: 15px;
        }
        

        .list-decimal {
            list-style-type: decimal;
        }
        

        .list-item {
            margin-top: 6px;
            margin-bottom: 6px;
            margin-left: 4px;
        }
        

        .main-title {
            padding-bottom: 24px;
            margin-top: 0;
            font-size: 40px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        

        .mermaid {
            page-break-inside: avoid;
        }
        
        /* Light theme */
/** Common */
#mermaid .label, #mermaid {font-family:"trebuchet ms",arial,sans-serif; font-size:16px;fill:#333;}#mermaid .error-icon{fill:#552222;}#mermaid .error-text{fill:#552222;stroke:#552222;}#mermaid .edge-thickness-normal{stroke-width:2px;}#mermaid .edge-thickness-thick{stroke-width:3.5px;}#mermaid .edge-pattern-solid{stroke-dasharray:0;}#mermaid .edge-pattern-dashed{stroke-dasharray:3;}#mermaid .edge-pattern-dotted{stroke-dasharray:2;}#mermaid .marker{fill:#333333;stroke:#333333;}#mermaid .marker.cross{stroke:#333333;} #mermaid {max-width: 100%;}
/** Flowchart */
#mermaid .cluster-label text{fill:#333;}#mermaid .cluster-label span{color:#333;}#mermaid .label text,#mermaid span{fill:#333;color:#333;}#mermaid .node rect,#mermaid .node circle,#mermaid .node ellipse,#mermaid .node polygon,#mermaid .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid .node .label{text-align:center;}#mermaid .node.clickable{cursor:pointer;}#mermaid .arrowheadPath{fill:#333333;}#mermaid .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid .flowchart-link{stroke:#333333;fill:none;}#mermaid .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid .cluster text{fill:#333;}#mermaid .cluster span{color:#333;}#mermaid div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}
/** Sequence diagram */
#mermaid .actor{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid text.actor>tspan{fill:black;stroke:none;}#mermaid .actor-line{stroke:grey;}#mermaid .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#mermaid .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#mermaid #arrowhead path{fill:#333;stroke:#333;}#mermaid .sequenceNumber{fill:white;}#mermaid #sequencenumber{fill:#333;}#mermaid #crosshead path{fill:#333;stroke:#333;}#mermaid .messageText{fill:#333;stroke:none;}#mermaid .labelBox{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid .labelText,#mermaid .labelText>tspan{fill:black;stroke:none;}#mermaid .loopText,#mermaid .loopText>tspan{fill:black;stroke:none;}#mermaid .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#mermaid .note{stroke:#aaaa33;fill:#fff5ad;}#mermaid .noteText,#mermaid .noteText>tspan{fill:black;stroke:none;}#mermaid .activation0{fill:#f4f4f4;stroke:#666;}#mermaid .activation1{fill:#f4f4f4;stroke:#666;}#mermaid .activation2{fill:#f4f4f4;stroke:#666;}#mermaid .actorPopupMenu{position:absolute;}#mermaid .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));}#mermaid .actor-man line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid .actor-man circle,#mermaid line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;stroke-width:2px;}
/** Gantt */
#mermaid .exclude-range{fill:#eeeeee;}#mermaid .section{stroke:none;opacity:0.2;}#mermaid .section0{fill:rgba(102, 102, 255, 0.49);}#mermaid .section2{fill:#fff400;}#mermaid .section1,#mermaid .section3{fill:white;opacity:0.2;}#mermaid .sectionTitle0{fill:#333;}#mermaid .sectionTitle1{fill:#333;}#mermaid .sectionTitle2{fill:#333;}#mermaid .sectionTitle3{fill:#333;}#mermaid .sectionTitle{text-anchor:start;}#mermaid .grid .tick{stroke:lightgrey;opacity:0.8;shape-rendering:crispEdges;}#mermaid .grid .tick text{fill:#333;}#mermaid .grid path{stroke-width:0;}#mermaid .today{fill:none;stroke:red;stroke-width:2px;}#mermaid .task{stroke-width:2;}#mermaid .taskText{text-anchor:middle;}#mermaid .taskTextOutsideRight{fill:black;text-anchor:start;}#mermaid .taskTextOutsideLeft{fill:black;text-anchor:end;}#mermaid .task.clickable{cursor:pointer;}#mermaid .taskText.clickable{cursor:pointer;fill:#003163!important;font-weight:bold;}#mermaid .taskTextOutsideLeft.clickable{cursor:pointer;fill:#003163!important;font-weight:bold;}#mermaid .taskTextOutsideRight.clickable{cursor:pointer;fill:#003163!important;font-weight:bold;}#mermaid .taskText0,#mermaid .taskText1,#mermaid .taskText2,#mermaid .taskText3{fill:white;}#mermaid .task0,#mermaid .task1,#mermaid .task2,#mermaid .task3{fill:#8a90dd;stroke:#534fbc;}#mermaid .taskTextOutside0,#mermaid .taskTextOutside2{fill:black;}#mermaid .taskTextOutside1,#mermaid .taskTextOutside3{fill:black;}#mermaid .active0,#mermaid .active1,#mermaid .active2,#mermaid .active3{fill:#bfc7ff;stroke:#534fbc;}#mermaid .activeText0,#mermaid .activeText1,#mermaid .activeText2,#mermaid .activeText3{fill:black!important;}#mermaid .done0,#mermaid .done1,#mermaid .done2,#mermaid .done3{stroke:grey;fill:lightgrey;stroke-width:2;}#mermaid .doneText0,#mermaid .doneText1,#mermaid .doneText2,#mermaid .doneText3{fill:black!important;}#mermaid .crit0,#mermaid .crit1,#mermaid .crit2,#mermaid .crit3{stroke:#ff8888;fill:red;stroke-width:2;}#mermaid .activeCrit0,#mermaid .activeCrit1,#mermaid .activeCrit2,#mermaid .activeCrit3{stroke:#ff8888;fill:#bfc7ff;stroke-width:2;}#mermaid .doneCrit0,#mermaid .doneCrit1,#mermaid .doneCrit2,#mermaid .doneCrit3{stroke:#ff8888;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges;}#mermaid .milestone{transform:rotate(45deg) scale(0.8,0.8);}#mermaid .milestoneText{font-style:italic;}#mermaid .doneCritText0,#mermaid .doneCritText1,#mermaid .doneCritText2,#mermaid .doneCritText3{fill:black!important;}#mermaid .activeCritText0,#mermaid .activeCritText1,#mermaid .activeCritText2,#mermaid .activeCritText3{fill:black!important;}#mermaid .titleText{text-anchor:middle;font-size:18px;fill:#333;}
/** Class diagram */
#mermaid g.classGroup text{fill:#9370DB;fill:#131300;stroke:none;font-size:10px;}#mermaid g.classGroup text .title{font-weight:bolder;}#mermaid .nodeLabel,#mermaid .edgeLabel{color:#131300;}#mermaid .edgeLabel .label rect{fill:#ECECFF;}#mermaid .label text{fill:#131300;}#mermaid .edgeLabel .label span{background:#ECECFF;}#mermaid .classTitle{font-weight:bolder;}#mermaid .node rect,#mermaid .node circle,#mermaid .node ellipse,#mermaid .node polygon,#mermaid .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid .divider{stroke:#9370DB;stroke:1;}#mermaid g.clickable{cursor:pointer;}#mermaid g.classGroup rect{fill:#ECECFF;stroke:#9370DB;}#mermaid g.classGroup line{stroke:#9370DB;stroke-width:1;}#mermaid .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5;}#mermaid .classLabel .label{fill:#9370DB;font-size:10px;}#mermaid .relation{stroke:#333333;stroke-width:1;fill:none;}#mermaid .dashed-line{stroke-dasharray:3;}#mermaid #compositionStart,#mermaid .composition{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid #compositionEnd,#mermaid .composition{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid #dependencyStart,#mermaid .dependency{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid #dependencyStart,#mermaid .dependency{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid #extensionStart,#mermaid .extension{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid #extensionEnd,#mermaid .extension{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid #aggregationStart,#mermaid .aggregation{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid #aggregationEnd,#mermaid .aggregation{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid #lollipopStart,#mermaid .lollipop{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid #lollipopEnd,#mermaid .lollipop{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid .edgeTerminals{font-size:11px;}
/** Git graph */
#mermaid .commit-id,#mermaid .commit-msg{fill:lightgrey;}#mermaid .commit0{stroke:hsl(240, 100%, 46.2745098039%);fill:hsl(240, 100%, 46.2745098039%);}#mermaid .commit-highlight0{stroke:hsl(60, 100%, 3.7254901961%);fill:hsl(60, 100%, 3.7254901961%);}#mermaid .label0{fill:hsl(240, 100%, 46.2745098039%);}#mermaid .arrow0{stroke:hsl(240, 100%, 46.2745098039%);}#mermaid .branch-label1{fill:black;}#mermaid .commit1{stroke:hsl(60, 100%, 43.5294117647%);fill:hsl(60, 100%, 43.5294117647%);}#mermaid .commit-highlight1{stroke:rgb(0, 0, 160.5);fill:rgb(0, 0, 160.5);}#mermaid .label1{fill:hsl(60, 100%, 43.5294117647%);}#mermaid .arrow1{stroke:hsl(60, 100%, 43.5294117647%);}#mermaid .branch-label2{fill:black;}#mermaid .commit2{stroke:hsl(80, 100%, 46.2745098039%);fill:hsl(80, 100%, 46.2745098039%);}#mermaid .commit-highlight2{stroke:rgb(48.8333333334, 0, 146.5000000001);fill:rgb(48.8333333334, 0, 146.5000000001);}#mermaid .label2{fill:hsl(80, 100%, 46.2745098039%);}#mermaid .arrow2{stroke:hsl(80, 100%, 46.2745098039%);}#mermaid .branch-label3{fill:#ffffff;}#mermaid .commit3{stroke:hsl(210, 100%, 46.2745098039%);fill:hsl(210, 100%, 46.2745098039%);}#mermaid .commit-highlight3{stroke:rgb(146.5000000001, 73.2500000001, 0);fill:rgb(146.5000000001, 73.2500000001, 0);}#mermaid .label3{fill:hsl(210, 100%, 46.2745098039%);}#mermaid .arrow3{stroke:hsl(210, 100%, 46.2745098039%);}#mermaid .branch-label4{fill:black;}#mermaid .commit4{stroke:hsl(180, 100%, 46.2745098039%);fill:hsl(180, 100%, 46.2745098039%);}#mermaid .commit-highlight4{stroke:rgb(146.5000000001, 0, 0);fill:rgb(146.5000000001, 0, 0);}#mermaid .label4{fill:hsl(180, 100%, 46.2745098039%);}#mermaid .arrow4{stroke:hsl(180, 100%, 46.2745098039%);}#mermaid .branch-label5{fill:black;}#mermaid .commit5{stroke:hsl(150, 100%, 46.2745098039%);fill:hsl(150, 100%, 46.2745098039%);}#mermaid .commit-highlight5{stroke:rgb(146.5000000001, 0, 73.2500000001);fill:rgb(146.5000000001, 0, 73.2500000001);}#mermaid .label5{fill:hsl(150, 100%, 46.2745098039%);}#mermaid .arrow5{stroke:hsl(150, 100%, 46.2745098039%);}#mermaid .branch-label6{fill:black;}#mermaid .commit6{stroke:hsl(300, 100%, 46.2745098039%);fill:hsl(300, 100%, 46.2745098039%);}#mermaid .commit-highlight6{stroke:rgb(0, 146.5000000001, 0);fill:rgb(0, 146.5000000001, 0);}#mermaid .label6{fill:hsl(300, 100%, 46.2745098039%);}#mermaid .arrow6{stroke:hsl(300, 100%, 46.2745098039%);}#mermaid .branch-label7{fill:black;}#mermaid .commit7{stroke:hsl(0, 100%, 46.2745098039%);fill:hsl(0, 100%, 46.2745098039%);}#mermaid .commit-highlight7{stroke:rgb(0, 146.5000000001, 146.5000000001);fill:rgb(0, 146.5000000001, 146.5000000001);}#mermaid .label7{fill:hsl(0, 100%, 46.2745098039%);}#mermaid .arrow7{stroke:hsl(0, 100%, 46.2745098039%);}#mermaid .branch{stroke-width:1;stroke:#333333;stroke-dasharray:2;}#mermaid .commit-label{font-size:10px;fill:#000021;}#mermaid .commit-label-bkg{font-size:10px;fill:#ffffde;opacity:0.5;}#mermaid .tag-label{font-size:10px;fill:#131300;}#mermaid .tag-label-bkg{fill:#ECECFF;stroke:hsl(240, 60%, 86.2745098039%);}#mermaid .tag-hole{fill:#333;}#mermaid .commit-merge{stroke:#ECECFF;fill:#ECECFF;}#mermaid .commit-reverse{stroke:#ECECFF;fill:#ECECFF;stroke-width:3;}#mermaid .commit-highlight-inner{stroke:#ECECFF;fill:#ECECFF;}#mermaid .arrow{stroke-width:8;stroke-linecap:round;fill:none;}
#mermaid .branchLabel .label {font-size:16px;} #mermaid g.label.branch-label0 text, #mermaid g.label.branch-label3 text { fill: #eee; }
/** Entity relationship */
#mermaid .entityBox{fill:#ECECFF;stroke:#9370DB;}#mermaid .attributeBoxOdd{fill:#ffffff;stroke:#9370DB;}#mermaid .attributeBoxEven{fill:#f2f2f2;stroke:#9370DB;}#mermaid .relationshipLabelBox{fill:hsl(80, 100%, 96.2745098039%);opacity:0.7;background-color:hsl(80, 100%, 96.2745098039%);}#mermaid .relationshipLabelBox rect{opacity:0.5;}#mermaid .relationshipLine{stroke:#333333;}
/** Journey */
#mermaid .label{color:#333;}#mermaid .mouth{stroke:#666;}#mermaid line{stroke:#333;}#mermaid .legend{fill:#333;}#mermaid .label text{fill:#333;}#mermaid .label{color:#333;}#mermaid .face{fill:#FFF8DC;stroke:#999;}#mermaid .node rect,#mermaid .node circle,#mermaid .node ellipse,#mermaid .node polygon,#mermaid .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid .node .label{text-align:center;}#mermaid .node.clickable{cursor:pointer;}#mermaid .arrowheadPath{fill:#333333;}#mermaid .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid .flowchart-link{stroke:#333333;fill:none;}#mermaid .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid .edgeLabel rect{opacity:0.5;}#mermaid .cluster text{fill:#333;}#mermaid div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid .task-type-0,#mermaid .section-type-0{fill:#ECECFF;}#mermaid .task-type-1,#mermaid .section-type-1{fill:#ffffde;}#mermaid .task-type-2,#mermaid .section-type-2{fill:hsl(304, 100%, 96.2745098039%);}#mermaid .task-type-3,#mermaid .section-type-3{fill:hsl(124, 100%, 93.5294117647%);}#mermaid .task-type-4,#mermaid .section-type-4{fill:hsl(176, 100%, 96.2745098039%);}#mermaid .task-type-5,#mermaid .section-type-5{fill:hsl(-4, 100%, 93.5294117647%);}#mermaid .task-type-6,#mermaid .section-type-6{fill:hsl(8, 100%, 96.2745098039%);}#mermaid .task-type-7,#mermaid .section-type-7{fill:hsl(188, 100%, 93.5294117647%);}
/** State diagram */
#mermaid defs #statediagram-barbEnd{fill:#333333;stroke:#333333;}#mermaid g.stateGroup text{fill:#9370DB;stroke:none;font-size:10px;}#mermaid g.stateGroup text{fill:#333;stroke:none;font-size:10px;}#mermaid g.stateGroup .state-title{font-weight:bolder;fill:#131300;}#mermaid g.stateGroup rect{fill:#ECECFF;stroke:#9370DB;}#mermaid g.stateGroup line{stroke:#333333;stroke-width:1;}#mermaid .transition{stroke:#333333;stroke-width:1;fill:none;}#mermaid .stateGroup .composit{fill:white;border-bottom:1px;}#mermaid .stateGroup .alt-composit{fill:#e0e0e0;border-bottom:1px;}#mermaid .state-note{stroke:#aaaa33;fill:#fff5ad;}#mermaid .state-note text{fill:black;stroke:none;font-size:10px;}#mermaid .stateLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5;}#mermaid .edgeLabel .label rect{fill:#ECECFF;opacity:0.5;}#mermaid .edgeLabel .label text{fill:#333;}#mermaid .label div .edgeLabel{color:#333;}#mermaid .stateLabel text{fill:#131300;font-size:10px;font-weight:bold;}#mermaid .node circle.state-start{fill:#333333;stroke:#333333;}#mermaid .node .fork-join{fill:#333333;stroke:#333333;}#mermaid .node circle.state-end{fill:#9370DB;stroke:white;stroke-width:1.5;}#mermaid .end-state-inner{fill:white;stroke-width:1.5;}#mermaid .node rect{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid .node polygon{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid #statediagram-barbEnd{fill:#333333;}#mermaid .statediagram-cluster rect{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid .cluster-label,#mermaid .nodeLabel{color:#131300;}#mermaid .statediagram-cluster rect.outer{rx:5px;ry:5px;}#mermaid .statediagram-state .divider{stroke:#9370DB;}#mermaid .statediagram-state .title-state{rx:5px;ry:5px;}#mermaid .statediagram-cluster.statediagram-cluster .inner{fill:white;}#mermaid .statediagram-cluster.statediagram-cluster-alt .inner{fill:#f0f0f0;}#mermaid .statediagram-cluster .inner{rx:0;ry:0;}#mermaid .statediagram-state rect.basic{rx:5px;ry:5px;}#mermaid .statediagram-state rect.divider{stroke-dasharray:10,10;fill:#f0f0f0;}#mermaid .note-edge{stroke-dasharray:5;}#mermaid .statediagram-note rect{fill:#fff5ad;stroke:#aaaa33;stroke-width:1px;rx:0;ry:0;}#mermaid .statediagram-note rect{fill:#fff5ad;stroke:#aaaa33;stroke-width:1px;rx:0;ry:0;}#mermaid .statediagram-note text{fill:black;}#mermaid .statediagram-note .nodeLabel{color:black;}#mermaid .statediagram .edgeLabel{color:red;}#mermaid #dependencyStart,#mermaid #dependencyEnd{fill:#333333;stroke:#333333;stroke-width:1;}
/** Pie chart */
#mermaid .pieCircle{stroke:#222;stroke-width:1px;}#mermaid .pieTitleText{text-anchor:middle;font-size:25px;fill:black;}#mermaid .slice{fill:#333;font-size:17px;}#mermaid .legend text{fill:black;font-size:17px;}
/** Requirements */
#mermaid marker{fill:#333333;stroke:#333333;}#mermaid marker.cross{stroke:#333333;}#mermaid svg{font-size:16px;}#mermaid .reqBox{fill:#ECECFF;fill-opacity:100%;stroke:hsl(240, 60%, 86.2745098039%);stroke-width:hsl(240, 60%, 86.2745098039%);}#mermaid .reqTitle,#mermaid .reqLabel{fill:#131300;}#mermaid .reqLabelBox{fill:#e8e8e8;fill-opacity:100%;}#mermaid .req-title-line{stroke:hsl(240, 60%, 86.2745098039%);stroke-width:hsl(240, 60%, 86.2745098039%);}#mermaid .relationshipLine{stroke:#333333;stroke-width:1;}#mermaid .relationshipLabel{fill:black;}
/** C4 system */
#mermaid .person{stroke:calculated;fill:calculated;}
/** Mind map */
#mermaid .section-root.mindmap-node { fill: hsl(240, 100%, 50%); } #mermaid .section-root.mindmap-node text { fill: white; }
#mermaid .mindmap-edges .edge-depth-0 { stroke-width: 14; }
#mermaid .mindmap-edges .edge-depth-1 { stroke-width: 11; }
#mermaid .mindmap-edges .edge-depth-2 { stroke-width: 8; }
#mermaid .mindmap-edges .edge-depth-3 { stroke-width: 5; }
#mermaid .mindmap-edges .edge-depth-4 { stroke-width: 3; }
#mermaid .mindmap-edges .edge-depth-5 { stroke-width: 2; }
#mermaid .mindmap-edges .edge-depth-6 { stroke-width: 1; }
#mermaid .mindmap-edges .section-edge-0,  #mermaid .mindmap-node.section-0  path { fill: hsl(60, 100%, 70%); stroke: hsl(60, 100%, 70%); } #mermaid .mindmap-node.section-0  text { fill: black; }
#mermaid .mindmap-edges .section-edge-1,  #mermaid .mindmap-node.section-1  path { fill: hsl(170, 90%, 70%); stroke: hsl(170, 90%, 70%); } #mermaid .mindmap-node.section-1  text { fill: black; }
#mermaid .mindmap-edges .section-edge-2,  #mermaid .mindmap-node.section-2  path { fill: hsl(280, 90%, 70%); stroke: hsl(280, 90%, 70%); } #mermaid .mindmap-node.section-2  text { fill: white; }
#mermaid .mindmap-edges .section-edge-3,  #mermaid .mindmap-node.section-3  path { fill: hsl(30, 90%, 70%);  stroke: hsl(30, 90%, 70%);  } #mermaid .mindmap-node.section-3  text { fill: black; }
#mermaid .mindmap-edges .section-edge-4,  #mermaid .mindmap-node.section-4  path { fill: hsl(140, 90%, 70%); stroke: hsl(140, 90%, 70%); } #mermaid .mindmap-node.section-4  text { fill: black; }
#mermaid .mindmap-edges .section-edge-5,  #mermaid .mindmap-node.section-5  path { fill: hsl(250, 90%, 70%); stroke: hsl(250, 90%, 70%); } #mermaid .mindmap-node.section-5  text { fill: white; }
#mermaid .mindmap-edges .section-edge-6,  #mermaid .mindmap-node.section-6  path { fill: hsl(0, 90%, 70%);   stroke: hsl(0, 90%, 70%);   } #mermaid .mindmap-node.section-6  text { fill: black; }
#mermaid .mindmap-edges .section-edge-7,  #mermaid .mindmap-node.section-7  path { fill: hsl(110, 90%, 70%); stroke: hsl(110, 90%, 70%); } #mermaid .mindmap-node.section-7  text { fill: black; }
#mermaid .mindmap-edges .section-edge-8,  #mermaid .mindmap-node.section-8  path { fill: hsl(220, 90%, 70%); stroke: hsl(220, 90%, 70%); } #mermaid .mindmap-node.section-8  text { fill: white; }
#mermaid .mindmap-edges .section-edge-9,  #mermaid .mindmap-node.section-9  path { fill: hsl(330, 90%, 70%); stroke: hsl(330, 90%, 70%); } #mermaid .mindmap-node.section-9  text { fill: black; }
#mermaid .mindmap-edges .section-edge-10, #mermaid .mindmap-node.section-10 path { fill: hsl(80, 90%, 70%);  stroke: hsl(80, 90%, 70%);  } #mermaid .mindmap-node.section-10 text { fill: black; }
#mermaid .mindmap-edges .section-edge-11, #mermaid .mindmap-node.section-11 path { fill: hsl(190, 90%, 70%); stroke: hsl(190, 90%, 70%); } #mermaid .mindmap-node.section-11 text { fill: black; }
#mermaid .mindmap-edges .section-edge-12, #mermaid .mindmap-node.section-12 path { fill: hsl(300, 90%, 70%); stroke: hsl(300, 90%, 70%); } #mermaid .mindmap-node.section-12 text { fill: black; }
/** Timeline */
#mermaid .timeline text tspan { fill: #222; } #mermaid .timeline-node path { fill: #ccc; }

/* Dark theme */
/** Common */
html.theme-dark #mermaid {fill:#ccc;}html.theme-dark #mermaid .error-icon{fill:#a44141;}html.theme-dark #mermaid .error-text{fill:#ddd;stroke:#ddd;}html.theme-dark #mermaid .edge-pattern-solid{stroke-dasharray:0;}html.theme-dark #mermaid .edge-pattern-dashed{stroke-dasharray:3;}html.theme-dark #mermaid .edge-pattern-dotted{stroke-dasharray:2;}html.theme-dark #mermaid .marker{fill:lightgrey;stroke:lightgrey;}html.theme-dark #mermaid .marker.cross{stroke:lightgrey;}
/** Flowchart */
html.theme-dark #mermaid .label{color:#ccc;}html.theme-dark #mermaid .cluster-label text{fill:#F9FFFE;}html.theme-dark #mermaid .cluster-label span{color:#F9FFFE;}html.theme-dark #mermaid .label text,html.theme-dark #mermaid span{fill:#ccc;color:#ccc;}html.theme-dark #mermaid .node rect,html.theme-dark #mermaid .node circle,html.theme-dark #mermaid .node ellipse,html.theme-dark #mermaid .node polygon,html.theme-dark #mermaid .node path{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}html.theme-dark #mermaid .node .label{text-align:center;}html.theme-dark #mermaid .node.clickable{cursor:pointer;}html.theme-dark #mermaid .arrowheadPath{fill:lightgrey;}html.theme-dark #mermaid .edgePath .path{stroke:lightgrey;stroke-width:2.0px;}html.theme-dark #mermaid .flowchart-link{stroke:lightgrey;fill:none;}html.theme-dark #mermaid .edgeLabel{background-color:hsl(0, 0%, 34.4117647059%);text-align:center;}html.theme-dark #mermaid .edgeLabel rect{opacity:0.5;background-color:hsl(0, 0%, 34.4117647059%);fill:hsl(0, 0%, 34.4117647059%);}html.theme-dark #mermaid .cluster rect{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:rgba(255, 255, 255, 0.25);stroke-width:1px;}html.theme-dark #mermaid .cluster text{fill:#F9FFFE;}html.theme-dark #mermaid .cluster span{color:#F9FFFE;}html.theme-dark #mermaid div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;background:hsl(20, 1.5873015873%, 12.3529411765%);border:1px solid rgba(255, 255, 255, 0.25);border-radius:2px;pointer-events:none;z-index:100;}html.theme-dark #mermaid :root{--mermaid-}
/** Sequence diagram */
html.theme-dark #mermaid .actor{stroke:#81B1DB;fill:#1f2020;}html.theme-dark #mermaid text.actor>tspan{fill:lightgrey;stroke:none;}html.theme-dark #mermaid .actor-line{stroke:lightgrey;}html.theme-dark #mermaid .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:lightgrey;}html.theme-dark #mermaid .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:lightgrey;}html.theme-dark #mermaid #arrowhead path{fill:lightgrey;stroke:lightgrey;}html.theme-dark #mermaid .sequenceNumber{fill:black;}html.theme-dark #mermaid #sequencenumber{fill:lightgrey;}html.theme-dark #mermaid #crosshead path{fill:lightgrey;stroke:lightgrey;}html.theme-dark #mermaid .messageText{fill:lightgrey;stroke:none;}html.theme-dark #mermaid .labelBox{stroke:#81B1DB;fill:#1f2020;}html.theme-dark #mermaid .labelText,html.theme-dark #mermaid .labelText>tspan{fill:lightgrey;stroke:none;}html.theme-dark #mermaid .loopText,html.theme-dark #mermaid .loopText>tspan{fill:lightgrey;stroke:none;}html.theme-dark #mermaid .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:#81B1DB;fill:#81B1DB;}html.theme-dark #mermaid .note{stroke:hsl(180, 0%, 18.3529411765%);fill:hsl(180, 1.5873015873%, 28.3529411765%);}html.theme-dark #mermaid .noteText,html.theme-dark #mermaid .noteText>tspan{fill:rgb(183.8476190475, 181.5523809523, 181.5523809523);stroke:none;}html.theme-dark #mermaid .activation0{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:#81B1DB;}html.theme-dark #mermaid .activation1{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:#81B1DB;}html.theme-dark #mermaid .activation2{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:#81B1DB;}html.theme-dark #mermaid .actorPopupMenu{position:absolute;}html.theme-dark #mermaid .actorPopupMenuPanel{position:absolute;fill:#1f2020;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));}html.theme-dark #mermaid .actor-man line{stroke:#81B1DB;fill:#1f2020;}html.theme-dark #mermaid .actor-man circle,html.theme-dark #mermaid line{stroke:#81B1DB;fill:#1f2020;stroke-width:2px;}html.theme-dark #mermaid :root{--mermaid-}
/** Gantt */
html.theme-dark #mermaid .exclude-range{fill:#444;}html.theme-dark #mermaid .section{stroke:none;opacity:0.2;}html.theme-dark #mermaid .section0{fill:hsl(52.9411764706, 28.813559322%, 58.431372549%);}html.theme-dark #mermaid .section2{fill:#EAE8D9;}html.theme-dark #mermaid .section1,html.theme-dark #mermaid .section3{fill:#333;opacity:0.2;}html.theme-dark #mermaid .sectionTitle0{fill:#F9FFFE;}html.theme-dark #mermaid .sectionTitle1{fill:#F9FFFE;}html.theme-dark #mermaid .sectionTitle2{fill:#F9FFFE;}html.theme-dark #mermaid .sectionTitle3{fill:#F9FFFE;}html.theme-dark #mermaid .sectionTitle{text-anchor:start;}html.theme-dark #mermaid .grid .tick{stroke:lightgrey;opacity:0.8;shape-rendering:crispEdges;}html.theme-dark #mermaid .grid .tick text{fill:#ccc;}html.theme-dark #mermaid .grid path{stroke-width:0;}html.theme-dark #mermaid .today{fill:none;stroke:#DB5757;stroke-width:2px;}html.theme-dark #mermaid .task{stroke-width:2;}html.theme-dark #mermaid .taskText{text-anchor:middle;}html.theme-dark #mermaid .taskTextOutsideRight{fill:hsl(28.5714285714, 17.3553719008%, 86.2745098039%);text-anchor:start;}html.theme-dark #mermaid .taskTextOutsideLeft{fill:hsl(28.5714285714, 17.3553719008%, 86.2745098039%);text-anchor:end;}html.theme-dark #mermaid .task.clickable{cursor:pointer;}html.theme-dark #mermaid .taskText.clickable{cursor:pointer;fill:#003163!important;font-weight:bold;}html.theme-dark #mermaid .taskTextOutsideLeft.clickable{cursor:pointer;fill:#003163!important;font-weight:bold;}html.theme-dark #mermaid .taskTextOutsideRight.clickable{cursor:pointer;fill:#003163!important;font-weight:bold;}html.theme-dark #mermaid .taskText0,html.theme-dark #mermaid .taskText1,html.theme-dark #mermaid .taskText2,html.theme-dark #mermaid .taskText3{fill:hsl(28.5714285714, 17.3553719008%, 86.2745098039%);}html.theme-dark #mermaid .task0,html.theme-dark #mermaid .task1,html.theme-dark #mermaid .task2,html.theme-dark #mermaid .task3{fill:hsl(180, 1.5873015873%, 35.3529411765%);stroke:#ffffff;}html.theme-dark #mermaid .taskTextOutside0,html.theme-dark #mermaid .taskTextOutside2{fill:lightgrey;}html.theme-dark #mermaid .taskTextOutside1,html.theme-dark #mermaid .taskTextOutside3{fill:lightgrey;}html.theme-dark #mermaid .active0,html.theme-dark #mermaid .active1,html.theme-dark #mermaid .active2,html.theme-dark #mermaid .active3{fill:#81B1DB;stroke:#ffffff;}html.theme-dark #mermaid .activeText0,html.theme-dark #mermaid .activeText1,html.theme-dark #mermaid .activeText2,html.theme-dark #mermaid .activeText3{fill:hsl(28.5714285714, 17.3553719008%, 86.2745098039%)!important;}html.theme-dark #mermaid .done0,html.theme-dark #mermaid .done1,html.theme-dark #mermaid .done2,html.theme-dark #mermaid .done3{stroke:grey;fill:lightgrey;stroke-width:2;}html.theme-dark #mermaid .doneText0,html.theme-dark #mermaid .doneText1,html.theme-dark #mermaid .doneText2,html.theme-dark #mermaid .doneText3{fill:hsl(28.5714285714, 17.3553719008%, 86.2745098039%)!important;}html.theme-dark #mermaid .crit0,html.theme-dark #mermaid .crit1,html.theme-dark #mermaid .crit2,html.theme-dark #mermaid .crit3{stroke:#E83737;fill:#E83737;stroke-width:2;}html.theme-dark #mermaid .activeCrit0,html.theme-dark #mermaid .activeCrit1,html.theme-dark #mermaid .activeCrit2,html.theme-dark #mermaid .activeCrit3{stroke:#E83737;fill:#81B1DB;stroke-width:2;}html.theme-dark #mermaid .doneCrit0,html.theme-dark #mermaid .doneCrit1,html.theme-dark #mermaid .doneCrit2,html.theme-dark #mermaid .doneCrit3{stroke:#E83737;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges;}html.theme-dark #mermaid .milestone{transform:rotate(45deg) scale(0.8,0.8);}html.theme-dark #mermaid .milestoneText{font-style:italic;}html.theme-dark #mermaid .doneCritText0,html.theme-dark #mermaid .doneCritText1,html.theme-dark #mermaid .doneCritText2,html.theme-dark #mermaid .doneCritText3{fill:hsl(28.5714285714, 17.3553719008%, 86.2745098039%)!important;}html.theme-dark #mermaid .activeCritText0,html.theme-dark #mermaid .activeCritText1,html.theme-dark #mermaid .activeCritText2,html.theme-dark #mermaid .activeCritText3{fill:hsl(28.5714285714, 17.3553719008%, 86.2745098039%)!important;}html.theme-dark #mermaid .titleText{text-anchor:middle;fill:#ccc;}html.theme-dark #mermaid :root{--mermaid-}
/** Class diagram */
html.theme-dark #mermaid g.classGroup text{fill:#e0dfdf;stroke:none;}html.theme-dark #mermaid g.classGroup text .title{font-weight:bolder;}html.theme-dark #mermaid .nodeLabel,html.theme-dark #mermaid .edgeLabel{color:#e0dfdf;}html.theme-dark #mermaid .edgeLabel .label rect{fill:#1f2020;}html.theme-dark #mermaid .label text{fill:#e0dfdf;}html.theme-dark #mermaid .edgeLabel .label span{background:#1f2020;}html.theme-dark #mermaid .classTitle{font-weight:bolder;}html.theme-dark #mermaid .node rect,html.theme-dark #mermaid .node circle,html.theme-dark #mermaid .node ellipse,html.theme-dark #mermaid .node polygon,html.theme-dark #mermaid .node path{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}html.theme-dark #mermaid .divider{stroke:#81B1DB;stroke:1;}html.theme-dark #mermaid g.clickable{cursor:pointer;}html.theme-dark #mermaid g.classGroup rect{fill:#1f2020;stroke:#81B1DB;}html.theme-dark #mermaid g.classGroup line{stroke:#81B1DB;stroke-width:1;}html.theme-dark #mermaid .classLabel .box{stroke:none;stroke-width:0;fill:#1f2020;opacity:0.5;}html.theme-dark #mermaid .classLabel .label{fill:#81B1DB;}html.theme-dark #mermaid .relation{stroke:lightgrey;stroke-width:1;fill:none;}html.theme-dark #mermaid .dashed-line{stroke-dasharray:3;}html.theme-dark #mermaid #compositionStart,html.theme-dark #mermaid .composition{fill:lightgrey!important;stroke:lightgrey!important;stroke-width:1;}html.theme-dark #mermaid #compositionEnd,html.theme-dark #mermaid .composition{fill:lightgrey!important;stroke:lightgrey!important;stroke-width:1;}html.theme-dark #mermaid #dependencyStart,html.theme-dark #mermaid .dependency{fill:lightgrey!important;stroke:lightgrey!important;stroke-width:1;}html.theme-dark #mermaid #dependencyStart,html.theme-dark #mermaid .dependency{fill:lightgrey!important;stroke:lightgrey!important;stroke-width:1;}html.theme-dark #mermaid #extensionStart,html.theme-dark #mermaid .extension{fill:lightgrey!important;stroke:lightgrey!important;stroke-width:1;}html.theme-dark #mermaid #extensionEnd,html.theme-dark #mermaid .extension{fill:lightgrey!important;stroke:lightgrey!important;stroke-width:1;}html.theme-dark #mermaid #aggregationStart,html.theme-dark #mermaid .aggregation{fill:#1f2020!important;stroke:lightgrey!important;stroke-width:1;}html.theme-dark #mermaid #aggregationEnd,html.theme-dark #mermaid .aggregation{fill:#1f2020!important;stroke:lightgrey!important;stroke-width:1;}html.theme-dark #mermaid #lollipopStart,html.theme-dark #mermaid .lollipop{fill:#1f2020!important;stroke:lightgrey!important;stroke-width:1;}html.theme-dark #mermaid #lollipopEnd,html.theme-dark #mermaid .lollipop{fill:#1f2020!important;stroke:lightgrey!important;stroke-width:1;}html.theme-dark #mermaid .edgeTerminals{}html.theme-dark #mermaid :root{--mermaid-}
/** Git graph */
html.theme-dark #mermaid .commit-id,html.theme-dark #mermaid .commit-msg,html.theme-dark #mermaid .branch-label{fill:lightgrey;color:lightgrey;}html.theme-dark #mermaid .branch-label0{fill:undefined;}html.theme-dark #mermaid .commit0{stroke:hsl(180, 1.5873015873%, 48.3529411765%);fill:hsl(180, 1.5873015873%, 48.3529411765%);}html.theme-dark #mermaid .commit-highlight0{stroke:rgb(133.6571428571, 129.7428571428, 129.7428571428);fill:rgb(133.6571428571, 129.7428571428, 129.7428571428);}html.theme-dark #mermaid .label0{fill:hsl(180, 1.5873015873%, 48.3529411765%);}html.theme-dark #mermaid .arrow0{stroke:hsl(180, 1.5873015873%, 48.3529411765%);}html.theme-dark #mermaid .branch-label1{fill:undefined;}html.theme-dark #mermaid .commit1{stroke:hsl(321.6393442623, 65.5913978495%, 38.2352941176%);fill:hsl(321.6393442623, 65.5913978495%, 38.2352941176%);}html.theme-dark #mermaid .commit-highlight1{stroke:rgb(93.5483870969, 221.4516129033, 139.677419355);fill:rgb(93.5483870969, 221.4516129033, 139.677419355);}html.theme-dark #mermaid .label1{fill:hsl(321.6393442623, 65.5913978495%, 38.2352941176%);}html.theme-dark #mermaid .arrow1{stroke:hsl(321.6393442623, 65.5913978495%, 38.2352941176%);}html.theme-dark #mermaid .branch-label2{fill:undefined;}html.theme-dark #mermaid .commit2{stroke:hsl(194.4, 16.5562913907%, 49.6078431373%);fill:hsl(194.4, 16.5562913907%, 49.6078431373%);}html.theme-dark #mermaid .commit-highlight2{stroke:rgb(149.4437086091, 117.6092715231, 107.5562913906);fill:rgb(149.4437086091, 117.6092715231, 107.5562913906);}html.theme-dark #mermaid .label2{fill:hsl(194.4, 16.5562913907%, 49.6078431373%);}html.theme-dark #mermaid .arrow2{stroke:hsl(194.4, 16.5562913907%, 49.6078431373%);}html.theme-dark #mermaid .branch-label3{fill:undefined;}html.theme-dark #mermaid .commit3{stroke:hsl(23.0769230769, 49.0566037736%, 40.7843137255%);fill:hsl(23.0769230769, 49.0566037736%, 40.7843137255%);}html.theme-dark #mermaid .commit-highlight3{stroke:rgb(99.9811320754, 162.7735849057, 202.0188679245);fill:rgb(99.9811320754, 162.7735849057, 202.0188679245);}html.theme-dark #mermaid .label3{fill:hsl(23.0769230769, 49.0566037736%, 40.7843137255%);}html.theme-dark #mermaid .arrow3{stroke:hsl(23.0769230769, 49.0566037736%, 40.7843137255%);}html.theme-dark #mermaid .branch-label4{fill:undefined;}html.theme-dark #mermaid .commit4{stroke:hsl(0, 83.3333333333%, 43.5294117647%);fill:hsl(0, 83.3333333333%, 43.5294117647%);}html.theme-dark #mermaid .commit-highlight4{stroke:rgb(51.5000000001, 236.5, 236.5);fill:rgb(51.5000000001, 236.5, 236.5);}html.theme-dark #mermaid .label4{fill:hsl(0, 83.3333333333%, 43.5294117647%);}html.theme-dark #mermaid .arrow4{stroke:hsl(0, 83.3333333333%, 43.5294117647%);}html.theme-dark #mermaid .branch-label5{fill:undefined;}html.theme-dark #mermaid .commit5{stroke:hsl(289.1666666667, 100%, 24.1176470588%);fill:hsl(289.1666666667, 100%, 24.1176470588%);}html.theme-dark #mermaid .commit-highlight5{stroke:rgb(154.2083333334, 255, 132.0000000001);fill:rgb(154.2083333334, 255, 132.0000000001);}html.theme-dark #mermaid .label5{fill:hsl(289.1666666667, 100%, 24.1176470588%);}html.theme-dark #mermaid .arrow5{stroke:hsl(289.1666666667, 100%, 24.1176470588%);}html.theme-dark #mermaid .branch-label6{fill:undefined;}html.theme-dark #mermaid .commit6{stroke:hsl(35.1315789474, 98.7012987013%, 40.1960784314%);fill:hsl(35.1315789474, 98.7012987013%, 40.1960784314%);}html.theme-dark #mermaid .commit-highlight6{stroke:rgb(51.331168831, 135.1948051946, 253.6688311688);fill:rgb(51.331168831, 135.1948051946, 253.6688311688);}html.theme-dark #mermaid .label6{fill:hsl(35.1315789474, 98.7012987013%, 40.1960784314%);}html.theme-dark #mermaid .arrow6{stroke:hsl(35.1315789474, 98.7012987013%, 40.1960784314%);}html.theme-dark #mermaid .branch-label7{fill:undefined;}html.theme-dark #mermaid .commit7{stroke:hsl(106.1538461538, 84.4155844156%, 35.0980392157%);fill:hsl(106.1538461538, 84.4155844156%, 35.0980392157%);}html.theme-dark #mermaid .commit-highlight7{stroke:rgb(206.1818181817, 89.948051948, 241.051948052);fill:rgb(206.1818181817, 89.948051948, 241.051948052);}html.theme-dark #mermaid .label7{fill:hsl(106.1538461538, 84.4155844156%, 35.0980392157%);}html.theme-dark #mermaid .arrow7{stroke:hsl(106.1538461538, 84.4155844156%, 35.0980392157%);}html.theme-dark #mermaid .branch{stroke-width:1;stroke:lightgrey;stroke-dasharray:2;}html.theme-dark #mermaid .commit-label{fill:rgb(183.8476190475, 181.5523809523, 181.5523809523);}html.theme-dark #mermaid .commit-label-bkg{fill:hsl(180, 1.5873015873%, 28.3529411765%);opacity:0.5;}html.theme-dark #mermaid .tag-label{fill:#e0dfdf;}html.theme-dark #mermaid .tag-label-bkg{fill:#1f2020;stroke:#cccccc;}html.theme-dark #mermaid .tag-hole{fill:#ccc;}html.theme-dark #mermaid .commit-merge{stroke:#1f2020;fill:#1f2020;}html.theme-dark #mermaid .commit-reverse{stroke:#1f2020;fill:#1f2020;stroke-width:3;}html.theme-dark #mermaid .commit-highlight-inner{stroke:#1f2020;fill:#1f2020;}html.theme-dark #mermaid .arrow{stroke-width:8;stroke-linecap:round;fill:none;}:root{--mermaid-}
/** Entity relationship */
html.theme-dark #mermaid .entityBox{fill:#1f2020;stroke:#81B1DB;}html.theme-dark #mermaid .attributeBoxOdd{fill:hsl(0, 0%, 32%);stroke:#81B1DB;}html.theme-dark #mermaid .attributeBoxEven{fill:hsl(0, 0%, 22%);stroke:#81B1DB;}html.theme-dark #mermaid .relationshipLabelBox{fill:hsl(20, 1.5873015873%, 12.3529411765%);opacity:0.7;background-color:hsl(20, 1.5873015873%, 12.3529411765%);}html.theme-dark #mermaid .relationshipLabelBox rect{opacity:0.5;}html.theme-dark #mermaid .relationshipLine{stroke:lightgrey;}html.theme-dark #mermaid :root{--mermaid-}
/** Journey */
html.theme-dark #mermaid .label{color:#ccc;}html.theme-dark #mermaid .mouth{stroke:#666;}html.theme-dark #mermaid line{stroke:#ccc;}html.theme-dark #mermaid .legend{fill:#ccc;}html.theme-dark #mermaid .label text{fill:#333;}html.theme-dark #mermaid .label{color:#ccc;}html.theme-dark #mermaid .face{fill:#FFF8DC;stroke:#999;}html.theme-dark #mermaid .node rect,html.theme-dark #mermaid .node circle,html.theme-dark #mermaid .node ellipse,html.theme-dark #mermaid .node polygon,html.theme-dark #mermaid .node path{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}html.theme-dark #mermaid .node .label{text-align:center;}html.theme-dark #mermaid .node.clickable{cursor:pointer;}html.theme-dark #mermaid .arrowheadPath{fill:lightgrey;}html.theme-dark #mermaid .edgePath .path{stroke:lightgrey;stroke-width:1.5px;}html.theme-dark #mermaid .flowchart-link{stroke:lightgrey;fill:none;}html.theme-dark #mermaid .edgeLabel{background-color:hsl(0, 0%, 34.4117647059%);text-align:center;}html.theme-dark #mermaid .edgeLabel rect{opacity:0.5;}html.theme-dark #mermaid .cluster text{fill:#F9FFFE;}html.theme-dark #mermaid div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;background:hsl(20, 1.5873015873%, 12.3529411765%);border:1px solid rgba(255, 255, 255, 0.25);border-radius:2px;pointer-events:none;z-index:100;}html.theme-dark #mermaid .task-type-0,html.theme-dark #mermaid .section-type-0{fill:#1f2020;}html.theme-dark #mermaid .task-type-1,html.theme-dark #mermaid .section-type-1{fill:hsl(180, 1.5873015873%, 28.3529411765%);}html.theme-dark #mermaid .task-type-2,html.theme-dark #mermaid .section-type-2{fill:hsl(244, 1.5873015873%, 12.3529411765%);}html.theme-dark #mermaid .task-type-3,html.theme-dark #mermaid .section-type-3{fill:hsl(244, 1.5873015873%, 28.3529411765%);}html.theme-dark #mermaid .task-type-4,html.theme-dark #mermaid .section-type-4{fill:hsl(116, 1.5873015873%, 12.3529411765%);}html.theme-dark #mermaid .task-type-5,html.theme-dark #mermaid .section-type-5{fill:hsl(116, 1.5873015873%, 28.3529411765%);}html.theme-dark #mermaid .task-type-6,html.theme-dark #mermaid .section-type-6{fill:hsl(308, 1.5873015873%, 12.3529411765%);}html.theme-dark #mermaid .task-type-7,html.theme-dark #mermaid .section-type-7{fill:hsl(308, 1.5873015873%, 28.3529411765%);}html.theme-dark #mermaid :root{--mermaid-}
/** State diagram */
html.theme-dark #mermaid defs #statediagram-barbEnd{fill:lightgrey;stroke:lightgrey;}html.theme-dark #mermaid g.stateGroup text{fill:#81B1DB;stroke:none;}html.theme-dark #mermaid g.stateGroup text{fill:#ccc;stroke:none;}html.theme-dark #mermaid g.stateGroup .state-title{font-weight:bolder;fill:#e0dfdf;}html.theme-dark #mermaid g.stateGroup rect{fill:#1f2020;stroke:#81B1DB;}html.theme-dark #mermaid g.stateGroup line{stroke:lightgrey;stroke-width:1;}html.theme-dark #mermaid .transition{stroke:lightgrey;stroke-width:1;fill:none;}html.theme-dark #mermaid .stateGroup .composit{fill:#333;border-bottom:1px;}html.theme-dark #mermaid .stateGroup .alt-composit{fill:#e0e0e0;border-bottom:1px;}html.theme-dark #mermaid .state-note{stroke:hsl(180, 0%, 18.3529411765%);fill:hsl(180, 1.5873015873%, 28.3529411765%);}html.theme-dark #mermaid .state-note text{fill:rgb(183.8476190475, 181.5523809523, 181.5523809523);stroke:none;}html.theme-dark #mermaid .stateLabel .box{stroke:none;stroke-width:0;fill:#1f2020;opacity:0.5;}html.theme-dark #mermaid .edgeLabel .label rect{fill:#1f2020;opacity:0.5;}html.theme-dark #mermaid .edgeLabel .label text{fill:#ccc;}html.theme-dark #mermaid .label div .edgeLabel{color:#ccc;}html.theme-dark #mermaid .stateLabel text{fill:#e0dfdf;font-weight:bold;}html.theme-dark #mermaid .node circle.state-start{fill:#f4f4f4;stroke:#f4f4f4;}html.theme-dark #mermaid .node .fork-join{fill:#f4f4f4;stroke:#f4f4f4;}html.theme-dark #mermaid .node circle.state-end{fill:#cccccc;stroke:#333;stroke-width:1.5;}html.theme-dark #mermaid .end-state-inner{fill:#333;stroke-width:1.5;}html.theme-dark #mermaid .node rect{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}html.theme-dark #mermaid .node polygon{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}html.theme-dark #mermaid #statediagram-barbEnd{fill:lightgrey;}html.theme-dark #mermaid .statediagram-cluster rect{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}html.theme-dark #mermaid .cluster-label,html.theme-dark #mermaid .nodeLabel{color:#e0dfdf;}html.theme-dark #mermaid .statediagram-cluster rect.outer{rx:5px;ry:5px;}html.theme-dark #mermaid .statediagram-state .divider{stroke:#81B1DB;}html.theme-dark #mermaid .statediagram-state .title-state{rx:5px;ry:5px;}html.theme-dark #mermaid .statediagram-cluster.statediagram-cluster .inner{fill:#333;}html.theme-dark #mermaid .statediagram-cluster.statediagram-cluster-alt .inner{fill:#555;}html.theme-dark #mermaid .statediagram-cluster .inner{rx:0;ry:0;}html.theme-dark #mermaid .statediagram-state rect.basic{rx:5px;ry:5px;}html.theme-dark #mermaid .statediagram-state rect.divider{stroke-dasharray:10,10;fill:#555;}html.theme-dark #mermaid .note-edge{stroke-dasharray:5;}html.theme-dark #mermaid .statediagram-note rect{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:hsl(180, 0%, 18.3529411765%);stroke-width:1px;rx:0;ry:0;}html.theme-dark #mermaid .statediagram-note rect{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:hsl(180, 0%, 18.3529411765%);stroke-width:1px;rx:0;ry:0;}html.theme-dark #mermaid .statediagram-note text{fill:rgb(183.8476190475, 181.5523809523, 181.5523809523);}html.theme-dark #mermaid .statediagram-note .nodeLabel{color:rgb(183.8476190475, 181.5523809523, 181.5523809523);}html.theme-dark #mermaid .statediagram .edgeLabel{color:red;}html.theme-dark #mermaid #dependencyStart,html.theme-dark #mermaid #dependencyEnd{fill:lightgrey;stroke:lightgrey;stroke-width:1;}html.theme-dark #mermaid :root{--mermaid-}
/** Pie chart */
html.theme-dark #mermaid .pieCircle{filter: brightness(0.7);} html.theme-dark #mermaid[aria-roledescription=pie] .legend rect { filter: brightness(0.7); } html.theme-dark #mermaid .pieTitleText{text-anchor:middle;fill:hsl(28.5714285714, 17.3553719008%, 86.2745098039%);}html.theme-dark #mermaid .slice{fill:#222;}html.theme-dark #mermaid .legend text{fill:hsl(28.5714285714, 17.3553719008%, 86.2745098039%);}html.theme-dark #mermaid :root{--mermaid-}
/** Requirements */
html.theme-dark #mermaid marker{fill:lightgrey;stroke:lightgrey;}html.theme-dark #mermaid marker.cross{stroke:lightgrey;}html.theme-dark #mermaid svg{}html.theme-dark #mermaid .reqBox{fill:#1f2020;fill-opacity:100%;stroke:#cccccc;stroke-width:#cccccc;}html.theme-dark #mermaid .reqTitle,html.theme-dark #mermaid .reqLabel{fill:#e0dfdf;}html.theme-dark #mermaid .reqLabelBox{fill:hsl(180, 1.5873015873%, 28.3529411765%);fill-opacity:100%;}html.theme-dark #mermaid .req-title-line{stroke:#cccccc;stroke-width:#cccccc;}html.theme-dark #mermaid .relationshipLine{stroke:lightgrey;stroke-width:1;}html.theme-dark #mermaid .relationshipLabel{fill:lightgrey;}html.theme-dark #mermaid :root{--mermaid-}
/** C4 system */
html.theme-dark #mermaid .person{stroke:calculated;fill:calculated;} html.theme-dark #mermaid[aria-roledescription=c4] rect {stroke: #ddd;} html.theme-dark #mermaid[aria-roledescription=c4] text {fill:#eee;}
/** Mind map */
html.theme-dark #mermaid .section-root.mindmap-node { fill: #ccc; } html.theme-dark #mermaid .section-root.mindmap-node text { fill: black; }
html.theme-dark #mermaid .mindmap-edges path, html.theme-dark #mermaid .mindmap-node { filter: hue-rotate(180deg) invert(0.9); }
/** Timeline */
html.theme-dark #mermaid .timeline text tspan { fill: #eee; } html.theme-dark #mermaid .timeline-node path { fill: #222; }

        

        .note {
            background: rgba(77, 187, 95, .2);
        }
        

        .prism {
            page-break-inside: avoid;
        }
        
        /* PrismJS 1.29.0
https://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript+abap+abnf+actionscript+ada+agda+al+antlr4+apacheconf+apex+apl+applescript+aql+arduino+arff+armasm+arturo+asciidoc+aspnet+asm6502+asmatmel+autohotkey+autoit+avisynth+avro-idl+awk+bash+basic+batch+bbcode+bbj+bicep+birb+bison+bnf+bqn+brainfuck+brightscript+bro+bsl+c+csharp+cpp+cfscript+chaiscript+cil+cilkc+cilkcpp+clojure+cmake+cobol+coffeescript+concurnas+csp+cooklang+coq+crystal+css-extras+csv+cue+cypher+d+dart+dataweave+dax+dhall+diff+django+dns-zone-file+docker+dot+ebnf+editorconfig+eiffel+ejs+elixir+elm+etlua+erb+erlang+excel-formula+fsharp+factor+false+firestore-security-rules+flow+fortran+ftl+gml+gap+gcode+gdscript+gedcom+gettext+gherkin+git+glsl+gn+linker-script+go+go-module+gradle+graphql+groovy+haml+handlebars+haskell+haxe+hcl+hlsl+hoon+http+hpkp+hsts+ichigojam+icon+icu-message-format+idris+ignore+inform7+ini+io+j+java+javadoc+javadoclike+javastacktrace+jexl+jolie+jq+jsdoc+js-extras+json+json5+jsonp+jsstacktrace+js-templates+julia+keepalived+keyman+kotlin+kumir+kusto+latex+latte+less+lilypond+liquid+lisp+livescript+llvm+log+lolcode+lua+magma+makefile+markdown+markup-templating+mata+matlab+maxscript+mel+mermaid+metafont+mizar+mongodb+monkey+moonscript+n1ql+n4js+nand2tetris-hdl+naniscript+nasm+neon+nevod+nginx+nim+nix+nsis+objectivec+ocaml+odin+opencl+openqasm+oz+parigp+parser+pascal+pascaligo+psl+pcaxis+peoplecode+perl+php+phpdoc+php-extras+plant-uml+plsql+powerquery+powershell+processing+prolog+promql+properties+protobuf+pug+puppet+pure+purebasic+purescript+python+qsharp+q+qml+qore+r+racket+cshtml+jsx+tsx+reason+regex+rego+renpy+rescript+rest+rip+roboconf+robotframework+ruby+rust+sas+sass+scss+scala+scheme+shell-session+smali+smalltalk+smarty+sml+solidity+solution-file+soy+sparql+splunk-spl+sqf+sql+squirrel+stan+stata+iecst+stylus+supercollider+swift+systemd+t4-templating+t4-cs+t4-vb+tap+tcl+tt2+textile+toml+tremor+turtle+twig+typescript+typoscript+unrealscript+uorazor+uri+v+vala+vbnet+velocity+verilog+vhdl+vim+visual-basic+warpscript+wasm+web-idl+wgsl+wiki+wolfram+wren+xeora+xml-doc+xojo+xquery+yaml+yang+zig&plugins=highlight-keywords */
code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:16px;margin:0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}

        

        .prompt {
            flex-direction: row;
            letter-spacing: .0015em;
            font-size: 16px;
            font-weight: 400;
            line-height: 24px;
            margin-left: 0;
            margin-right: 0;
        }
        

        .prompt-content {
            padding: 15px;
            overflow: hidden;
            flex: 1 1 auto;
        }
        

        .prompt-content-p p {
            margin-block-start: 0;
            margin-block-end: 0;
        }
        

        .prompt-icon {
            flex: 0 0 auto;
            margin-left: 15px;
            margin-top: 15px;
            fill: currentcolor;
            width: 24px;
            height: 24px;
        }
        

        :root {
            width: 95%;
            max-width: 95vw;
            padding: 0 0 0 30px;
        }
        
        body {
            font-family: JetBrains Sans,serif;
        }
        
        a {
            overflow-wrap: anywhere;
            width: 100vw;
        }
        
        
        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Light.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Light.woff) format("woff");
            font-weight: 300;
            font-style: normal;
        }

        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Regular.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Regular.woff) format("woff");
            font-weight: 400;
            font-style: normal;
        }

        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-SemiBold.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-SemiBold.woff) format("woff");
            font-weight: 600;
            font-style: normal;
        }
        
        
        code {
            display: inline;
            word-break: break-word;
            font-size: 15px;
            line-height: inherit;
            font-variant-ligatures: none;
            font-family: JetBrains Sans,monospace;
            white-space: pre-line;
            overflow-wrap: break-word;
        }
        
        figcaption {
            margin-top: 5px;
        }
        
        h2 {
            padding-top: 16px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        h3 {
            padding-top: 8px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        h4 {
            padding-top: 4px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        p {
            padding: 0;
            border: 0;
            line-height: 25px;
            margin-block-start: 0;
            margin-block-end: 0;
            padding-bottom: 8px;
        }
        
        div {
            display: block;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            page-break-inside: avoid;
        }
        
        th, td {
            border: 1px solid #c4c4c4;
            padding: 10px;
            text-align: left;
            word-break: break-all;
        }
        
        .no-bold {
            font-weight: normal; 
        }
        
        .entry {
            display: grid;
            grid-template-columns: auto max-content;
            grid-template-areas: "chapter page";
            align-items: end;
            gap: 0 .25rem;
            line-height: 25px;
        }
        
        .toc-link-container{
            grid-area: chapter;
            position: relative;
            overflow: hidden;
        }
        
        .toc-link{
            text-decoration: none;
            color: black;
        }
        
        .toc-link-container::after {
            position: absolute;
            padding-left: .25ch;
            content: " . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . "
            ". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . "
            ". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ";
            text-align: right;
        }
        
        .page {
            grid-area: page;
            width: 30px;
            text-align: right;
        }
        

        .table-wrapper {
            overflow: hidden;
            box-sizing: border-box;
            font: inherit;
        }
        

        .tip {
            background-color: rgba(25, 25, 28, .05);
        }
        

        .topic {
            page-break-before: always;
        }
        

        .warning {
            background: rgba(244, 92, 74, .2);
        }
        </style><title>pdfSourceLD</title></head><body><div><section class="topic"><div><article class="article"><h1 class="main-title">Table of Contents</h1><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1233099618">Bem-vindo ao Learn Docker! </a></div><div class="page">2</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-523846715">Por que Docker</a></div><div class="page">7</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-673575045">Containers vs M&aacute;quinas Virtuais</a></div><div class="page">12</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1140582937">Hist&oacute;ria do Docker</a></div><div class="page">22</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-867919447">Instala&ccedil;&atilde;o do Docker </a></div><div class="page">29</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-2046990398">Docker Desktop vs CLI: Escolha sua Arma </a></div><div class="page">30</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-302725924">Problemas Comuns: Debugando na Matrix </a></div><div class="page">35</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#871964087">Containers 101</a></div><div class="page">41</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#896684810">Container Internals: Como Funciona Por Dentro </a></div><div class="page">64</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#2096623244">Container Runtime: O Motor dos Containers </a></div><div class="page">74</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#684732172">Seguran&ccedil;a de Containers </a></div><div class="page">89</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-459582987">Orquestra&ccedil;&atilde;o de Containers: A Sinfonia do Caos Digital</a></div><div class="page">100</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1175689492">Container Monitoring: Os Olhos do Sistema </a></div><div class="page">109</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-796822905">Images vs Containers: O Dual Boot do Futuro </a></div><div class="page">119</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#902649088">Fundamentos de Imagens Docker </a></div><div class="page">124</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1554569929">Anatomia de uma Imagem Docker </a></div><div class="page">130</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#486630389">Gerenciamento de Imagens Docker </a></div><div class="page">136</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-672215880">Opera&ccedil;&otilde;es com Containers: O Manual do Operador </a></div><div class="page">142</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1223070191">Melhores Pr&aacute;ticas Docker: O Caminho do Mestre </a></div><div class="page">149</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#659198120">Laborat&oacute;rio Pr&aacute;tico: M&atilde;o na Massa! </a></div><div class="page">156</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1568904649">Guia de Troubleshooting: Debugando na Matrix </a></div><div class="page">163</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#853611488">Arquitetura Docker: O Blueprint da Matrix </a></div><div class="page">169</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1713301678">CLI Basics: Dominando o Terminal Docker </a></div><div class="page">176</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-271055979">Docker Commands: O Arsenal Completo </a></div><div class="page">183</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-143566139">Docker Images: Blueprint do Seu Container </a></div><div class="page">190</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#91498782">Ciclo de Vida dos Containers: Do Nascimento &agrave; Transcend&ecirc;ncia </a></div><div class="page">201</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1154622528">Container Networking</a></div><div class="page">211</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1338613457">Container Storage: Cr&ocirc;nicas dos Dados Perdidos </a></div><div class="page">223</div></div></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1233099618">Bem-vindo ao Learn Docker! <span class="no-bold"></span></h1><div class="detached code-block" id="1233099618#z58rpz7_3"><pre><code class="language-none">
       
 
             
             
    
        
                                                  
               
            CONTAINERS AS CODE = LIFE            
               

        
             [ CYBERPUNK EDITION 2025 ]    
        

     
      BUILD ONCE       RUN ANYWHERE       SHIP FASTER   
     

</code></pre></div><section class="detached"><h2 id="1233099618#sobre-este-guia" data-toc="sobre-este-guia#welcome.md-sobre-este-guia">Sobre este Guia</h2><p id="1233099618#z58rpz7_13">Bem-vindo ao guia mais irreverente e pr&aacute;tico sobre Docker! Este n&atilde;o &eacute; apenas mais um tutorial chato - &eacute; sua jornada cyberpunk pelo mundo dos containers.</p></section><section class="detached"><h2 id="1233099618#o-que-voc-vai-encontrar-aqui" data-toc="o-que-voc-vai-encontrar-aqui#welcome.md-o-que-voc-vai-encontrar-aqui">O que voc&ecirc; vai encontrar aqui</h2><section class="detached"><h3 id="1233099618#estrutura-do-conte-do" data-toc="estrutura-do-conte-do#welcome.md-estrutura-do-conte-do"><span class="no-bold"></span> Estrutura do Conte&uacute;do</h3><ul class="list" id="1233099618#z58rpz7_17" start="1"><li class="list-item" id="1233099618#z58rpz7_18"><p id="1233099618#z58rpz7_23"><span class="control" id="1233099618#z58rpz7_24">INIT: Container Matrix</span> - Sua p&iacute;lula vermelha para o mundo Docker</p></li><li class="list-item" id="1233099618#z58rpz7_19"><p id="1233099618#z58rpz7_25"><span class="control" id="1233099618#z58rpz7_26">BASICS: Docker Fundamentals</span> - Aprenda a hackear o mainframe (ou pelo menos rodar um container)</p></li><li class="list-item" id="1233099618#z58rpz7_20"><p id="1233099618#z58rpz7_27"><span class="control" id="1233099618#z58rpz7_28">ADVANCED: Docker Deep Dive</span> - Entre na toca do coelho</p></li><li class="list-item" id="1233099618#z58rpz7_21"><p id="1233099618#z58rpz7_29"><span class="control" id="1233099618#z58rpz7_30">PRACTICE: Hands-on Labs</span> - Porque teoria sem pr&aacute;tica &eacute; como um container sem imagem</p></li><li class="list-item" id="1233099618#z58rpz7_22"><p id="1233099618#z58rpz7_31"><span class="control" id="1233099618#z58rpz7_32">CERTIFICATION: Docker Certified Associate</span> - Torne-se um operador certificado da Matrix</p></li></ul></section><section class="detached"><h3 id="1233099618#como-usar-este-guia" data-toc="como-usar-este-guia#welcome.md-como-usar-este-guia"><span class="no-bold"></span> Como Usar este Guia</h3><ol class="list list-decimal" id="1233099618#z58rpz7_33" type="1" start="1"><li class="list-item" id="1233099618#z58rpz7_34"><p id="1233099618#z58rpz7_37"><span class="control" id="1233099618#z58rpz7_38">Siga a Ordem</span>: Cada se&ccedil;&atilde;o foi cuidadosamente planejada para construir seu conhecimento gradualmente</p></li><li class="list-item" id="1233099618#z58rpz7_35"><p id="1233099618#z58rpz7_39"><span class="control" id="1233099618#z58rpz7_40">Pratique Muito</span>: Cada conceito vem com exerc&iacute;cios pr&aacute;ticos</p></li><li class="list-item" id="1233099618#z58rpz7_36"><p id="1233099618#z58rpz7_41"><span class="control" id="1233099618#z58rpz7_42">Divirta-se</span>: Sim, aprender Docker pode (e deve) ser divertido!</p></li></ol></section><section class="detached"><h3 id="1233099618#recursos-especiais" data-toc="recursos-especiais#welcome.md-recursos-especiais"><span class="no-bold"></span> Recursos Especiais</h3><ul class="list" id="1233099618#z58rpz7_43" start="1"><li class="list-item" id="1233099618#z58rpz7_44"><p id="1233099618#z58rpz7_48"><span class="control" id="1233099618#z58rpz7_49">Waifu Tech Squad</span>: Suas guias pelo mundo dos containers</p></li><li class="list-item" id="1233099618#z58rpz7_45"><p id="1233099618#z58rpz7_50"><span class="control" id="1233099618#z58rpz7_51">ASCII Art</span>: Porque documenta&ccedil;&atilde;o t&eacute;cnica precisa de arte</p></li><li class="list-item" id="1233099618#z58rpz7_46"><p id="1233099618#z58rpz7_52"><span class="control" id="1233099618#z58rpz7_53">Easter Eggs</span>: Encontre-os todos!</p></li><li class="list-item" id="1233099618#z58rpz7_47"><p id="1233099618#z58rpz7_54"><span class="control" id="1233099618#z58rpz7_55">Refer&ecirc;ncias Pop</span>: De Matrix a Blade Runner, tudo est&aacute; aqui</p></li></ul></section></section><section class="detached"><h2 id="1233099618#pr-requisitos" data-toc="pr-requisitos#welcome.md-pr-requisitos">Pr&eacute;-requisitos</h2><ul class="list" id="1233099618#z58rpz7_56" start="1"><li class="list-item" id="1233099618#z58rpz7_57"><p id="1233099618#z58rpz7_62">Um computador (duh!)</p></li><li class="list-item" id="1233099618#z58rpz7_58"><p id="1233099618#z58rpz7_63">Terminal b&aacute;sico</p></li><li class="list-item" id="1233099618#z58rpz7_59"><p id="1233099618#z58rpz7_64">Vontade de aprender</p></li><li class="list-item" id="1233099618#z58rpz7_60"><p id="1233099618#z58rpz7_65">Senso de humor</p></li><li class="list-item" id="1233099618#z58rpz7_61"><p id="1233099618#z58rpz7_66">Toler&acirc;ncia a refer&ecirc;ncias geek</p></li></ul></section><section class="detached"><h2 id="1233099618#quick-start" data-toc="quick-start#welcome.md-quick-start">Quick Start</h2><div class="detached code-block" id="1233099618#z58rpz7_67"><pre><code class="language-bash"># Clone este repositrio
git clone ${project_repo}

# Entre na pasta do projeto
cd learn-docker

# Comece sua jornada
./start-learning.sh</code></pre></div></section><section class="detached"><h2 id="1233099618#quick-reference" data-toc="quick-reference#welcome.md-quick-reference"><span class="no-bold"></span> Quick Reference</h2><div class="detached code-block" id="1233099618#z58rpz7_68"><pre><code class="language-none">
 COMANDOS ESSENCIAIS                                                

 docker run    Criar e iniciar container                           
 docker ps     Listar containers                                   
 docker build  Construir imagem                                    
 docker pull   Baixar imagem do registry                           
 docker push   Enviar imagem para registry                         



 ARQUIVOS IMPORTANTES                                               

 Dockerfile      Receita para construir imagens                    
 docker-compose  Orquestrao de mltiplos containers              
 .dockerignore   Arquivos a serem ignorados no build               
</code></pre></div><section class="detached"><h3 id="1233099618#mapa-de-navega-o" data-toc="mapa-de-navega-o#welcome.md-mapa-de-navega-o"><span class="no-bold"></span> Mapa de Navega&ccedil;&atilde;o</h3><div class="detached code-block" id="1233099618#z58rpz7_70"><pre><code class="language-none">START 
        
        
[INIT: Container Matrix] 
                              
                              
[BASICS: Fundamentals]  [PRACTICE: Labs]
                              
                              
[ADVANCED: Deep Dive] 
        
        
[CERTIFICATION: DCA]</code></pre></div></section></section><section class="detached"><h2 id="1233099618#contribuindo" data-toc="contribuindo#welcome.md-contribuindo">Contribuindo</h2><p id="1233099618#z58rpz7_71">Encontrou um bug? Quer adicionar mais refer&ecirc;ncias cyberpunk? Abra uma issue ou PR!</p></section><section class="detached"><h2 id="1233099618#c-digo-de-conduta" data-toc="c-digo-de-conduta#welcome.md-c-digo-de-conduta">C&oacute;digo de Conduta</h2><ol class="list list-decimal" id="1233099618#z58rpz7_72" type="1" start="1"><li class="list-item" id="1233099618#z58rpz7_73"><p id="1233099618#z58rpz7_77">N&atilde;o fale sobre o Fight Club</p></li><li class="list-item" id="1233099618#z58rpz7_74"><p id="1233099618#z58rpz7_78">Containers s&atilde;o amigos, n&atilde;o comida</p></li><li class="list-item" id="1233099618#z58rpz7_75"><p id="1233099618#z58rpz7_79">Sempre cite suas refer&ecirc;ncias geek</p></li><li class="list-item" id="1233099618#z58rpz7_76"><p id="1233099618#z58rpz7_80">Respeite as waifus</p></li></ol></section><section class="detached"><h2 id="1233099618#contato" data-toc="contato#welcome.md-contato">Contato</h2><ul class="list" id="1233099618#z58rpz7_81" start="1"><li class="list-item" id="1233099618#z58rpz7_82"><p id="1233099618#z58rpz7_84"><span class="control" id="1233099618#z58rpz7_85">Discord</span>: [Link para o servidor]</p></li><li class="list-item" id="1233099618#z58rpz7_83"><p id="1233099618#z58rpz7_86"><span class="control" id="1233099618#z58rpz7_87">Twitter</span>: [@DockerMaster]</p></li></ul></section><section class="detached"><h2 id="1233099618#licen-a" data-toc="licen-a#welcome.md-licen-a">Licen&ccedil;a</h2><p id="1233099618#z58rpz7_88">Este projeto est&aacute; licenciado sob a Licen&ccedil;a MIT - veja o arquivo  para detalhes.</p><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1233099618#z58rpz7_93">&quot;Eu posso te mostrar a porta, mas voc&ecirc; &eacute; quem tem que atravess&aacute;-la.&quot;</p><ul class="list" id="1233099618#z58rpz7_94" start="1"><li class="list-item" id="1233099618#z58rpz7_95"><p id="1233099618#z58rpz7_96">Morpheus (provavelmente falando sobre Docker)</p></li></ul></div>
</blockquote>
<p id="1233099618#z58rpz7_91">Pronto para come&ccedil;ar?  para ver o roadmap completo!</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-523846715">Por que Docker</h1><div class="detached code-block" id="-523846715#-g5yxq8_3"><pre><code class="language-none">
  W H Y   D O C K E R ?                                               
                                                                       
  &quot;Porque funciona na minha mquina&quot; no  mais uma desculpa vlida   
                                                                       
</code></pre></div><section class="detached"><h2 id="-523846715#tl-dr-too-long-didn-t-read" data-toc="tl-dr-too-long-didn-t-read#why-docker.md-tl-dr-too-long-didn-t-read">TL;DR (Too Long; Didn't Read)</h2><div class="detached code-block" id="-523846715#-g5yxq8_14"><pre><code class="language-none">
 Docker = Containers
 Containers =     
  = Portabilidade 
</code></pre></div></section><section class="detached"><h2 id="-523846715#o-problema" data-toc="o-problema#why-docker.md-o-problema">O Problema <span class="no-bold"></span></h2><p id="-523846715#-g5yxq8_15">J&aacute; se perguntou por que:</p><ul class="list" id="-523846715#-g5yxq8_16" start="1"><li class="list-item" id="-523846715#-g5yxq8_17"><p id="-523846715#-g5yxq8_21">Seu c&oacute;digo funciona localmente mas quebra em produ&ccedil;&atilde;o?</p></li><li class="list-item" id="-523846715#-g5yxq8_18"><p id="-523846715#-g5yxq8_22">Configurar um novo ambiente de desenvolvimento &eacute; um pesadelo?</p></li><li class="list-item" id="-523846715#-g5yxq8_19"><p id="-523846715#-g5yxq8_23">Cada desenvolvedor da equipe tem uma vers&atilde;o diferente das depend&ecirc;ncias?</p></li><li class="list-item" id="-523846715#-g5yxq8_20"><p id="-523846715#-g5yxq8_24">O novo dev levou 3 dias s&oacute; para configurar o ambiente?</p></li></ul></section><section class="detached"><h2 id="-523846715#a-solu-o" data-toc="a-solu-o#why-docker.md-a-solu-o">A Solu&ccedil;&atilde;o <span class="no-bold"></span></h2><div class="detached code-block" id="-523846715#-g5yxq8_25"><pre><code class="language-none">        
    Containerize    =&gt;     Ship It!        =&gt;     Run It!        
        </code></pre></div><p id="-523846715#-g5yxq8_26">Docker resolve estes problemas atrav&eacute;s de <span class="control" id="-523846715#-g5yxq8_28">containers</span>: ambientes isolados e port&aacute;teis que:</p><ul class="list" id="-523846715#-g5yxq8_27" start="1"><li class="list-item" id="-523846715#-g5yxq8_29"><p id="-523846715#-g5yxq8_33">Empacotam aplica&ccedil;&atilde;o + depend&ecirc;ncias</p></li><li class="list-item" id="-523846715#-g5yxq8_30"><p id="-523846715#-g5yxq8_34">Garantem consist&ecirc;ncia entre ambientes</p></li><li class="list-item" id="-523846715#-g5yxq8_31"><p id="-523846715#-g5yxq8_35">S&atilde;o leves e r&aacute;pidos de iniciar</p></li><li class="list-item" id="-523846715#-g5yxq8_32"><p id="-523846715#-g5yxq8_36">Facilitam o deploy</p></li></ul></section><section class="detached"><h2 id="-523846715#vantagens-reais" data-toc="vantagens-reais#why-docker.md-vantagens-reais">Vantagens Reais <span class="no-bold"></span></h2><section class="detached"><h3 id="-523846715#1-consist-ncia" data-toc="1-consist-ncia#why-docker.md-1-consist-ncia">1. Consist&ecirc;ncia <span class="no-bold"></span></h3><div class="detached code-block" id="-523846715#-g5yxq8_41"><pre><code class="language-none">Dev: &quot;Funciona na minha mquina!&quot;
Ops: &quot;Agora funciona em todas!&quot;</code></pre></div></section><section class="detached"><h3 id="-523846715#2-isolamento" data-toc="2-isolamento#why-docker.md-2-isolamento">2. Isolamento <span class="no-bold"></span></h3><ul class="list" id="-523846715#-g5yxq8_42" start="1"><li class="list-item" id="-523846715#-g5yxq8_43"><p id="-523846715#-g5yxq8_46">Cada container &eacute; um ambiente isolado</p></li><li class="list-item" id="-523846715#-g5yxq8_44"><p id="-523846715#-g5yxq8_47">Sem conflitos entre vers&otilde;es</p></li><li class="list-item" id="-523846715#-g5yxq8_45"><p id="-523846715#-g5yxq8_48">Seguran&ccedil;a melhorada</p></li></ul></section><section class="detached"><h3 id="-523846715#3-portabilidade" data-toc="3-portabilidade#why-docker.md-3-portabilidade">3. Portabilidade <span class="no-bold"></span></h3><ul class="list" id="-523846715#-g5yxq8_49" start="1"><li class="list-item" id="-523846715#-g5yxq8_50"><p id="-523846715#-g5yxq8_53">Rode em qualquer lugar</p></li><li class="list-item" id="-523846715#-g5yxq8_51"><p id="-523846715#-g5yxq8_54">Linux, Windows, Cloud</p></li><li class="list-item" id="-523846715#-g5yxq8_52"><p id="-523846715#-g5yxq8_55">Mesmo comportamento garantido</p></li></ul></section><section class="detached"><h3 id="-523846715#4-efici-ncia" data-toc="4-efici-ncia#why-docker.md-4-efici-ncia">4. Efici&ecirc;ncia <span class="no-bold"></span></h3><ul class="list" id="-523846715#-g5yxq8_56" start="1"><li class="list-item" id="-523846715#-g5yxq8_57"><p id="-523846715#-g5yxq8_60">Inicializa&ccedil;&atilde;o em segundos</p></li><li class="list-item" id="-523846715#-g5yxq8_58"><p id="-523846715#-g5yxq8_61">Menos recursos que VMs</p></li><li class="list-item" id="-523846715#-g5yxq8_59"><p id="-523846715#-g5yxq8_62">Escalabilidade facilitada</p></li></ul></section></section><section class="detached"><h2 id="-523846715#casos-de-uso" data-toc="casos-de-uso#why-docker.md-casos-de-uso">Casos de Uso <span class="no-bold"></span></h2><section class="detached"><h3 id="-523846715#desenvolvimento" data-toc="desenvolvimento#why-docker.md-desenvolvimento">Desenvolvimento</h3><div class="detached code-block" id="-523846715#-g5yxq8_66"><pre><code class="language-none">
 $ docker-compose up     
 &gt; ambiente pronto!    
</code></pre></div></section><section class="detached"><h3 id="-523846715#testes" data-toc="testes#why-docker.md-testes">Testes</h3><div class="detached code-block" id="-523846715#-g5yxq8_67"><pre><code class="language-none">
 $ docker test           
 &gt; testes consistentes 
</code></pre></div></section><section class="detached"><h3 id="-523846715#produ-o" data-toc="produ-o#why-docker.md-produ-o">Produ&ccedil;&atilde;o</h3><div class="detached code-block" id="-523846715#-g5yxq8_68"><pre><code class="language-none">
 $ docker deploy         
 &gt; deploy confivel    
</code></pre></div></section></section><section class="detached"><h2 id="-523846715#docker-vs-vms" data-toc="docker-vs-vms#why-docker.md-docker-vs-vms">Docker vs VMs <span class="no-bold"></span></h2><div class="detached code-block" id="-523846715#-g5yxq8_69"><pre><code class="language-none">    
      Docker                    VMs         
    
  Mais leve              Mais pesadas     
  Boot em segundos       Boot em minutos  
  Menos recursos         Mais recursos    
  Compartilha OS         Mais isolamento  
    </code></pre></div></section><section class="detached"><h2 id="-523846715#come-ando" data-toc="come-ando#why-docker.md-come-ando">Come&ccedil;ando <span class="no-bold"></span></h2><section class="detached"><h3 id="-523846715#requisitos-m-nimos" data-toc="requisitos-m-nimos#why-docker.md-requisitos-m-nimos">Requisitos M&iacute;nimos</h3><ul class="list" id="-523846715#-g5yxq8_72" start="1"><li class="list-item" id="-523846715#-g5yxq8_73"><p id="-523846715#-g5yxq8_77">Um computador (duh!)</p></li><li class="list-item" id="-523846715#-g5yxq8_74"><p id="-523846715#-g5yxq8_78">Sistema operacional (Windows/Linux/Mac)</p></li><li class="list-item" id="-523846715#-g5yxq8_75"><p id="-523846715#-g5yxq8_79">Vontade de aprender</p></li><li class="list-item" id="-523846715#-g5yxq8_76"><p id="-523846715#-g5yxq8_80">Caf&eacute; (muito caf&eacute;)</p></li></ul></section><section class="detached"><h3 id="-523846715#pr-ximos-passos" data-toc="pr-ximos-passos#why-docker.md-pr-ximos-passos">Pr&oacute;ximos Passos</h3><ol class="list list-decimal" id="-523846715#-g5yxq8_81" type="1" start="1"><li class="list-item" id="-523846715#-g5yxq8_82"><p id="-523846715#-g5yxq8_85">Instala&ccedil;&atilde;o do Docker (<a href="#-867919447">Instala&ccedil;&atilde;o do Docker </a>)</p></li><li class="list-item" id="-523846715#-g5yxq8_83"><p id="-523846715#-g5yxq8_87">Conceitos B&aacute;sicos (<a href="#871964087">Containers 101</a>)</p></li><li class="list-item" id="-523846715#-g5yxq8_84"><p id="-523846715#-g5yxq8_89">Primeiro Container (<a href="#-271055979">Docker Commands: O Arsenal Completo </a>)</p></li></ol></section></section><section class="detached"><h2 id="-523846715#waifu-tips" data-toc="waifu-tips#why-docker.md-waifu-tips">Waifu Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-523846715#-g5yxq8_92"><span class="control" id="-523846715#-g5yxq8_93">Container-chan diz:</span> &quot;Lembre-se: containers s&atilde;o ef&ecirc;meros! N&atilde;o se apegue a eles como se apega ao seu waifu body pillow!&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="-523846715#checkpoint" data-toc="checkpoint#why-docker.md-checkpoint">Checkpoint <span class="no-bold"></span></h2><p id="-523846715#-g5yxq8_94">Voc&ecirc; agora sabe:</p><ul class="list" id="-523846715#-g5yxq8_95" start="1"><li class="list-item" id="-523846715#-g5yxq8_96"><p id="-523846715#-g5yxq8_100">[x] Por que Docker &eacute; importante</p></li><li class="list-item" id="-523846715#-g5yxq8_97"><p id="-523846715#-g5yxq8_101">[x] Principais benef&iacute;cios</p></li><li class="list-item" id="-523846715#-g5yxq8_98"><p id="-523846715#-g5yxq8_102">[x] Diferen&ccedil;a entre Docker e VMs</p></li><li class="list-item" id="-523846715#-g5yxq8_99"><p id="-523846715#-g5yxq8_103">[x] Casos de uso comuns</p></li></ul></section><section class="detached"><h2 id="-523846715#exerc-cios" data-toc="exerc-cios#why-docker.md-exerc-cios">Exerc&iacute;cios <span class="no-bold"></span></h2><ol class="list list-decimal" id="-523846715#-g5yxq8_104" type="1" start="1"><li class="list-item" id="-523846715#-g5yxq8_107"><p id="-523846715#-g5yxq8_110">Liste 3 problemas que voc&ecirc; j&aacute; enfrentou que poderiam ser resolvidos com Docker</p></li><li class="list-item" id="-523846715#-g5yxq8_108"><p id="-523846715#-g5yxq8_111">Pesquise uma empresa que usa Docker e como ela se beneficia</p></li><li class="list-item" id="-523846715#-g5yxq8_109"><p id="-523846715#-g5yxq8_112">Tente explicar Docker para seu rubber duck <span class="no-bold"></span></p></li></ol><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-523846715#-g5yxq8_113">&quot;A jornada de mil containers come&ccedil;a com um &uacute;nico <span class="inline-code" id="-523846715#-g5yxq8_115">docker run</span> &quot;</p><ul class="list" id="-523846715#-g5yxq8_114" start="1"><li class="list-item" id="-523846715#-g5yxq8_116"><p id="-523846715#-g5yxq8_117">Container-chan, 2025</p></li></ul></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-673575045">Containers vs M&aacute;quinas Virtuais</h1><div class="detached code-block" id="-673575045#z451h1m_3"><pre><code class="language-none">
  C O N T A I N E R S   vs   V M s                                    
                                                                      
  Round 1: FIGHT!                                                     
   Containers vs VMs                                                
   Quem vence essa batalha?                                         
                                                                      
</code></pre></div><section class="detached"><h2 id="-673575045#tl-dr-too-long-didn-t-read" data-toc="tl-dr-too-long-didn-t-read#container-vs-vm.md-tl-dr-too-long-didn-t-read">TL;DR (Too Long; Didn't Read)</h2><div class="detached code-block" id="-673575045#z451h1m_14"><pre><code class="language-none">
     Containers            VMs         

  Leves             Pesadas        
  Boot: segundos    Boot: minutos  
  MB de tamanho     GB de tamanho  
  Menos isolado     Mais isolado   
</code></pre></div></section><section class="detached"><h2 id="-673575045#anatomia-detalhada" data-toc="anatomia-detalhada#container-vs-vm.md-anatomia-detalhada">Anatomia Detalhada <span class="no-bold"></span></h2><section class="detached"><h3 id="-673575045#containers-em-profundidade" data-toc="containers-em-profundidade#container-vs-vm.md-containers-em-profundidade">Containers em Profundidade</h3><div class="detached code-block" id="-673575045#z451h1m_17"><pre><code class="language-none">
 Container A     Container B     Container C                           
                                 
   App A         App B         App C                           
   Bins          Bins          Bins                            
   Libs          Libs          Libs                            
                                 
                          
           Docker Engine / Container Runtime                          
    (namespaces, cgroups, union filesystem)                          
                          
                  Sistema Operacional Host                            
                          
                      Hardware                                        
</code></pre></div><section class="detached"><h4 id="-673575045#componentes-do-container" data-toc="componentes-do-container#container-vs-vm.md-componentes-do-container">Componentes do Container</h4><ol class="list list-decimal" id="-673575045#z451h1m_19" type="1" start="1"><li class="list-item" id="-673575045#z451h1m_20"><p id="-673575045#z451h1m_23"><span class="control" id="-673575045#z451h1m_25">Namespaces</span></p><ul class="list" id="-673575045#z451h1m_24" start="1"><li class="list-item" id="-673575045#z451h1m_26"><p id="-673575045#z451h1m_32">PID: Isolamento de processos</p></li><li class="list-item" id="-673575045#z451h1m_27"><p id="-673575045#z451h1m_33">NET: Isolamento de rede</p></li><li class="list-item" id="-673575045#z451h1m_28"><p id="-673575045#z451h1m_34">MNT: Pontos de montagem</p></li><li class="list-item" id="-673575045#z451h1m_29"><p id="-673575045#z451h1m_35">UTS: Hostname e dom&iacute;nio</p></li><li class="list-item" id="-673575045#z451h1m_30"><p id="-673575045#z451h1m_36">IPC: Comunica&ccedil;&atilde;o interprocessos</p></li><li class="list-item" id="-673575045#z451h1m_31"><p id="-673575045#z451h1m_37">USER: IDs de usu&aacute;rios</p></li></ul></li><li class="list-item" id="-673575045#z451h1m_21"><p id="-673575045#z451h1m_38"><span class="control" id="-673575045#z451h1m_40">Control Groups (cgroups)</span></p><ul class="list" id="-673575045#z451h1m_39" start="1"><li class="list-item" id="-673575045#z451h1m_41"><p id="-673575045#z451h1m_45">Limita recursos (CPU, mem&oacute;ria)</p></li><li class="list-item" id="-673575045#z451h1m_42"><p id="-673575045#z451h1m_46">Prioriza&ccedil;&atilde;o</p></li><li class="list-item" id="-673575045#z451h1m_43"><p id="-673575045#z451h1m_47">Contabiliza&ccedil;&atilde;o</p></li><li class="list-item" id="-673575045#z451h1m_44"><p id="-673575045#z451h1m_48">Controle</p></li></ul></li><li class="list-item" id="-673575045#z451h1m_22"><p id="-673575045#z451h1m_49"><span class="control" id="-673575045#z451h1m_51">Union Filesystem</span></p><ul class="list" id="-673575045#z451h1m_50" start="1"><li class="list-item" id="-673575045#z451h1m_52"><p id="-673575045#z451h1m_55">Camadas sobrepostas</p></li><li class="list-item" id="-673575045#z451h1m_53"><p id="-673575045#z451h1m_56">Copy-on-write</p></li><li class="list-item" id="-673575045#z451h1m_54"><p id="-673575045#z451h1m_57">Compartilhamento eficiente</p></li></ul></li></ol></section></section><section class="detached"><h3 id="-673575045#virtual-machines-em-detalhes" data-toc="virtual-machines-em-detalhes#container-vs-vm.md-virtual-machines-em-detalhes">Virtual Machines em Detalhes</h3><div class="detached code-block" id="-673575045#z451h1m_58"><pre><code class="language-none">
    VM A          VM B          VM C                                  
                                
   App A       App B       App C                              
   Bins        Bins        Bins                               
   Libs        Libs        Libs                               
                                
  Kernel A    Kernel B    Kernel C                            
    OS A        OS B        OS C                              
                                
                          
         Hypervisor (Tipo 1 ou Tipo 2)                               
                          
                 Sistema Operacional Host                             
                          
                     Hardware                                         
</code></pre></div><section class="detached"><h4 id="-673575045#tipos-de-hypervisor" data-toc="tipos-de-hypervisor#container-vs-vm.md-tipos-de-hypervisor">Tipos de Hypervisor</h4><ol class="list list-decimal" id="-673575045#z451h1m_60" type="1" start="1"><li class="list-item" id="-673575045#z451h1m_61"><p id="-673575045#z451h1m_63"><span class="control" id="-673575045#z451h1m_65">Tipo 1 (Bare Metal)</span></p><ul class="list" id="-673575045#z451h1m_64" start="1"><li class="list-item" id="-673575045#z451h1m_66"><p id="-673575045#z451h1m_69">VMware ESXi</p></li><li class="list-item" id="-673575045#z451h1m_67"><p id="-673575045#z451h1m_70">Microsoft Hyper-V</p></li><li class="list-item" id="-673575045#z451h1m_68"><p id="-673575045#z451h1m_71">Citrix XenServer</p></li></ul></li><li class="list-item" id="-673575045#z451h1m_62"><p id="-673575045#z451h1m_72"><span class="control" id="-673575045#z451h1m_74">Tipo 2 (Hosted)</span></p><ul class="list" id="-673575045#z451h1m_73" start="1"><li class="list-item" id="-673575045#z451h1m_75"><p id="-673575045#z451h1m_78">VirtualBox</p></li><li class="list-item" id="-673575045#z451h1m_76"><p id="-673575045#z451h1m_79">VMware Workstation</p></li><li class="list-item" id="-673575045#z451h1m_77"><p id="-673575045#z451h1m_80">Parallels</p></li></ul></li></ol></section></section></section><section class="detached"><h2 id="-673575045#an-lise-t-cnica-detalhada" data-toc="an-lise-t-cnica-detalhada#container-vs-vm.md-an-lise-t-cnica-detalhada">An&aacute;lise T&eacute;cnica Detalhada <span class="no-bold"></span></h2><section class="detached"><h3 id="-673575045#1-gerenciamento-de-recursos" data-toc="1-gerenciamento-de-recursos#container-vs-vm.md-1-gerenciamento-de-recursos">1. Gerenciamento de Recursos</h3><section class="detached"><h4 id="-673575045#containers" data-toc="containers#container-vs-vm.md-containers">Containers</h4><div class="detached code-block" id="-673575045#z451h1m_86"><pre><code class="language-none">
 Recurso         Comportamento                 

 CPU            Compartilhado + Limites cgroups
 Memria        Isolada + Limites cgroups     
 I/O            Compartilhado + Throttling    
 Network        Virtualizada via namespaces   
</code></pre></div></section><section class="detached"><h4 id="-673575045#vms" data-toc="vms#container-vs-vm.md-vms">VMs</h4><div class="detached code-block" id="-673575045#z451h1m_87"><pre><code class="language-none">
 Recurso         Comportamento                 

 CPU            Dedicado ou compartilhado     
 Memria        Totalmente isolada            
 I/O            Emulado ou para-virtualizado  
 Network        Totalmente virtualizada       
</code></pre></div></section></section><section class="detached"><h3 id="-673575045#2-seguran-a-e-isolamento" data-toc="2-seguran-a-e-isolamento#container-vs-vm.md-2-seguran-a-e-isolamento">2. Seguran&ccedil;a e Isolamento</h3><section class="detached"><h4 id="-673575045#containers" data-toc="containers#container-vs-vm.md-containers">Containers</h4><div class="detached code-block" id="-673575045#z451h1m_90"><pre><code class="language-none">
 Aspecto                    Nvel             

 Processo                   Alto              
 Sistema de Arquivos        Alto              
 Network                    Mdio             
 Kernel                     Baixo             
 Hardware                   Baixo             
 Vulnerabilidades          Kernel compartilhado
 Escape                    Possvel          
</code></pre></div></section><section class="detached"><h4 id="-673575045#vms" data-toc="vms#container-vs-vm.md-vms">VMs</h4><div class="detached code-block" id="-673575045#z451h1m_91"><pre><code class="language-none">
 Aspecto                    Nvel             

 Processo                   Total             
 Sistema de Arquivos        Total             
 Network                    Total             
 Kernel                     Total             
 Hardware                   Alto              
 Vulnerabilidades          Isoladas por VM   
 Escape                    Muito difcil     
</code></pre></div></section></section><section class="detached"><h3 id="-673575045#3-performance-detalhada" data-toc="3-performance-detalhada#container-vs-vm.md-3-performance-detalhada">3. Performance Detalhada</h3><div class="detached code-block" id="-673575045#z451h1m_92"><pre><code class="language-none">
 Mtrica              Containers    VMs       

 Boot Time            1-3 seg      30-60 seg 
 Tamanho Base         ~100MB       ~1-20GB   
 Overhead CPU         ~1-5%        ~10-30%   
 Overhead Memria     ~5-10%       ~20-40%   
 I/O Performance      Nativo       ~90-95%   
 Network Performance  Nativo       ~90-95%   
 Densidade/Host       50-100+      5-10      
</code></pre></div></section></section><section class="detached"><h2 id="-673575045#casos-de-uso-detalhados" data-toc="casos-de-uso-detalhados#container-vs-vm.md-casos-de-uso-detalhados">Casos de Uso Detalhados <span class="no-bold"></span></h2><section class="detached"><h3 id="-673575045#containers-s-o-ideais-para" data-toc="containers-s-o-ideais-para#container-vs-vm.md-containers-s-o-ideais-para">Containers S&atilde;o Ideais Para</h3><ol class="list list-decimal" id="-673575045#z451h1m_95" type="1" start="1"><li class="list-item" id="-673575045#z451h1m_96"><p id="-673575045#z451h1m_100"><span class="control" id="-673575045#z451h1m_102">Microservi&ccedil;os</span></p><ul class="list" id="-673575045#z451h1m_101" start="1"><li class="list-item" id="-673575045#z451h1m_103"><p id="-673575045#z451h1m_106">Deployments independentes</p></li><li class="list-item" id="-673575045#z451h1m_104"><p id="-673575045#z451h1m_107">Escalabilidade granular</p></li><li class="list-item" id="-673575045#z451h1m_105"><p id="-673575045#z451h1m_108">Ciclo de vida curto</p></li></ul></li><li class="list-item" id="-673575045#z451h1m_97"><p id="-673575045#z451h1m_109"><span class="control" id="-673575045#z451h1m_111">DevOps</span></p><ul class="list" id="-673575045#z451h1m_110" start="1"><li class="list-item" id="-673575045#z451h1m_112"><p id="-673575045#z451h1m_115">CI/CD pipelines</p></li><li class="list-item" id="-673575045#z451h1m_113"><p id="-673575045#z451h1m_116">Testes automatizados</p></li><li class="list-item" id="-673575045#z451h1m_114"><p id="-673575045#z451h1m_117">Ambientes ef&ecirc;meros</p></li></ul></li><li class="list-item" id="-673575045#z451h1m_98"><p id="-673575045#z451h1m_118"><span class="control" id="-673575045#z451h1m_120">Cloud Native</span></p><ul class="list" id="-673575045#z451h1m_119" start="1"><li class="list-item" id="-673575045#z451h1m_121"><p id="-673575045#z451h1m_124">Kubernetes</p></li><li class="list-item" id="-673575045#z451h1m_122"><p id="-673575045#z451h1m_125">Orquestra&ccedil;&atilde;o</p></li><li class="list-item" id="-673575045#z451h1m_123"><p id="-673575045#z451h1m_126">Auto-scaling</p></li></ul></li><li class="list-item" id="-673575045#z451h1m_99"><p id="-673575045#z451h1m_127"><span class="control" id="-673575045#z451h1m_129">Desenvolvimento</span></p><ul class="list" id="-673575045#z451h1m_128" start="1"><li class="list-item" id="-673575045#z451h1m_130"><p id="-673575045#z451h1m_133">Ambientes consistentes</p></li><li class="list-item" id="-673575045#z451h1m_131"><p id="-673575045#z451h1m_134">R&aacute;pida itera&ccedil;&atilde;o</p></li><li class="list-item" id="-673575045#z451h1m_132"><p id="-673575045#z451h1m_135">Baixo overhead</p></li></ul></li></ol></section><section class="detached"><h3 id="-673575045#vms-s-o-ideais-para" data-toc="vms-s-o-ideais-para#container-vs-vm.md-vms-s-o-ideais-para">VMs S&atilde;o Ideais Para</h3><ol class="list list-decimal" id="-673575045#z451h1m_136" type="1" start="1"><li class="list-item" id="-673575045#z451h1m_137"><p id="-673575045#z451h1m_141"><span class="control" id="-673575045#z451h1m_143">Infraestrutura Legacy</span></p><ul class="list" id="-673575045#z451h1m_142" start="1"><li class="list-item" id="-673575045#z451h1m_144"><p id="-673575045#z451h1m_147">Sistemas monol&iacute;ticos</p></li><li class="list-item" id="-673575045#z451h1m_145"><p id="-673575045#z451h1m_148">Depend&ecirc;ncias de SO</p></li><li class="list-item" id="-673575045#z451h1m_146"><p id="-673575045#z451h1m_149">Licenciamento espec&iacute;fico</p></li></ul></li><li class="list-item" id="-673575045#z451h1m_138"><p id="-673575045#z451h1m_150"><span class="control" id="-673575045#z451h1m_152">Isolamento Total</span></p><ul class="list" id="-673575045#z451h1m_151" start="1"><li class="list-item" id="-673575045#z451h1m_153"><p id="-673575045#z451h1m_156">Workloads multi-tenant</p></li><li class="list-item" id="-673575045#z451h1m_154"><p id="-673575045#z451h1m_157">Compliance</p></li><li class="list-item" id="-673575045#z451h1m_155"><p id="-673575045#z451h1m_158">Seguran&ccedil;a cr&iacute;tica</p></li></ul></li><li class="list-item" id="-673575045#z451h1m_139"><p id="-673575045#z451h1m_159"><span class="control" id="-673575045#z451h1m_161">Recursos Dedicados</span></p><ul class="list" id="-673575045#z451h1m_160" start="1"><li class="list-item" id="-673575045#z451h1m_162"><p id="-673575045#z451h1m_165">Garantias de performance</p></li><li class="list-item" id="-673575045#z451h1m_163"><p id="-673575045#z451h1m_166">SLAs estritos</p></li><li class="list-item" id="-673575045#z451h1m_164"><p id="-673575045#z451h1m_167">Cargas previs&iacute;veis</p></li></ul></li><li class="list-item" id="-673575045#z451h1m_140"><p id="-673575045#z451h1m_168"><span class="control" id="-673575045#z451h1m_170">Disaster Recovery</span></p><ul class="list" id="-673575045#z451h1m_169" start="1"><li class="list-item" id="-673575045#z451h1m_171"><p id="-673575045#z451h1m_174">Snapshots completos</p></li><li class="list-item" id="-673575045#z451h1m_172"><p id="-673575045#z451h1m_175">Backup do estado total</p></li><li class="list-item" id="-673575045#z451h1m_173"><p id="-673575045#z451h1m_176">Migra&ccedil;&atilde;o live</p></li></ul></li></ol></section></section><section class="detached"><h2 id="-673575045#cen-rios-h-bridos" data-toc="cen-rios-h-bridos#container-vs-vm.md-cen-rios-h-bridos">Cen&aacute;rios H&iacute;bridos <span class="no-bold"></span></h2><section class="detached"><h3 id="-673575045#exemplo-arquitetura-moderna" data-toc="exemplo-arquitetura-moderna#container-vs-vm.md-exemplo-arquitetura-moderna">Exemplo: Arquitetura Moderna</h3><div class="detached code-block" id="-673575045#z451h1m_178"><pre><code class="language-none">
 VM de Banco de Dados    VM de Monolito      
      
  PostgreSQL            Legacy App        
  (Dados Crticos)      (Sistema Core)    
      
                                              
 Container Cluster       Container Cluster    
        
 API  Web  Cache   Log  Mon  Auth
        
</code></pre></div></section></section><section class="detached"><h2 id="-673575045#melhores-pr-ticas" data-toc="melhores-pr-ticas#container-vs-vm.md-melhores-pr-ticas">Melhores Pr&aacute;ticas <span class="no-bold"></span></h2><section class="detached"><h3 id="-673575045#para-containers" data-toc="para-containers#container-vs-vm.md-para-containers">Para Containers</h3><ol class="list list-decimal" id="-673575045#z451h1m_181" type="1" start="1"><li class="list-item" id="-673575045#z451h1m_182"><p id="-673575045#z451h1m_189">Uma aplica&ccedil;&atilde;o por container</p></li><li class="list-item" id="-673575045#z451h1m_183"><p id="-673575045#z451h1m_190">Imagens imut&aacute;veis</p></li><li class="list-item" id="-673575045#z451h1m_184"><p id="-673575045#z451h1m_191">Use multi-stage builds</p></li><li class="list-item" id="-673575045#z451h1m_185"><p id="-673575045#z451h1m_192">Minimize camadas</p></li><li class="list-item" id="-673575045#z451h1m_186"><p id="-673575045#z451h1m_193">Configure health checks</p></li><li class="list-item" id="-673575045#z451h1m_187"><p id="-673575045#z451h1m_194">N&atilde;o armazene dados no container</p></li><li class="list-item" id="-673575045#z451h1m_188"><p id="-673575045#z451h1m_195">Use secrets management</p></li></ol></section><section class="detached"><h3 id="-673575045#para-vms" data-toc="para-vms#container-vs-vm.md-para-vms">Para VMs</h3><ol class="list list-decimal" id="-673575045#z451h1m_196" type="1" start="1"><li class="list-item" id="-673575045#z451h1m_197"><p id="-673575045#z451h1m_204">Tamanho apropriado</p></li><li class="list-item" id="-673575045#z451h1m_198"><p id="-673575045#z451h1m_205">Templating e automa&ccedil;&atilde;o</p></li><li class="list-item" id="-673575045#z451h1m_199"><p id="-673575045#z451h1m_206">Patches regulares</p></li><li class="list-item" id="-673575045#z451h1m_200"><p id="-673575045#z451h1m_207">Backup estrat&eacute;gico</p></li><li class="list-item" id="-673575045#z451h1m_201"><p id="-673575045#z451h1m_208">Monitoramento robusto</p></li><li class="list-item" id="-673575045#z451h1m_202"><p id="-673575045#z451h1m_209">Seguran&ccedil;a em camadas</p></li><li class="list-item" id="-673575045#z451h1m_203"><p id="-673575045#z451h1m_210">Planejamento de capacidade</p></li></ol></section></section><section class="detached"><h2 id="-673575045#ferramentas-do-ecossistema" data-toc="ferramentas-do-ecossistema#container-vs-vm.md-ferramentas-do-ecossistema">Ferramentas do Ecossistema <span class="no-bold"></span></h2><section class="detached"><h3 id="-673575045#containers" data-toc="containers#container-vs-vm.md-containers">Containers</h3><ul class="list" id="-673575045#z451h1m_213" start="1"><li class="list-item" id="-673575045#z451h1m_214"><p id="-673575045#z451h1m_219">Docker</p></li><li class="list-item" id="-673575045#z451h1m_215"><p id="-673575045#z451h1m_220">Podman</p></li><li class="list-item" id="-673575045#z451h1m_216"><p id="-673575045#z451h1m_221">containerd</p></li><li class="list-item" id="-673575045#z451h1m_217"><p id="-673575045#z451h1m_222">LXC/LXD</p></li><li class="list-item" id="-673575045#z451h1m_218"><p id="-673575045#z451h1m_223">rkt</p></li></ul></section><section class="detached"><h3 id="-673575045#vms" data-toc="vms#container-vs-vm.md-vms">VMs</h3><ul class="list" id="-673575045#z451h1m_224" start="1"><li class="list-item" id="-673575045#z451h1m_225"><p id="-673575045#z451h1m_230">VMware</p></li><li class="list-item" id="-673575045#z451h1m_226"><p id="-673575045#z451h1m_231">Hyper-V</p></li><li class="list-item" id="-673575045#z451h1m_227"><p id="-673575045#z451h1m_232">KVM</p></li><li class="list-item" id="-673575045#z451h1m_228"><p id="-673575045#z451h1m_233">Xen</p></li><li class="list-item" id="-673575045#z451h1m_229"><p id="-673575045#z451h1m_234">VirtualBox</p></li></ul></section></section><section class="detached"><h2 id="-673575045#waifu-tips" data-toc="waifu-tips#container-vs-vm.md-waifu-tips">Waifu Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-673575045#z451h1m_237"><span class="control" id="-673575045#z451h1m_238">Container-chan diz:</span> &quot;Lembre-se: containers s&atilde;o ef&ecirc;meros! Trate-os como gado, n&atilde;o como animais de estima&ccedil;&atilde;o!&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-673575045#z451h1m_239"><span class="control" id="-673575045#z451h1m_240">VM-sama diz:</span> &quot;VMs s&atilde;o como fortalezas digitais - mais pesadas, mas super seguras!&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="-673575045#exerc-cios-pr-ticos" data-toc="exerc-cios-pr-ticos#container-vs-vm.md-exerc-cios-pr-ticos">Exerc&iacute;cios Pr&aacute;ticos <span class="no-bold"></span></h2><section class="detached"><h3 id="-673575045#n-vel-1-b-sico" data-toc="n-vel-1-b-sico#container-vs-vm.md-n-vel-1-b-sico">N&iacute;vel 1: B&aacute;sico</h3><ol class="list list-decimal" id="-673575045#z451h1m_244" type="1" start="1"><li class="list-item" id="-673575045#z451h1m_245"><p id="-673575045#z451h1m_248">Compare o tempo de boot entre um container nginx e uma VM com nginx</p></li><li class="list-item" id="-673575045#z451h1m_246"><p id="-673575045#z451h1m_249">Me&ccedil;a o uso de mem&oacute;ria em ambos os casos</p></li><li class="list-item" id="-673575045#z451h1m_247"><p id="-673575045#z451h1m_250">Teste o isolamento de rede em cada tecnologia</p></li></ol></section><section class="detached"><h3 id="-673575045#n-vel-2-intermedi-rio" data-toc="n-vel-2-intermedi-rio#container-vs-vm.md-n-vel-2-intermedi-rio">N&iacute;vel 2: Intermedi&aacute;rio</h3><ol class="list list-decimal" id="-673575045#z451h1m_251" type="1" start="1"><li class="list-item" id="-673575045#z451h1m_252"><p id="-673575045#z451h1m_255">Configure um ambiente h&iacute;brido com DB em VM e app em container</p></li><li class="list-item" id="-673575045#z451h1m_253"><p id="-673575045#z451h1m_256">Implemente limits/requests em containers</p></li><li class="list-item" id="-673575045#z451h1m_254"><p id="-673575045#z451h1m_257">Configure resource pools em VMs</p></li></ol></section><section class="detached"><h3 id="-673575045#n-vel-3-avan-ado" data-toc="n-vel-3-avan-ado#container-vs-vm.md-n-vel-3-avan-ado">N&iacute;vel 3: Avan&ccedil;ado</h3><ol class="list list-decimal" id="-673575045#z451h1m_258" type="1" start="1"><li class="list-item" id="-673575045#z451h1m_259"><p id="-673575045#z451h1m_262">Implemente uma estrat&eacute;gia de backup para ambos</p></li><li class="list-item" id="-673575045#z451h1m_260"><p id="-673575045#z451h1m_263">Configure monitoring e logging</p></li><li class="list-item" id="-673575045#z451h1m_261"><p id="-673575045#z451h1m_264">Teste cen&aacute;rios de failover</p></li></ol></section></section><section class="detached"><h2 id="-673575045#refer-ncias" data-toc="refer-ncias#container-vs-vm.md-refer-ncias">Refer&ecirc;ncias <span class="no-bold"></span></h2><ol class="list list-decimal" id="-673575045#z451h1m_265" type="1" start="1"><li class="list-item" id="-673575045#z451h1m_268"><p id="-673575045#z451h1m_273">Docker Documentation</p></li><li class="list-item" id="-673575045#z451h1m_269"><p id="-673575045#z451h1m_274">VMware Knowledge Base</p></li><li class="list-item" id="-673575045#z451h1m_270"><p id="-673575045#z451h1m_275">Linux Container Documentation</p></li><li class="list-item" id="-673575045#z451h1m_271"><p id="-673575045#z451h1m_276">Kubernetes Documentation</p></li><li class="list-item" id="-673575045#z451h1m_272"><p id="-673575045#z451h1m_277">Cloud Native Foundation</p></li></ol><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-673575045#z451h1m_278">&quot;A escolha entre containers e VMs &eacute; como escolher entre uma katana e um escudo. &Agrave;s vezes voc&ecirc; precisa de velocidade e precis&atilde;o, outras vezes de prote&ccedil;&atilde;o m&aacute;xima.&quot;</p><ul class="list" id="-673575045#z451h1m_279" start="1"><li class="list-item" id="-673575045#z451h1m_280"><p id="-673575045#z451h1m_281">Tech Samurai, 2025</p></li></ul></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1140582937">Hist&oacute;ria do Docker</h1><div class="detached code-block" id="-1140582937#-18vi5e_3"><pre><code class="language-none">
  T I M E L I N E   D O   D O C K E R                                
                                                                      
  Uma jornada atravs do tempo e do espao (de usurio)              
                                                                      
</code></pre></div><section class="detached"><h2 id="-1140582937#pr-hist-ria-dos-containers" data-toc="pr-hist-ria-dos-containers#docker-history.md-pr-hist-ria-dos-containers">Pr&eacute;-Hist&oacute;ria dos Containers <span class="no-bold"></span></h2><section class="detached"><h3 id="-1140582937#1979-unix-v7" data-toc="1979-unix-v7#docker-history.md-1979-unix-v7">1979: Unix V7</h3><ul class="list" id="-1140582937#-18vi5e_17" start="1"><li class="list-item" id="-1140582937#-18vi5e_18"><p id="-1140582937#-18vi5e_21">Introdu&ccedil;&atilde;o do <span class="inline-code" id="-1140582937#-18vi5e_22">chroot</span></p></li><li class="list-item" id="-1140582937#-18vi5e_19"><p id="-1140582937#-18vi5e_23">Primeiro passo para isolamento de processos</p></li><li class="list-item" id="-1140582937#-18vi5e_20"><p id="-1140582937#-18vi5e_24">Limitava vis&atilde;o do sistema de arquivos</p></li></ul></section><section class="detached"><h3 id="-1140582937#anos-90-primeiros-passos" data-toc="anos-90-primeiros-passos#docker-history.md-anos-90-primeiros-passos">Anos 90: Primeiros Passos</h3><ul class="list" id="-1140582937#-18vi5e_25" start="1"><li class="list-item" id="-1140582937#-18vi5e_26"><p id="-1140582937#-18vi5e_29">FreeBSD Jails</p></li><li class="list-item" id="-1140582937#-18vi5e_27"><p id="-1140582937#-18vi5e_30">Isolamento mais robusto</p></li><li class="list-item" id="-1140582937#-18vi5e_28"><p id="-1140582937#-18vi5e_31">Separa&ccedil;&atilde;o de recursos</p></li></ul></section><section class="detached"><h3 id="-1140582937#2000-2010-a-era-das-funda-es" data-toc="2000-2010-a-era-das-funda-es#docker-history.md-2000-2010-a-era-das-funda-es">2000-2010: A Era das Funda&ccedil;&otilde;es</h3><div class="detached code-block" id="-1140582937#-18vi5e_32"><pre><code class="language-none">
 2000  Virtualizao mainstream                                  
                                                                   
    2001: Linux VServer                                        
                                                                   
    2004: Solaris Containers                                   
                                                                   
    2006: Process Containers (Google)                          
                                                                   
    2008: LXC (Linux Containers)                               
</code></pre></div></section></section><section class="detached"><h2 id="-1140582937#o-nascimento-do-docker" data-toc="o-nascimento-do-docker#docker-history.md-o-nascimento-do-docker">O Nascimento do Docker <span class="no-bold"></span></h2><section class="detached"><h3 id="-1140582937#2013-o-ano-que-mudou-tudo" data-toc="2013-o-ano-que-mudou-tudo#docker-history.md-2013-o-ano-que-mudou-tudo">2013: O Ano que Mudou Tudo</h3><ul class="list" id="-1140582937#-18vi5e_35" start="1"><li class="list-item" id="-1140582937#-18vi5e_36"><p id="-1140582937#-18vi5e_40">Docker &eacute; criado por Solomon Hykes</p></li><li class="list-item" id="-1140582937#-18vi5e_37"><p id="-1140582937#-18vi5e_41">Parte do projeto dotCloud</p></li><li class="list-item" id="-1140582937#-18vi5e_38"><p id="-1140582937#-18vi5e_42">C&oacute;digo aberto desde o in&iacute;cio</p></li><li class="list-item" id="-1140582937#-18vi5e_39"><p id="-1140582937#-18vi5e_43">Baseado em LXC inicialmente</p></li></ul></section><section class="detached"><h3 id="-1140582937#2014-o-ano-do-crescimento" data-toc="2014-o-ano-do-crescimento#docker-history.md-2014-o-ano-do-crescimento">2014: O Ano do Crescimento</h3><div class="detached code-block" id="-1140582937#-18vi5e_44"><pre><code class="language-none">
 Docker 1.0 Release     
  Docker Hub        
  Docker Engine     
  Comercializao   
</code></pre></div></section></section><section class="detached"><h2 id="-1140582937#era-moderna-2015-presente" data-toc="era-moderna-2015-presente#docker-history.md-era-moderna-2015-presente">Era Moderna (2015-Presente) <span class="no-bold"></span></h2><section class="detached"><h3 id="-1140582937#2015-o-ecossistema-explode" data-toc="2015-o-ecossistema-explode#docker-history.md-2015-o-ecossistema-explode">2015: O Ecossistema Explode</h3><ul class="list" id="-1140582937#-18vi5e_49" start="1"><li class="list-item" id="-1140582937#-18vi5e_50"><p id="-1140582937#-18vi5e_54">Docker Compose</p></li><li class="list-item" id="-1140582937#-18vi5e_51"><p id="-1140582937#-18vi5e_55">Docker Swarm</p></li><li class="list-item" id="-1140582937#-18vi5e_52"><p id="-1140582937#-18vi5e_56">Docker Machine</p></li><li class="list-item" id="-1140582937#-18vi5e_53"><p id="-1140582937#-18vi5e_57">Docker Toolbox</p></li></ul></section><section class="detached"><h3 id="-1140582937#2016-a-maturidade" data-toc="2016-a-maturidade#docker-history.md-2016-a-maturidade">2016: A Maturidade</h3><div class="detached code-block" id="-1140582937#-18vi5e_58"><pre><code class="language-none">
 Docker for Mac/Windows 
 Containerd           
 Docker Store         
</code></pre></div></section><section class="detached"><h3 id="-1140582937#2017-2019-consolida-o" data-toc="2017-2019-consolida-o#docker-history.md-2017-2019-consolida-o">2017-2019: Consolida&ccedil;&atilde;o</h3><ul class="list" id="-1140582937#-18vi5e_59" start="1"><li class="list-item" id="-1140582937#-18vi5e_60"><p id="-1140582937#-18vi5e_64">Suporte a Kubernetes</p></li><li class="list-item" id="-1140582937#-18vi5e_61"><p id="-1140582937#-18vi5e_65">Docker Enterprise</p></li><li class="list-item" id="-1140582937#-18vi5e_62"><p id="-1140582937#-18vi5e_66">Multi-stage builds</p></li><li class="list-item" id="-1140582937#-18vi5e_63"><p id="-1140582937#-18vi5e_67">BuildKit</p></li></ul></section><section class="detached"><h3 id="-1140582937#2020-nova-era" data-toc="2020-nova-era#docker-history.md-2020-nova-era">2020+: Nova Era</h3><ul class="list" id="-1140582937#-18vi5e_68" start="1"><li class="list-item" id="-1140582937#-18vi5e_69"><p id="-1140582937#-18vi5e_73">Mirantis adquire Docker Enterprise</p></li><li class="list-item" id="-1140582937#-18vi5e_70"><p id="-1140582937#-18vi5e_74">Foco em desenvolvedores</p></li><li class="list-item" id="-1140582937#-18vi5e_71"><p id="-1140582937#-18vi5e_75">Docker Desktop subscription</p></li><li class="list-item" id="-1140582937#-18vi5e_72"><p id="-1140582937#-18vi5e_76">Inova&ccedil;&otilde;es cont&iacute;nuas</p></li></ul></section></section><section class="detached"><h2 id="-1140582937#tecnologias-predecessoras" data-toc="tecnologias-predecessoras#docker-history.md-tecnologias-predecessoras">Tecnologias Predecessoras <span class="no-bold"></span></h2><section class="detached"><h3 id="-1140582937#virtualiza-o-tradicional" data-toc="virtualiza-o-tradicional#docker-history.md-virtualiza-o-tradicional">Virtualiza&ccedil;&atilde;o Tradicional</h3><ul class="list" id="-1140582937#-18vi5e_79" start="1"><li class="list-item" id="-1140582937#-18vi5e_80"><p id="-1140582937#-18vi5e_83">VMware (1998)</p></li><li class="list-item" id="-1140582937#-18vi5e_81"><p id="-1140582937#-18vi5e_84">Xen (2003)</p></li><li class="list-item" id="-1140582937#-18vi5e_82"><p id="-1140582937#-18vi5e_85">KVM (2007)</p></li></ul></section><section class="detached"><h3 id="-1140582937#containers-primitivos" data-toc="containers-primitivos#docker-history.md-containers-primitivos">Containers Primitivos</h3><div class="detached code-block" id="-1140582937#-18vi5e_86"><pre><code class="language-none">
 chroot (1979)      
 BSD Jails (2000)   
 Solaris Zones      
 Linux VServer      
 OpenVZ             
</code></pre></div></section></section><section class="detached"><h2 id="-1140582937#linha-do-tempo-detalhada" data-toc="linha-do-tempo-detalhada#docker-history.md-linha-do-tempo-detalhada">Linha do Tempo Detalhada <span class="no-bold"></span></h2><div class="detached code-block" id="-1140582937#-18vi5e_87"><pre><code class="language-none">1979  chroot
  
2000  FreeBSD Jails
  
2001  Linux VServer
  
2004  Solaris Containers
  
2006  Process Containers (cgroups)
  
2008  LXC
  
2013  Docker inicial
  
2014  Docker 1.0
  
2015  Docker Compose/Swarm
  
2016  Docker for Mac/Windows
  
2017  Kubernetes suporte
  
2020  Nova era Docker</code></pre></div></section><section class="detached"><h2 id="-1140582937#contribui-es-importantes" data-toc="contribui-es-importantes#docker-history.md-contribui-es-importantes">Contribui&ccedil;&otilde;es Importantes</h2><section class="detached"><h3 id="-1140582937#pessoas-chave" data-toc="pessoas-chave#docker-history.md-pessoas-chave">Pessoas Chave</h3><ul class="list" id="-1140582937#-18vi5e_90" start="1"><li class="list-item" id="-1140582937#-18vi5e_91"><p id="-1140582937#-18vi5e_95">Solomon Hykes (Fundador)</p></li><li class="list-item" id="-1140582937#-18vi5e_92"><p id="-1140582937#-18vi5e_96">Andrea Luzzardi (Swarm)</p></li><li class="list-item" id="-1140582937#-18vi5e_93"><p id="-1140582937#-18vi5e_97">Michael Crosby (containerd)</p></li><li class="list-item" id="-1140582937#-18vi5e_94"><p id="-1140582937#-18vi5e_98">Jessie Frazelle (Security)</p></li></ul></section><section class="detached"><h3 id="-1140582937#empresas-pioneiras" data-toc="empresas-pioneiras#docker-history.md-empresas-pioneiras">Empresas Pioneiras</h3><ol class="list list-decimal" id="-1140582937#-18vi5e_99" type="1" start="1"><li class="list-item" id="-1140582937#-18vi5e_100"><p id="-1140582937#-18vi5e_105">dotCloud</p></li><li class="list-item" id="-1140582937#-18vi5e_101"><p id="-1140582937#-18vi5e_106">Docker Inc</p></li><li class="list-item" id="-1140582937#-18vi5e_102"><p id="-1140582937#-18vi5e_107">Red Hat</p></li><li class="list-item" id="-1140582937#-18vi5e_103"><p id="-1140582937#-18vi5e_108">Google</p></li><li class="list-item" id="-1140582937#-18vi5e_104"><p id="-1140582937#-18vi5e_109">Microsoft</p></li></ol></section></section><section class="detached"><h2 id="-1140582937#waifu-tips" data-toc="waifu-tips#docker-history.md-waifu-tips">Waifu Tips</h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-1140582937#-18vi5e_111"><span class="control" id="-1140582937#-18vi5e_112">History-chan diz:</span> &quot;Containers s&atilde;o como ninjas modernos - evolu&iacute;ram de simples ferramentas para mestres do DevOps!&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="-1140582937#legado-e-impacto" data-toc="legado-e-impacto#docker-history.md-legado-e-impacto">Legado e Impacto</h2><section class="detached"><h3 id="-1140582937#na-ind-stria" data-toc="na-ind-stria#docker-history.md-na-ind-stria">Na Ind&uacute;stria</h3><ul class="list" id="-1140582937#-18vi5e_115" start="1"><li class="list-item" id="-1140582937#-18vi5e_116"><p id="-1140582937#-18vi5e_120">Revolu&ccedil;&atilde;o no deployment</p></li><li class="list-item" id="-1140582937#-18vi5e_117"><p id="-1140582937#-18vi5e_121">DevOps transformation</p></li><li class="list-item" id="-1140582937#-18vi5e_118"><p id="-1140582937#-18vi5e_122">Cloud-native movement</p></li><li class="list-item" id="-1140582937#-18vi5e_119"><p id="-1140582937#-18vi5e_123">Microservices adoption</p></li></ul></section><section class="detached"><h3 id="-1140582937#no-desenvolvimento" data-toc="no-desenvolvimento#docker-history.md-no-desenvolvimento">No Desenvolvimento</h3><ul class="list" id="-1140582937#-18vi5e_124" start="1"><li class="list-item" id="-1140582937#-18vi5e_125"><p id="-1140582937#-18vi5e_129">Local development</p></li><li class="list-item" id="-1140582937#-18vi5e_126"><p id="-1140582937#-18vi5e_130">CI/CD pipelines</p></li><li class="list-item" id="-1140582937#-18vi5e_127"><p id="-1140582937#-18vi5e_131">Testing</p></li><li class="list-item" id="-1140582937#-18vi5e_128"><p id="-1140582937#-18vi5e_132">Distribution</p></li></ul></section></section><section class="detached"><h2 id="-1140582937#checkpoint" data-toc="checkpoint#docker-history.md-checkpoint">Checkpoint</h2><p id="-1140582937#-18vi5e_133">Voc&ecirc; agora sabe:</p><ul class="list" id="-1140582937#-18vi5e_134" start="1"><li class="list-item" id="-1140582937#-18vi5e_135"><p id="-1140582937#-18vi5e_139">[x] Origens do Docker</p></li><li class="list-item" id="-1140582937#-18vi5e_136"><p id="-1140582937#-18vi5e_140">[x] Evolu&ccedil;&atilde;o dos containers</p></li><li class="list-item" id="-1140582937#-18vi5e_137"><p id="-1140582937#-18vi5e_141">[x] Marcos importantes</p></li><li class="list-item" id="-1140582937#-18vi5e_138"><p id="-1140582937#-18vi5e_142">[x] Impacto na ind&uacute;stria</p></li></ul></section><section class="detached"><h2 id="-1140582937#exerc-cios" data-toc="exerc-cios#docker-history.md-exerc-cios">Exerc&iacute;cios</h2><ol class="list list-decimal" id="-1140582937#-18vi5e_143" type="1" start="1"><li class="list-item" id="-1140582937#-18vi5e_146"><p id="-1140582937#-18vi5e_149">Pesquise sobre uma tecnologia predecessor do Docker</p></li><li class="list-item" id="-1140582937#-18vi5e_147"><p id="-1140582937#-18vi5e_150">Compare containers modernos com Jails do FreeBSD</p></li><li class="list-item" id="-1140582937#-18vi5e_148"><p id="-1140582937#-18vi5e_151">Crie uma linha do tempo visual da evolu&ccedil;&atilde;o dos containers</p></li></ol><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-1140582937#-18vi5e_152">&quot;Aqueles que n&atilde;o conhecem a hist&oacute;ria dos containers est&atilde;o destinados a recri&aacute;-los usando Bash scripts.&quot;</p><ul class="list" id="-1140582937#-18vi5e_153" start="1"><li class="list-item" id="-1140582937#-18vi5e_154"><p id="-1140582937#-18vi5e_155">DevOps Philosopher, 2025</p></li></ul></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-867919447">Instala&ccedil;&atilde;o do Docker <span class="no-bold"></span></h1><div class="detached code-block" id="-867919447#-2gc52c_3"><pre><code class="language-none">
  I N S T A L L A T I O N   M A T R I X                              
                                                                      
  Escolha sua plula:                                                
   Docker Desktop (modo easy)                                      
   CLI (modo hardcore)                                             
                                                                      
</code></pre></div><section class="detached"><h2 id="-867919447#requisitos-de-sistema" data-toc="requisitos-de-sistema#installation-guide.md-requisitos-de-sistema">Requisitos de Sistema <span class="no-bold"></span></h2><div class="detached code-block" id="-867919447#-2gc52c_5"><pre><code class="language-none">
        Windows           Windows 10/11 Pro/Enterprise/Education  
                          WSL 2 habilitado                       
                          Virtualizao ativada na BIOS          

         Linux            Kernel 3.10+                          
                          systemd                               
                          64-bit                                

         MacOS            macOS 11+                             
                          Apple Silicon ou Intel                
                          4GB RAM (mnimo)                      
</code></pre></div></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-2046990398">Docker Desktop vs CLI: Escolha sua Arma <span class="no-bold"></span></h1><div class="detached code-block" id="-2046990398#-qlobj1_3"><pre><code class="language-none">
  BATTLE ROYALE: GUI vs CLI                                            
                                                                       
  [DOCKER DESKTOP]          VS           [DOCKER CLI]                  
     GUI bonita                           Modo hardcore                
     Mtricas fancy                       Terminal  vida              
     Botes clicveis                     Commands only                
     Newbie friendly                      Chad energy                  
                                                                       
</code></pre></div><section class="detached"><h2 id="-2046990398#docker-desktop-para-os-amantes-de-gui" data-toc="docker-desktop-para-os-amantes-de-gui#docker-desktop-cli.md-docker-desktop-para-os-amantes-de-gui">Docker Desktop: Para os Amantes de GUI <span class="no-bold"></span></h2><section class="detached"><h3 id="-2046990398#pr-s" data-toc="pr-s#docker-desktop-cli.md-pr-s">Pr&oacute;s</h3><ul class="list" id="-2046990398#-qlobj1_14" start="1"><li class="list-item" id="-2046990398#-qlobj1_15"><p id="-2046990398#-qlobj1_20">Interface bonitinha para seus olhos sens&iacute;veis</p></li><li class="list-item" id="-2046990398#-qlobj1_16"><p id="-2046990398#-qlobj1_21">Gr&aacute;ficos de uso de recursos (oooh, cores!)</p></li><li class="list-item" id="-2046990398#-qlobj1_17"><p id="-2046990398#-qlobj1_22">Kubernetes integrado (porque voc&ecirc; <span class="emphasis" id="-2046990398#-qlobj1_23">totalmente</span> vai usar isso)</p></li><li class="list-item" id="-2046990398#-qlobj1_18"><p id="-2046990398#-qlobj1_24">Gest&atilde;o visual de containers (arrasta e solta FTW)</p></li><li class="list-item" id="-2046990398#-qlobj1_19"><p id="-2046990398#-qlobj1_25">Extensions marketplace (mais bloat FTW!)</p></li></ul></section><section class="detached"><h3 id="-2046990398#contras" data-toc="contras#docker-desktop-cli.md-contras">Contras</h3><ul class="list" id="-2046990398#-qlobj1_26" start="1"><li class="list-item" id="-2046990398#-qlobj1_28"><p id="-2046990398#-qlobj1_32">Come RAM como se n&atilde;o houvesse amanh&atilde;</p></li><li class="list-item" id="-2046990398#-qlobj1_29"><p id="-2046990398#-qlobj1_33">Mais pesado que suas responsabilidades</p></li><li class="list-item" id="-2046990398#-qlobj1_30"><p id="-2046990398#-qlobj1_34">Updates constantes (sempre quando voc&ecirc; tem deadline)</p></li><li class="list-item" id="-2046990398#-qlobj1_31"><p id="-2046990398#-qlobj1_35">Pode viciar em cliques</p></li></ul><div class="detached code-block" id="-2046990398#-qlobj1_27"><pre><code class="language-none">
 Resource Usage         
 RAM:         
 CPU:           
 Disk:            
 Your Soul: Gone       
</code></pre></div></section></section><section class="detached"><h2 id="-2046990398#docker-cli-para-os-verdadeiros-hackers" data-toc="docker-cli-para-os-verdadeiros-hackers#docker-desktop-cli.md-docker-cli-para-os-verdadeiros-hackers">Docker CLI: Para os Verdadeiros Hackers <span class="no-bold"></span></h2><section class="detached"><h3 id="-2046990398#pr-s" data-toc="pr-s#docker-desktop-cli.md-pr-s">Pr&oacute;s</h3><ul class="list" id="-2046990398#-qlobj1_38" start="1"><li class="list-item" id="-2046990398#-qlobj1_39"><p id="-2046990398#-qlobj1_44">Leve como uma pluma</p></li><li class="list-item" id="-2046990398#-qlobj1_40"><p id="-2046990398#-qlobj1_45">R&aacute;pido como Flash</p></li><li class="list-item" id="-2046990398#-qlobj1_41"><p id="-2046990398#-qlobj1_46">Scripts automation friendly</p></li><li class="list-item" id="-2046990398#-qlobj1_42"><p id="-2046990398#-qlobj1_47">Street cred na comunidade dev</p></li><li class="list-item" id="-2046990398#-qlobj1_43"><p id="-2046990398#-qlobj1_48">Funciona at&eacute; no seu Nokia 3310</p></li></ul></section><section class="detached"><h3 id="-2046990398#contras" data-toc="contras#docker-desktop-cli.md-contras">Contras</h3><ul class="list" id="-2046990398#-qlobj1_49" start="1"><li class="list-item" id="-2046990398#-qlobj1_51"><p id="-2046990398#-qlobj1_55">Curva de aprendizado vertical</p></li><li class="list-item" id="-2046990398#-qlobj1_52"><p id="-2046990398#-qlobj1_56">Man pages s&atilde;o seu novo melhor amigo</p></li><li class="list-item" id="-2046990398#-qlobj1_53"><p id="-2046990398#-qlobj1_57">Typos s&atilde;o seu novo pior inimigo</p></li><li class="list-item" id="-2046990398#-qlobj1_54"><p id="-2046990398#-qlobj1_58">Precisa decorar comandos (ou usar <span class="inline-code" id="-2046990398#-qlobj1_59">history | grep</span>)</p></li></ul><div class="detached code-block" id="-2046990398#-qlobj1_50"><pre><code class="language-none">
 $ docker run --help             
 &gt; 500 linhas de opes         
 &gt; RTFM, n00b!                  
</code></pre></div></section></section><section class="detached"><h2 id="-2046990398#qual-escolher" data-toc="qual-escolher#docker-desktop-cli.md-qual-escolher">Qual Escolher? <span class="no-bold"></span></h2><section class="detached"><h3 id="-2046990398#use-docker-desktop-se" data-toc="use-docker-desktop-se#docker-desktop-cli.md-use-docker-desktop-se">Use Docker Desktop se:</h3><ul class="list" id="-2046990398#-qlobj1_62" start="1"><li class="list-item" id="-2046990398#-qlobj1_63"><p id="-2046990398#-qlobj1_68">Voc&ecirc; gosta de bot&otilde;es brilhantes</p></li><li class="list-item" id="-2046990398#-qlobj1_64"><p id="-2046990398#-qlobj1_69">Tem 32GB+ de RAM sobrando</p></li><li class="list-item" id="-2046990398#-qlobj1_65"><p id="-2046990398#-qlobj1_70">Precisa de visualiza&ccedil;&atilde;o de m&eacute;tricas</p></li><li class="list-item" id="-2046990398#-qlobj1_66"><p id="-2046990398#-qlobj1_71">Est&aacute; come&ccedil;ando no mundo Docker</p></li><li class="list-item" id="-2046990398#-qlobj1_67"><p id="-2046990398#-qlobj1_72">Tem medo de terminais pretos</p></li></ul></section><section class="detached"><h3 id="-2046990398#use-docker-cli-se" data-toc="use-docker-cli-se#docker-desktop-cli.md-use-docker-cli-se">Use Docker CLI se:</h3><ul class="list" id="-2046990398#-qlobj1_73" start="1"><li class="list-item" id="-2046990398#-qlobj1_74"><p id="-2046990398#-qlobj1_79">Voc&ecirc; &eacute; um verdadeiro cyberpunk</p></li><li class="list-item" id="-2046990398#-qlobj1_75"><p id="-2046990398#-qlobj1_80">Seu terminal tem tema neon</p></li><li class="list-item" id="-2046990398#-qlobj1_76"><p id="-2046990398#-qlobj1_81">Quer impressionar a crush dev</p></li><li class="list-item" id="-2046990398#-qlobj1_77"><p id="-2046990398#-qlobj1_82">Precisa de automa&ccedil;&atilde;o hardcore</p></li><li class="list-item" id="-2046990398#-qlobj1_78"><p id="-2046990398#-qlobj1_83"><span class="inline-code" id="-2046990398#-qlobj1_84">vim</span> &eacute; seu editor principal</p></li></ul></section></section><section class="detached"><h2 id="-2046990398#waifu-tips" data-toc="waifu-tips#docker-desktop-cli.md-waifu-tips">Waifu Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-2046990398#-qlobj1_86"><span class="control" id="-2046990398#-qlobj1_87">CLI-chan diz:</span> &quot;GUIs s&atilde;o tempor&aacute;rias, terminal &eacute; eterno! Mas s&eacute;rio, use o que te faz mais produtivo... baka!&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="-2046990398#guia-de-sobreviv-ncia" data-toc="guia-de-sobreviv-ncia#docker-desktop-cli.md-guia-de-sobreviv-ncia">Guia de Sobreviv&ecirc;ncia <span class="no-bold"></span></h2><section class="detached"><h3 id="-2046990398#docker-desktop" data-toc="docker-desktop#docker-desktop-cli.md-docker-desktop">Docker Desktop</h3><div class="detached code-block" id="-2046990398#-qlobj1_90"><pre><code class="language-bash"># Instalao
1. Download installer
2. Next, next, next, finish
3. Rezar para o PC ainda ligar

# Uso
1. Clique nos containers
2. Aperte play/stop
3. Profit!</code></pre></div></section><section class="detached"><h3 id="-2046990398#docker-cli" data-toc="docker-cli#docker-desktop-cli.md-docker-cli">Docker CLI</h3><div class="detached code-block" id="-2046990398#-qlobj1_91"><pre><code class="language-bash"># Instalao
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
# Agora voc  oficialmente 1337

# Comandos bsicos
docker ps     # Lista containers (seus pods da Matrix)
docker images # Lista imagens (seus programas em stand-by)
docker run    # Roda container (hora do show)
docker kill   # Mata container (com vingana)</code></pre></div></section></section><section class="detached"><h2 id="-2046990398#checkpoint" data-toc="checkpoint#docker-desktop-cli.md-checkpoint">Checkpoint <span class="no-bold"></span></h2><p id="-2046990398#-qlobj1_92">Voc&ecirc; agora sabe:</p><ul class="list" id="-2046990398#-qlobj1_93" start="1"><li class="list-item" id="-2046990398#-qlobj1_94"><p id="-2046990398#-qlobj1_98">[x] Diferen&ccedil;as entre Desktop e CLI</p></li><li class="list-item" id="-2046990398#-qlobj1_95"><p id="-2046990398#-qlobj1_99">[x] Pr&oacute;s e contras de cada um</p></li><li class="list-item" id="-2046990398#-qlobj1_96"><p id="-2046990398#-qlobj1_100">[x] Quando usar cada op&ccedil;&atilde;o</p></li><li class="list-item" id="-2046990398#-qlobj1_97"><p id="-2046990398#-qlobj1_101">[x] Como sobreviver com ambos</p></li></ul></section><section class="detached"><h2 id="-2046990398#exerc-cios" data-toc="exerc-cios#docker-desktop-cli.md-exerc-cios">Exerc&iacute;cios <span class="no-bold"></span></h2><ol class="list list-decimal" id="-2046990398#-qlobj1_102" type="1" start="1"><li class="list-item" id="-2046990398#-qlobj1_103"><p id="-2046990398#-qlobj1_108">Instale ambos e veja quanto RAM voc&ecirc; perde</p></li><li class="list-item" id="-2046990398#-qlobj1_104"><p id="-2046990398#-qlobj1_109">Tente usar s&oacute; CLI por uma semana</p></li><li class="list-item" id="-2046990398#-qlobj1_105"><p id="-2046990398#-qlobj1_110">Conte quantas vezes voc&ecirc; digitou <span class="inline-code" id="-2046990398#-qlobj1_111">docker</span> errado</p></li><li class="list-item" id="-2046990398#-qlobj1_106"><p id="-2046990398#-qlobj1_112">Fa&ccedil;a um alias para seus comandos mais usados</p></li><li class="list-item" id="-2046990398#-qlobj1_107"><p id="-2046990398#-qlobj1_113">Bonus: Customize seu prompt com ASCII art do Docker</p></li></ol></section><section class="detached"><h2 id="-2046990398#projetos-pr-ticos" data-toc="projetos-pr-ticos#docker-desktop-cli.md-projetos-pr-ticos">Projetos Pr&aacute;ticos <span class="no-bold"></span></h2><section class="detached"><h3 id="-2046990398#projeto-1-cli-warrior" data-toc="projeto-1-cli-warrior#docker-desktop-cli.md-projeto-1-cli-warrior">Projeto 1: &quot;CLI Warrior&quot;</h3><p id="-2046990398#-qlobj1_116">Use apenas CLI por 30 dias. B&ocirc;nus se seu terminal tiver tema cyberpunk.</p></section><section class="detached"><h3 id="-2046990398#projeto-2-gui-ninja" data-toc="projeto-2-gui-ninja#docker-desktop-cli.md-projeto-2-gui-ninja">Projeto 2: &quot;GUI Ninja&quot;</h3><p id="-2046990398#-qlobj1_117">Crie um workflow completo usando s&oacute; Docker Desktop. Sem terminal allowed!</p><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-2046990398#-qlobj1_120">&quot;Na Matrix dos containers, n&atilde;o existe colher... nem mouse.&quot; - Morpheus, provavelmente</p></div>
</blockquote>
</section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-302725924">Problemas Comuns: Debugando na Matrix <span class="no-bold"></span></h1><div class="detached code-block" id="-302725924#dsxcax_3"><pre><code class="language-none">
  DOCKER TROUBLE MATRIX                                                
                                                                       
  [ERROR] - Permission denied                                          
  [ERROR] - Port already in use                                        
  [ERROR] - No space left on device                                    
  [ERROR] - Cannot connect to the Docker daemon                        
                                                                       
</code></pre></div><section class="detached"><h2 id="-302725924#problemas-de-permiss-o" data-toc="problemas-de-permiss-o#common-issues.md-problemas-de-permiss-o">Problemas de Permiss&atilde;o <span class="no-bold"></span></h2><section class="detached"><h3 id="-302725924#sintoma" data-toc="sintoma#common-issues.md-sintoma">Sintoma</h3><div class="detached code-block" id="-302725924#dsxcax_17"><pre><code class="language-bash">Got permission denied while trying to connect to the Docker daemon socket</code></pre></div></section><section class="detached"><h3 id="-302725924#solu-o" data-toc="solu-o#common-issues.md-solu-o">Solu&ccedil;&atilde;o</h3><div class="detached code-block" id="-302725924#dsxcax_18"><pre><code class="language-bash"># Adicione seu usurio ao grupo docker
sudo usermod -aG docker $USER

# Recarregue os grupos (ou faa logout/login)
newgrp docker</code></pre></div></section></section><section class="detached"><h2 id="-302725924#conflito-de-portas" data-toc="conflito-de-portas#common-issues.md-conflito-de-portas">Conflito de Portas <span class="no-bold"></span></h2><section class="detached"><h3 id="-302725924#sintoma" data-toc="sintoma#common-issues.md-sintoma">Sintoma</h3><div class="detached code-block" id="-302725924#dsxcax_21"><pre><code class="language-bash">Error: Ports are not available: listen tcp 0.0.0.0:3000: bind: address already in use</code></pre></div></section><section class="detached"><h3 id="-302725924#solu-o" data-toc="solu-o#common-issues.md-solu-o">Solu&ccedil;&atilde;o</h3><div class="detached code-block" id="-302725924#dsxcax_22"><pre><code class="language-bash"># Encontre o processo usando a porta
sudo lsof -i :3000

# Mate o processo (substitua PID)
sudo kill -9 PID

# OU use uma porta diferente
docker run -p 3001:3000 minha-app</code></pre></div></section></section><section class="detached"><h2 id="-302725924#sem-espa-o-em-disco" data-toc="sem-espa-o-em-disco#common-issues.md-sem-espa-o-em-disco">Sem Espa&ccedil;o em Disco <span class="no-bold"></span></h2><section class="detached"><h3 id="-302725924#sintoma" data-toc="sintoma#common-issues.md-sintoma">Sintoma</h3><div class="detached code-block" id="-302725924#dsxcax_25"><pre><code class="language-bash">no space left on device</code></pre></div></section><section class="detached"><h3 id="-302725924#solu-o" data-toc="solu-o#common-issues.md-solu-o">Solu&ccedil;&atilde;o</h3><div class="detached code-block" id="-302725924#dsxcax_26"><pre><code class="language-bash"># Limpe recursos no utilizados
docker system prune -a --volumes

# Verifique o uso de espao
docker system df</code></pre></div></section></section><section class="detached"><h2 id="-302725924#daemon-offline" data-toc="daemon-offline#common-issues.md-daemon-offline">Daemon Offline <span class="no-bold"></span></h2><section class="detached"><h3 id="-302725924#sintoma" data-toc="sintoma#common-issues.md-sintoma">Sintoma</h3><div class="detached code-block" id="-302725924#dsxcax_29"><pre><code class="language-bash">Cannot connect to the Docker daemon at unix:///var/run/docker.sock</code></pre></div></section><section class="detached"><h3 id="-302725924#solu-o" data-toc="solu-o#common-issues.md-solu-o">Solu&ccedil;&atilde;o</h3><div class="detached code-block" id="-302725924#dsxcax_30"><pre><code class="language-bash"># Verifique o status do servio
sudo systemctl status docker

# Reinicie o daemon
sudo systemctl restart docker</code></pre></div></section></section><section class="detached"><h2 id="-302725924#waifu-tips" data-toc="waifu-tips#common-issues.md-waifu-tips">Waifu Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-302725924#dsxcax_32"><span class="control" id="-302725924#dsxcax_33">Debug-chan diz:</span> &quot;Quando tudo falhar, tente <span class="inline-code" id="-302725924#dsxcax_34">docker system prune</span>. Mas cuidado, isso &eacute; tipo formatar o PC - s&oacute; que para containers!&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="-302725924#problemas-de-rede" data-toc="problemas-de-rede#common-issues.md-problemas-de-rede">Problemas de Rede <span class="no-bold"></span></h2><section class="detached"><h3 id="-302725924#sintoma" data-toc="sintoma#common-issues.md-sintoma">Sintoma</h3><div class="detached code-block" id="-302725924#dsxcax_37"><pre><code class="language-bash">ERROR: Network gateway has conflicts with existing routes</code></pre></div></section><section class="detached"><h3 id="-302725924#solu-o" data-toc="solu-o#common-issues.md-solu-o">Solu&ccedil;&atilde;o</h3><div class="detached code-block" id="-302725924#dsxcax_38"><pre><code class="language-bash"># Recrie a rede default
docker network prune
docker network create bridge</code></pre></div></section></section><section class="detached"><h2 id="-302725924#problemas-de-build" data-toc="problemas-de-build#common-issues.md-problemas-de-build">Problemas de Build <span class="no-bold"></span></h2><section class="detached"><h3 id="-302725924#sintoma" data-toc="sintoma#common-issues.md-sintoma">Sintoma</h3><div class="detached code-block" id="-302725924#dsxcax_41"><pre><code class="language-bash">Step 3/8 : RUN npm install
npm ERR! code ECONNREFUSED</code></pre></div></section><section class="detached"><h3 id="-302725924#solu-o" data-toc="solu-o#common-issues.md-solu-o">Solu&ccedil;&atilde;o</h3><div class="detached code-block" id="-302725924#dsxcax_42"><pre><code class="language-bash"># Verifique sua conexo
ping 8.8.8.8

# Use mirror alternativo
npm config set registry https://registry.npmmirror.com</code></pre></div></section></section><section class="detached"><h2 id="-302725924#checklist-de-debug" data-toc="checklist-de-debug#common-issues.md-checklist-de-debug">Checklist de Debug <span class="no-bold"></span></h2><ol class="list list-decimal" id="-302725924#dsxcax_43" type="1" start="1"><li class="list-item" id="-302725924#dsxcax_44"><p id="-302725924#dsxcax_48">Verifique logs</p><div class="detached code-block" id="-302725924#dsxcax_49"><pre><code class="language-bash">docker logs &lt;container-id&gt;</code></pre></div></li><li class="list-item" id="-302725924#dsxcax_45"><p id="-302725924#dsxcax_50">Inspecione o container</p><div class="detached code-block" id="-302725924#dsxcax_51"><pre><code class="language-bash">docker inspect &lt;container-id&gt;</code></pre></div></li><li class="list-item" id="-302725924#dsxcax_46"><p id="-302725924#dsxcax_52">Entre no container</p><div class="detached code-block" id="-302725924#dsxcax_53"><pre><code class="language-bash">docker exec -it &lt;container-id&gt; sh</code></pre></div></li><li class="list-item" id="-302725924#dsxcax_47"><p id="-302725924#dsxcax_54">Monitore recursos</p><div class="detached code-block" id="-302725924#dsxcax_55"><pre><code class="language-bash">docker stats</code></pre></div></li></ol></section><section class="detached"><h2 id="-302725924#preven-o-o-melhor-rem-dio" data-toc="preven-o-o-melhor-rem-dio#common-issues.md-preven-o-o-melhor-rem-dio">Preven&ccedil;&atilde;o &eacute; o Melhor Rem&eacute;dio <span class="no-bold"></span></h2><section class="detached"><h3 id="-302725924#boas-pr-ticas" data-toc="boas-pr-ticas#common-issues.md-boas-pr-ticas">Boas Pr&aacute;ticas</h3><ul class="list" id="-302725924#dsxcax_58" start="1"><li class="list-item" id="-302725924#dsxcax_59"><p id="-302725924#dsxcax_64">Use <span class="inline-code" id="-302725924#dsxcax_65">.dockerignore</span> apropriadamente</p></li><li class="list-item" id="-302725924#dsxcax_60"><p id="-302725924#dsxcax_66">Mantenha imagens base atualizadas</p></li><li class="list-item" id="-302725924#dsxcax_61"><p id="-302725924#dsxcax_67">Implemente health checks</p></li><li class="list-item" id="-302725924#dsxcax_62"><p id="-302725924#dsxcax_68">Monitore uso de recursos</p></li><li class="list-item" id="-302725924#dsxcax_63"><p id="-302725924#dsxcax_69">Fa&ccedil;a backup de volumes importantes</p></li></ul></section><section class="detached"><h3 id="-302725924#ferramentas-teis" data-toc="ferramentas-teis#common-issues.md-ferramentas-teis">Ferramentas &Uacute;teis</h3><ul class="list" id="-302725924#dsxcax_70" start="1"><li class="list-item" id="-302725924#dsxcax_71"><p id="-302725924#dsxcax_75">Portainer (GUI para gest&atilde;o)</p></li><li class="list-item" id="-302725924#dsxcax_72"><p id="-302725924#dsxcax_76">ctop (top para containers)</p></li><li class="list-item" id="-302725924#dsxcax_73"><p id="-302725924#dsxcax_77">lazydocker (TUI amig&aacute;vel)</p></li><li class="list-item" id="-302725924#dsxcax_74"><p id="-302725924#dsxcax_78">docker-compose (orquestra&ccedil;&atilde;o local)</p></li></ul></section></section><section class="detached"><h2 id="-302725924#modo-hardcore-debugging-avan-ado" data-toc="modo-hardcore-debugging-avan-ado#common-issues.md-modo-hardcore-debugging-avan-ado">Modo Hardcore: Debugging Avan&ccedil;ado <span class="no-bold"></span></h2><section class="detached"><h3 id="-302725924#an-lise-de-sistema" data-toc="an-lise-de-sistema#common-issues.md-an-lise-de-sistema">An&aacute;lise de Sistema</h3><div class="detached code-block" id="-302725924#dsxcax_81"><pre><code class="language-bash"># Verifique limites do sistema
ulimit -a

# Monitore eventos do Docker
docker events

# Debug de rede
docker network inspect bridge</code></pre></div></section><section class="detached"><h3 id="-302725924#logs-avan-ados" data-toc="logs-avan-ados#common-issues.md-logs-avan-ados">Logs Avan&ccedil;ados</h3><div class="detached code-block" id="-302725924#dsxcax_82"><pre><code class="language-bash"># Logs em tempo real com timestamp
docker logs -f --timestamps &lt;container-id&gt;

# ltimas 100 linhas
docker logs --tail 100 &lt;container-id&gt;</code></pre></div></section></section><section class="detached"><h2 id="-302725924#recursos-de-emerg-ncia" data-toc="recursos-de-emerg-ncia#common-issues.md-recursos-de-emerg-ncia">Recursos de Emerg&ecirc;ncia <span class="no-bold"></span></h2><ul class="list" id="-302725924#dsxcax_83" start="1"><li class="list-item" id="-302725924#dsxcax_86"><p id="-302725924#dsxcax_89">Docker Debug Guide (<a href="https://docs.docker.com/engine/troubleshoot/">https://docs.docker.com/engine/troubleshoot/</a>)</p></li><li class="list-item" id="-302725924#dsxcax_87"><p id="-302725924#dsxcax_91">Stack Overflow Docker Tag (<a href="https://stackoverflow.com/questions/tagged/docker">https://stackoverflow.com/questions/tagged/docker</a>)</p></li><li class="list-item" id="-302725924#dsxcax_88"><p id="-302725924#dsxcax_93">Docker Forum (<a href="https://forums.docker.com/">https://forums.docker.com/</a>)</p></li></ul><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-302725924#dsxcax_95">&quot;Todo bug &eacute; uma feature que ainda n&atilde;o encontrou seu prop&oacute;sito.&quot; - Hackerman</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="871964087">Containers 101</h1><div class="detached code-block" id="871964087#-xkv88i_3"><pre><code class="language-none">
  CONTAINER BASICS MATRIX                                              
                                                                       
  [ Container = Aplicao + Dependncias + Runtime ]                   
                                                                       
  &quot;Tudo que voc precisa, nada que voc no precisa&quot;                  
                                                                       
</code></pre></div><section class="detached"><h2 id="871964087#o-que-um-container" data-toc="o-que-um-container#containers-101.md-o-que-um-container">O que &eacute; um Container? <span class="no-bold"></span></h2><p id="871964087#-xkv88i_38">Um container &eacute; como uma c&aacute;psula auto-suficiente que cont&eacute;m:</p><ul class="list" id="871964087#-xkv88i_39" start="1"><li class="list-item" id="871964087#-xkv88i_41"><p id="871964087#-xkv88i_45">Sua aplica&ccedil;&atilde;o</p></li><li class="list-item" id="871964087#-xkv88i_42"><p id="871964087#-xkv88i_46">Bibliotecas necess&aacute;rias</p></li><li class="list-item" id="871964087#-xkv88i_43"><p id="871964087#-xkv88i_47">Configura&ccedil;&otilde;es</p></li><li class="list-item" id="871964087#-xkv88i_44"><p id="871964087#-xkv88i_48">Runtime environment</p></li></ul><div class="detached code-block" id="871964087#-xkv88i_40"><pre><code class="language-none">
    Sua Aplicao     

    Dependncias      

      Runtime         
</code></pre></div></section><section class="detached"><h2 id="871964087#anatomia-de-um-container" data-toc="anatomia-de-um-container#containers-101.md-anatomia-de-um-container">Anatomia de um Container <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#componentes-principais" data-toc="componentes-principais#containers-101.md-componentes-principais">Componentes Principais</h3><ol class="list list-decimal" id="871964087#-xkv88i_50" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_51"><p id="871964087#-xkv88i_55"><span class="control" id="871964087#-xkv88i_56">Namespace</span> - Isolamento de processos</p></li><li class="list-item" id="871964087#-xkv88i_52"><p id="871964087#-xkv88i_57"><span class="control" id="871964087#-xkv88i_58">Cgroups</span> - Controle de recursos</p></li><li class="list-item" id="871964087#-xkv88i_53"><p id="871964087#-xkv88i_59"><span class="control" id="871964087#-xkv88i_60">Union Filesystem</span> - Sistema de arquivos em camadas</p></li><li class="list-item" id="871964087#-xkv88i_54"><p id="871964087#-xkv88i_61"><span class="control" id="871964087#-xkv88i_62">Container Runtime</span> - Motor de execu&ccedil;&atilde;o</p></li></ol></section></section><section class="detached"><h2 id="871964087#por-que-usar-containers" data-toc="por-que-usar-containers#containers-101.md-por-que-usar-containers">Por Que Usar Containers? <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#benef-cios" data-toc="benef-cios#containers-101.md-benef-cios">Benef&iacute;cios</h3><ul class="list" id="871964087#-xkv88i_64" start="1"><li class="list-item" id="871964087#-xkv88i_65"><p id="871964087#-xkv88i_70">Isolamento consistente</p></li><li class="list-item" id="871964087#-xkv88i_66"><p id="871964087#-xkv88i_71">Portabilidade garantida</p></li><li class="list-item" id="871964087#-xkv88i_67"><p id="871964087#-xkv88i_72">Deploy simplificado</p></li><li class="list-item" id="871964087#-xkv88i_68"><p id="871964087#-xkv88i_73">Escalabilidade f&aacute;cil</p></li><li class="list-item" id="871964087#-xkv88i_69"><p id="871964087#-xkv88i_74">Versionamento eficiente</p></li></ul></section></section><section class="detached"><h2 id="871964087#waifu-tips" data-toc="waifu-tips#containers-101.md-waifu-tips">Waifu Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="871964087#-xkv88i_76"><span class="control" id="871964087#-xkv88i_77">Container-chan diz:</span> &quot;Lembre-se: containers s&atilde;o ef&ecirc;meros! Se algo importante mudar, ser&aacute; perdido no pr&oacute;ximo restart... como l&aacute;grimas na chuva!&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="871964087#conceitos-fundamentais" data-toc="conceitos-fundamentais#containers-101.md-conceitos-fundamentais">Conceitos Fundamentais <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#1-imutabilidade" data-toc="1-imutabilidade#containers-101.md-1-imutabilidade">1. Imutabilidade</h3><ul class="list" id="871964087#-xkv88i_81" start="1"><li class="list-item" id="871964087#-xkv88i_82"><p id="871964087#-xkv88i_85">Containers n&atilde;o devem ser modificados em runtime</p></li><li class="list-item" id="871964087#-xkv88i_83"><p id="871964087#-xkv88i_86">Mudan&ccedil;as atrav&eacute;s de novas builds</p></li><li class="list-item" id="871964087#-xkv88i_84"><p id="871964087#-xkv88i_87">Tratados como gado, n&atilde;o como pets</p></li></ul></section><section class="detached"><h3 id="871964087#2-isolamento" data-toc="2-isolamento#containers-101.md-2-isolamento">2. Isolamento</h3><div class="detached code-block" id="871964087#-xkv88i_88"><pre><code class="language-none">App 1  App 2
              
     Process                Process       
              
                                             
              
    Filesystem             Filesystem     
              
  </code></pre></div></section><section class="detached"><h3 id="871964087#3-recursos-limitados" data-toc="3-recursos-limitados#containers-101.md-3-recursos-limitados">3. Recursos Limitados</h3><ul class="list" id="871964087#-xkv88i_89" start="1"><li class="list-item" id="871964087#-xkv88i_90"><p id="871964087#-xkv88i_94">CPU controlada</p></li><li class="list-item" id="871964087#-xkv88i_91"><p id="871964087#-xkv88i_95">Mem&oacute;ria definida</p></li><li class="list-item" id="871964087#-xkv88i_92"><p id="871964087#-xkv88i_96">I/O gerenciado</p></li><li class="list-item" id="871964087#-xkv88i_93"><p id="871964087#-xkv88i_97">Network isolada</p></li></ul></section></section><section class="detached"><h2 id="871964087#primeiros-passos" data-toc="primeiros-passos#containers-101.md-primeiros-passos">Primeiros Passos <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#hello-world-container" data-toc="hello-world-container#containers-101.md-hello-world-container">Hello World Container</h3><div class="detached code-block" id="871964087#-xkv88i_100"><pre><code class="language-bash"># Rode seu primeiro container
docker run hello-world

# Veja o que est rodando
docker ps

# Veja todos os containers
docker ps -a</code></pre></div></section><section class="detached"><h3 id="871964087#container-interativo" data-toc="container-interativo#containers-101.md-container-interativo">Container Interativo</h3><div class="detached code-block" id="871964087#-xkv88i_101"><pre><code class="language-bash"># Ubuntu container interativo
docker run -it ubuntu bash

# Alpine container leve
docker run -it alpine sh</code></pre></div></section></section><section class="detached"><h2 id="871964087#container-lifecycle" data-toc="container-lifecycle#containers-101.md-container-lifecycle">Container Lifecycle <span class="no-bold"></span></h2><div class="detached code-block" id="871964087#-xkv88i_102"><pre><code class="language-none">        
 Created     Running     Stopped  
        
                                    
      </code></pre></div><section class="detached"><h3 id="871964087#comandos-de-ciclo-de-vida" data-toc="comandos-de-ciclo-de-vida#containers-101.md-comandos-de-ciclo-de-vida">Comandos de Ciclo de Vida</h3><div class="detached code-block" id="871964087#-xkv88i_104"><pre><code class="language-bash"># Criar container
docker create nginx

# Iniciar container
docker start &lt;container-id&gt;

# Parar container
docker stop &lt;container-id&gt;

# Remover container
docker rm &lt;container-id&gt;</code></pre></div></section></section><section class="detached"><h2 id="871964087#pr-ticas-recomendadas" data-toc="pr-ticas-recomendadas#containers-101.md-pr-ticas-recomendadas">Pr&aacute;ticas Recomendadas <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#do-s" data-toc="do-s#containers-101.md-do-s">DO's <span class="no-bold"></span></h3><ul class="list" id="871964087#-xkv88i_107" start="1"><li class="list-item" id="871964087#-xkv88i_108"><p id="871964087#-xkv88i_113">Um processo por container</p></li><li class="list-item" id="871964087#-xkv88i_109"><p id="871964087#-xkv88i_114">Use tags espec&iacute;ficas</p></li><li class="list-item" id="871964087#-xkv88i_110"><p id="871964087#-xkv88i_115">Defina limites de recursos</p></li><li class="list-item" id="871964087#-xkv88i_111"><p id="871964087#-xkv88i_116">Monitore seus containers</p></li><li class="list-item" id="871964087#-xkv88i_112"><p id="871964087#-xkv88i_117">Use health checks</p></li></ul></section><section class="detached"><h3 id="871964087#don-ts" data-toc="don-ts#containers-101.md-don-ts">DON'Ts <span class="no-bold"></span></h3><ul class="list" id="871964087#-xkv88i_118" start="1"><li class="list-item" id="871964087#-xkv88i_119"><p id="871964087#-xkv88i_124">N&atilde;o armazene dados no container</p></li><li class="list-item" id="871964087#-xkv88i_120"><p id="871964087#-xkv88i_125">Evite containers muito grandes</p></li><li class="list-item" id="871964087#-xkv88i_121"><p id="871964087#-xkv88i_126">N&atilde;o use <span class="inline-code" id="871964087#-xkv88i_127">latest</span> tag</p></li><li class="list-item" id="871964087#-xkv88i_122"><p id="871964087#-xkv88i_128">N&atilde;o rode como root</p></li><li class="list-item" id="871964087#-xkv88i_123"><p id="871964087#-xkv88i_129">N&atilde;o ignore security scans</p></li></ul></section></section><section class="detached"><h2 id="871964087#exerc-cios-pr-ticos" data-toc="exerc-cios-pr-ticos#containers-101.md-exerc-cios-pr-ticos">Exerc&iacute;cios Pr&aacute;ticos <span class="no-bold"></span></h2><ol class="list list-decimal" id="871964087#-xkv88i_130" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_131"><p id="871964087#-xkv88i_134"><span class="control" id="871964087#-xkv88i_136">Hello Container</span></p><div class="detached code-block" id="871964087#-xkv88i_135"><pre><code class="language-bash"># Rode e entenda o hello-world
docker run hello-world</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_132"><p id="871964087#-xkv88i_137"><span class="control" id="871964087#-xkv88i_139">Container Persistente</span></p><div class="detached code-block" id="871964087#-xkv88i_138"><pre><code class="language-bash"># Rode nginx com porta exposta
docker run -d -p 8080:80 nginx</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_133"><p id="871964087#-xkv88i_140"><span class="control" id="871964087#-xkv88i_142">Container Explora&ccedil;&atilde;o</span></p><div class="detached code-block" id="871964087#-xkv88i_141"><pre><code class="language-bash"># Entre em um container rodando
docker exec -it &lt;container-id&gt; bash</code></pre></div></li></ol></section><section class="detached"><h2 id="871964087#debug-b-sico" data-toc="debug-b-sico#containers-101.md-debug-b-sico">Debug B&aacute;sico <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#comandos-essenciais" data-toc="comandos-essenciais#containers-101.md-comandos-essenciais">Comandos Essenciais</h3><div class="detached code-block" id="871964087#-xkv88i_144"><pre><code class="language-bash"># Logs do container
docker logs &lt;container-id&gt;

# Processos rodando
docker top &lt;container-id&gt;

# Estatsticas de uso
docker stats &lt;container-id&gt;</code></pre></div></section></section><section class="detached"><h2 id="871964087#checkpoint" data-toc="checkpoint#containers-101.md-checkpoint">Checkpoint <span class="no-bold"></span></h2><p id="871964087#-xkv88i_145">Voc&ecirc; agora sabe:</p><ul class="list" id="871964087#-xkv88i_146" start="1"><li class="list-item" id="871964087#-xkv88i_147"><p id="871964087#-xkv88i_152">[x] O que s&atilde;o containers</p></li><li class="list-item" id="871964087#-xkv88i_148"><p id="871964087#-xkv88i_153">[x] Como eles funcionam</p></li><li class="list-item" id="871964087#-xkv88i_149"><p id="871964087#-xkv88i_154">[x] Comandos b&aacute;sicos</p></li><li class="list-item" id="871964087#-xkv88i_150"><p id="871964087#-xkv88i_155">[x] Boas pr&aacute;ticas</p></li><li class="list-item" id="871964087#-xkv88i_151"><p id="871964087#-xkv88i_156">[x] Ciclo de vida</p></li></ul></section><section class="detached"><h2 id="871964087#pr-ximos-passos" data-toc="pr-ximos-passos#containers-101.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="871964087#-xkv88i_157" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_160"><p id="871964087#-xkv88i_165">Explore Docker Hub</p></li><li class="list-item" id="871964087#-xkv88i_161"><p id="871964087#-xkv88i_166">Crie seus pr&oacute;prios containers</p></li><li class="list-item" id="871964087#-xkv88i_162"><p id="871964087#-xkv88i_167">Aprenda sobre networking</p></li><li class="list-item" id="871964087#-xkv88i_163"><p id="871964087#-xkv88i_168">Estude volumes</p></li><li class="list-item" id="871964087#-xkv88i_164"><p id="871964087#-xkv88i_169">Pratique com projetos reais</p></li></ol><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="871964087#-xkv88i_170">&quot;No mundo dos containers, n&atilde;o existe 'funciona na minha m&aacute;quina' - porque sua m&aacute;quina est&aacute; no container!&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="871964087#deep-dive-camadas-de-um-container" data-toc="deep-dive-camadas-de-um-container#containers-101.md-deep-dive-camadas-de-um-container">Deep Dive: Camadas de um Container </h2><section class="detached"><h3 id="871964087#union-file-system" data-toc="union-file-system#containers-101.md-union-file-system">Union File System</h3><div class="detached code-block" id="871964087#-xkv88i_173"><pre><code class="language-none">
    Camada R/W           &lt;- Container Layer

    Aplicao            &lt;- Image Layer 3

    Dependncias         &lt;- Image Layer 2

    Sistema Base         &lt;- Image Layer 1
</code></pre></div></section><section class="detached"><h3 id="871964087#como-as-camadas-funcionam" data-toc="como-as-camadas-funcionam#containers-101.md-como-as-camadas-funcionam">Como as Camadas Funcionam</h3><ol class="list list-decimal" id="871964087#-xkv88i_174" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_175"><p id="871964087#-xkv88i_179"><span class="control" id="871964087#-xkv88i_180">Base Layer</span>: Sistema operacional m&iacute;nimo</p></li><li class="list-item" id="871964087#-xkv88i_176"><p id="871964087#-xkv88i_181"><span class="control" id="871964087#-xkv88i_182">Middleware Layer</span>: Runtime, libs</p></li><li class="list-item" id="871964087#-xkv88i_177"><p id="871964087#-xkv88i_183"><span class="control" id="871964087#-xkv88i_184">Application Layer</span>: Seu c&oacute;digo</p></li><li class="list-item" id="871964087#-xkv88i_178"><p id="871964087#-xkv88i_185"><span class="control" id="871964087#-xkv88i_186">Container Layer</span>: Mudan&ccedil;as em runtime</p></li></ol></section></section><section class="detached"><h2 id="871964087#networking-b-sico" data-toc="networking-b-sico#containers-101.md-networking-b-sico">Networking B&aacute;sico <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#tipos-de-rede" data-toc="tipos-de-rede#containers-101.md-tipos-de-rede">Tipos de Rede</h3><div class="detached code-block" id="871964087#-xkv88i_189"><pre><code class="language-bash"># Lista redes disponveis
docker network ls

# Cria rede customizada
docker network create minha-rede

# Conecta container  rede
docker network connect minha-rede container-id</code></pre></div></section><section class="detached"><h3 id="871964087#modelos-de-rede" data-toc="modelos-de-rede#containers-101.md-modelos-de-rede">Modelos de Rede</h3><ol class="list list-decimal" id="871964087#-xkv88i_190" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_191"><p id="871964087#-xkv88i_194"><span class="control" id="871964087#-xkv88i_196">Bridge</span> (default)</p><div class="detached code-block" id="871964087#-xkv88i_195"><pre><code class="language-bash">docker run --network bridge nginx</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_192"><p id="871964087#-xkv88i_197"><span class="control" id="871964087#-xkv88i_199">Host</span> (usa rede do host)</p><div class="detached code-block" id="871964087#-xkv88i_198"><pre><code class="language-bash">docker run --network host nginx</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_193"><p id="871964087#-xkv88i_200"><span class="control" id="871964087#-xkv88i_202">None</span> (sem rede)</p><div class="detached code-block" id="871964087#-xkv88i_201"><pre><code class="language-bash">docker run --network none nginx</code></pre></div></li></ol></section></section><section class="detached"><h2 id="871964087#storage-volumes" data-toc="storage-volumes#containers-101.md-storage-volumes">Storage &amp; Volumes <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#tipos-de-storage" data-toc="tipos-de-storage#containers-101.md-tipos-de-storage">Tipos de Storage</h3><ol class="list list-decimal" id="871964087#-xkv88i_204" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_205"><p id="871964087#-xkv88i_208"><span class="control" id="871964087#-xkv88i_210">Volumes</span> (gerenciado pelo Docker)</p><div class="detached code-block" id="871964087#-xkv88i_209"><pre><code class="language-bash"># Cria volume
docker volume create meu-volume

# Usa volume
docker run -v meu-volume:/data nginx</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_206"><p id="871964087#-xkv88i_211"><span class="control" id="871964087#-xkv88i_213">Bind Mounts</span> (path do host)</p><div class="detached code-block" id="871964087#-xkv88i_212"><pre><code class="language-bash"># Monta diretrio local
docker run -v $(pwd):/app nginx</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_207"><p id="871964087#-xkv88i_214"><span class="control" id="871964087#-xkv88i_216">tmpfs</span> (mem&oacute;ria)</p><div class="detached code-block" id="871964087#-xkv88i_215"><pre><code class="language-bash"># Armazenamento temporrio
docker run --tmpfs /app nginx</code></pre></div></li></ol></section></section><section class="detached"><h2 id="871964087#container-security" data-toc="container-security#containers-101.md-container-security">Container Security <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#boas-pr-ticas-de-seguran-a" data-toc="boas-pr-ticas-de-seguran-a#containers-101.md-boas-pr-ticas-de-seguran-a">Boas Pr&aacute;ticas de Seguran&ccedil;a</h3><ol class="list list-decimal" id="871964087#-xkv88i_218" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_219"><p id="871964087#-xkv88i_222"><span class="control" id="871964087#-xkv88i_224">Rootless Containers</span></p><div class="detached code-block" id="871964087#-xkv88i_223"><pre><code class="language-none"># No Dockerfile
USER non-root-user</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_220"><p id="871964087#-xkv88i_225"><span class="control" id="871964087#-xkv88i_227">Scan de Vulnerabilidades</span></p><div class="detached code-block" id="871964087#-xkv88i_226"><pre><code class="language-bash"># Scan de imagem
docker scan nginx:latest</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_221"><p id="871964087#-xkv88i_228"><span class="control" id="871964087#-xkv88i_230">Limites de Recursos</span></p><div class="detached code-block" id="871964087#-xkv88i_229"><pre><code class="language-bash"># Limita CPU e memria
docker run --cpus=.5 --memory=512m nginx</code></pre></div></li></ol></section></section><section class="detached"><h2 id="871964087#advanced-commands" data-toc="advanced-commands#containers-101.md-advanced-commands">Advanced Commands <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#container-stats" data-toc="container-stats#containers-101.md-container-stats">Container Stats</h3><div class="detached code-block" id="871964087#-xkv88i_233"><pre><code class="language-bash"># Stats em tempo real
docker stats --format &quot;table {{.Name}}\t{{.CPUPerc}}\t{{.MemUsage}}&quot;

# Info detalhada
docker inspect container-id</code></pre></div></section><section class="detached"><h3 id="871964087#batch-operations" data-toc="batch-operations#containers-101.md-batch-operations">Batch Operations</h3><div class="detached code-block" id="871964087#-xkv88i_234"><pre><code class="language-bash"># Para todos containers
docker stop $(docker ps -q)

# Remove containers parados
docker container prune

# Remove tudo
docker system prune -a</code></pre></div></section></section><section class="detached"><h2 id="871964087#troubleshooting-matrix" data-toc="troubleshooting-matrix#containers-101.md-troubleshooting-matrix">Troubleshooting Matrix <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#common-issues" data-toc="common-issues#containers-101.md-common-issues">Common Issues</h3><div class="table-wrapper detached"><table id="871964087#-xkv88i_237"><tr class="header-row" id="871964087#-xkv88i_238"><th id="871964087#-xkv88i_242"><p>Problema</p></th><th id="871964087#-xkv88i_243"><p>Comando de Debug</p></th><th id="871964087#-xkv88i_244"><p>Solu&ccedil;&atilde;o</p></th></tr><tr class="" id="871964087#-xkv88i_239"><td id="871964087#-xkv88i_245"><p>Container n&atilde;o inicia</p></td><td id="871964087#-xkv88i_246"><p><span class="inline-code" id="871964087#-xkv88i_248">docker logs</span></p></td><td id="871964087#-xkv88i_247"><p>Verifique logs</p></td></tr><tr class="" id="871964087#-xkv88i_240"><td id="871964087#-xkv88i_249"><p>Porta em uso</p></td><td id="871964087#-xkv88i_250"><p><span class="inline-code" id="871964087#-xkv88i_252">docker port</span></p></td><td id="871964087#-xkv88i_251"><p>Mude a porta</p></td></tr><tr class="" id="871964087#-xkv88i_241"><td id="871964087#-xkv88i_253"><p>Sem espa&ccedil;o</p></td><td id="871964087#-xkv88i_254"><p><span class="inline-code" id="871964087#-xkv88i_256">docker system df</span></p></td><td id="871964087#-xkv88i_255"><p>Limpe recursos</p></td></tr></table></div></section><section class="detached"><h3 id="871964087#debug-commands" data-toc="debug-commands#containers-101.md-debug-commands">Debug Commands</h3><div class="detached code-block" id="871964087#-xkv88i_257"><pre><code class="language-bash"># Histrico de comandos
docker history imagem:tag

# Eventos em tempo real
docker events

# Diff de alteraes
docker diff container-id</code></pre></div></section></section><section class="detached"><h2 id="871964087#container-development-workflow" data-toc="container-development-workflow#containers-101.md-container-development-workflow">Container Development Workflow <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#local-development" data-toc="local-development#containers-101.md-local-development">Local Development</h3><ol class="list list-decimal" id="871964087#-xkv88i_260" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_261"><p id="871964087#-xkv88i_264"><span class="control" id="871964087#-xkv88i_266">Build Local</span></p><div class="detached code-block" id="871964087#-xkv88i_265"><pre><code class="language-bash">docker build -t app:dev .</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_262"><p id="871964087#-xkv88i_267"><span class="control" id="871964087#-xkv88i_269">Hot Reload</span></p><div class="detached code-block" id="871964087#-xkv88i_268"><pre><code class="language-bash">docker run -v $(pwd):/app app:dev</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_263"><p id="871964087#-xkv88i_270"><span class="control" id="871964087#-xkv88i_272">Debug Mode</span></p><div class="detached code-block" id="871964087#-xkv88i_271"><pre><code class="language-bash">docker run --rm -it app:dev sh</code></pre></div></li></ol></section><section class="detached"><h3 id="871964087#multi-container-setup" data-toc="multi-container-setup#containers-101.md-multi-container-setup">Multi-container Setup</h3><div class="detached code-block" id="871964087#-xkv88i_273"><pre><code class="language-yaml"># docker-compose.yml
version: '3.8'
services:
  app:
    build: .
    ports:
      - &quot;3000:3000&quot;
  db:
    image: postgres
    environment:
      POSTGRES_PASSWORD: secret</code></pre></div></section></section><section class="detached"><h2 id="871964087#performance-tuning" data-toc="performance-tuning#containers-101.md-performance-tuning">Performance Tuning <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#otimiza-es" data-toc="otimiza-es#containers-101.md-otimiza-es">Otimiza&ccedil;&otilde;es</h3><ol class="list list-decimal" id="871964087#-xkv88i_275" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_276"><p id="871964087#-xkv88i_279"><span class="control" id="871964087#-xkv88i_281">Multi-stage Builds</span></p><div class="detached code-block" id="871964087#-xkv88i_280"><pre><code class="language-none">FROM node:alpine AS builder
WORKDIR /app
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_277"><p id="871964087#-xkv88i_282"><span class="control" id="871964087#-xkv88i_284">Cache Optimization</span></p><div class="detached code-block" id="871964087#-xkv88i_283"><pre><code class="language-none">COPY package*.json ./
RUN npm install
COPY . .</code></pre></div></li><li class="list-item" id="871964087#-xkv88i_278"><p id="871964087#-xkv88i_285"><span class="control" id="871964087#-xkv88i_287">Resource Limits</span></p><div class="detached code-block" id="871964087#-xkv88i_286"><pre><code class="language-bash">docker run \
  --cpus=2 \
  --memory=2g \
  --memory-reservation=1g \
  --memory-swap=4g \
  nginx</code></pre></div></li></ol></section></section><section class="detached"><h2 id="871964087#waifu-advanced-tips" data-toc="waifu-advanced-tips#containers-101.md-waifu-advanced-tips">Waifu Advanced Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="871964087#-xkv88i_290"><span class="control" id="871964087#-xkv88i_291">Container-chan Advanced Tip:</span> &quot;Multi-stage builds s&atilde;o como fazer cosplay - voc&ecirc; usa diferentes outfits (stages) para chegar no resultado final perfeito!&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="871964087#-xkv88i_292"><span class="control" id="871964087#-xkv88i_293">Security-chan Warning:</span> &quot;Nunca confie em imagens de fontes desconhecidas - &eacute; como aceitar doces de estranhos!&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="871964087#container-patterns" data-toc="container-patterns#containers-101.md-container-patterns">Container Patterns <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#sidecar-pattern" data-toc="sidecar-pattern#containers-101.md-sidecar-pattern">Sidecar Pattern</h3><div class="detached code-block" id="871964087#-xkv88i_296"><pre><code class="language-none">
  Main Container    
   
                         
   
  Sidecar Container 
</code></pre></div></section><section class="detached"><h3 id="871964087#ambassador-pattern" data-toc="ambassador-pattern#containers-101.md-ambassador-pattern">Ambassador Pattern</h3><div class="detached code-block" id="871964087#-xkv88i_297"><pre><code class="language-none">   
  Main Container       Ambassador   
   </code></pre></div></section></section><section class="detached"><h2 id="871964087#exerc-cios-avan-ados" data-toc="exerc-cios-avan-ados#containers-101.md-exerc-cios-avan-ados">Exerc&iacute;cios Avan&ccedil;ados <span class="no-bold"></span>&zwj;</h2><ol class="list list-decimal" id="871964087#-xkv88i_298" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_299"><p id="871964087#-xkv88i_302"><span class="control" id="871964087#-xkv88i_304">Multi-container App</span></p><ul class="list" id="871964087#-xkv88i_303" start="1"><li class="list-item" id="871964087#-xkv88i_305"><p id="871964087#-xkv88i_308">Crie uma aplica&ccedil;&atilde;o web com frontend, backend e database</p></li><li class="list-item" id="871964087#-xkv88i_306"><p id="871964087#-xkv88i_309">Use docker-compose</p></li><li class="list-item" id="871964087#-xkv88i_307"><p id="871964087#-xkv88i_310">Implemente volumes persistentes</p></li></ul></li><li class="list-item" id="871964087#-xkv88i_300"><p id="871964087#-xkv88i_311"><span class="control" id="871964087#-xkv88i_313">Custom Network</span></p><ul class="list" id="871964087#-xkv88i_312" start="1"><li class="list-item" id="871964087#-xkv88i_314"><p id="871964087#-xkv88i_317">Configure rede bridge customizada</p></li><li class="list-item" id="871964087#-xkv88i_315"><p id="871964087#-xkv88i_318">Conecte m&uacute;ltiplos containers</p></li><li class="list-item" id="871964087#-xkv88i_316"><p id="871964087#-xkv88i_319">Teste comunica&ccedil;&atilde;o entre containers</p></li></ul></li><li class="list-item" id="871964087#-xkv88i_301"><p id="871964087#-xkv88i_320"><span class="control" id="871964087#-xkv88i_322">Resource Monitoring</span></p><ul class="list" id="871964087#-xkv88i_321" start="1"><li class="list-item" id="871964087#-xkv88i_323"><p id="871964087#-xkv88i_326">Configure limites de recursos</p></li><li class="list-item" id="871964087#-xkv88i_324"><p id="871964087#-xkv88i_327">Monitore uso com docker stats</p></li><li class="list-item" id="871964087#-xkv88i_325"><p id="871964087#-xkv88i_328">Implemente health checks</p></li></ul></li></ol></section><section class="detached"><h2 id="871964087#certifica-o-checkpoint" data-toc="certifica-o-checkpoint#containers-101.md-certifica-o-checkpoint">Certifica&ccedil;&atilde;o Checkpoint <span class="no-bold"></span></h2><p id="871964087#-xkv88i_329">Prepare-se para certifica&ccedil;&otilde;es Docker com estes conceitos:</p><ul class="list" id="871964087#-xkv88i_330" start="1"><li class="list-item" id="871964087#-xkv88i_331"><p id="871964087#-xkv88i_338">[x] Container internals</p></li><li class="list-item" id="871964087#-xkv88i_332"><p id="871964087#-xkv88i_339">[x] Networking modes</p></li><li class="list-item" id="871964087#-xkv88i_333"><p id="871964087#-xkv88i_340">[x] Storage options</p></li><li class="list-item" id="871964087#-xkv88i_334"><p id="871964087#-xkv88i_341">[x] Security best practices</p></li><li class="list-item" id="871964087#-xkv88i_335"><p id="871964087#-xkv88i_342">[x] Resource management</p></li><li class="list-item" id="871964087#-xkv88i_336"><p id="871964087#-xkv88i_343">[x] Troubleshooting</p></li><li class="list-item" id="871964087#-xkv88i_337"><p id="871964087#-xkv88i_344">[x] Container patterns</p></li></ul></section><section class="detached"><h2 id="871964087#links-teis" data-toc="links-teis#containers-101.md-links-teis">Links &Uacute;teis <span class="no-bold"></span></h2><ul class="list" id="871964087#-xkv88i_345" start="1"><li class="list-item" id="871964087#-xkv88i_348"><p id="871964087#-xkv88i_351">Docker Hub (<a href="https://hub.docker.com">https://hub.docker.com</a>)</p></li><li class="list-item" id="871964087#-xkv88i_349"><p id="871964087#-xkv88i_353">Docker Docs (<a href="https://docs.docker.com">https://docs.docker.com</a>)</p></li><li class="list-item" id="871964087#-xkv88i_350"><p id="871964087#-xkv88i_355">Play with Docker (<a href="https://labs.play-with-docker.com">https://labs.play-with-docker.com</a>)</p></li></ul><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="871964087#-xkv88i_357">&quot;Um container bem configurado &eacute; como um bom c&oacute;digo - ele faz exatamente o que deveria fazer, nada mais, nada menos.&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="871964087#stateful-vs-stateless" data-toc="stateful-vs-stateless#containers-101.md-stateful-vs-stateless">Stateful vs Stateless <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#stateless-containers" data-toc="stateless-containers#containers-101.md-stateless-containers">Stateless Containers</h3><div class="detached code-block" id="871964087#-xkv88i_360"><pre><code class="language-none">
  Stateless App     
    
     Request      
     Process     Response
     Response     
    

     No State </code></pre></div><section class="detached"><h4 id="871964087#caracter-sticas" data-toc="caracter-sticas#containers-101.md-caracter-sticas">Caracter&iacute;sticas</h4><ul class="list" id="871964087#-xkv88i_363" start="1"><li class="list-item" id="871964087#-xkv88i_364"><p id="871964087#-xkv88i_368">N&atilde;o mant&eacute;m estado entre requisi&ccedil;&otilde;es</p></li><li class="list-item" id="871964087#-xkv88i_365"><p id="871964087#-xkv88i_369">Facilmente escal&aacute;vel</p></li><li class="list-item" id="871964087#-xkv88i_366"><p id="871964087#-xkv88i_370">Pode ser substitu&iacute;do a qualquer momento</p></li><li class="list-item" id="871964087#-xkv88i_367"><p id="871964087#-xkv88i_371">Ideal para microservi&ccedil;os</p></li></ul></section><section class="detached"><h4 id="871964087#exemplos-de-uso" data-toc="exemplos-de-uso#containers-101.md-exemplos-de-uso">Exemplos de Uso</h4><ul class="list" id="871964087#-xkv88i_372" start="1"><li class="list-item" id="871964087#-xkv88i_373"><p id="871964087#-xkv88i_377">Web servers</p></li><li class="list-item" id="871964087#-xkv88i_374"><p id="871964087#-xkv88i_378">API endpoints</p></li><li class="list-item" id="871964087#-xkv88i_375"><p id="871964087#-xkv88i_379">Processamento de filas</p></li><li class="list-item" id="871964087#-xkv88i_376"><p id="871964087#-xkv88i_380">Transforma&ccedil;&atilde;o de dados</p></li></ul></section></section><section class="detached"><h3 id="871964087#stateful-containers" data-toc="stateful-containers#containers-101.md-stateful-containers">Stateful Containers</h3><div class="detached code-block" id="871964087#-xkv88i_381"><pre><code class="language-none">
   Stateful App     
    
     Process      
    
                   
    
      State       
    

    Persistent </code></pre></div><section class="detached"><h4 id="871964087#caracter-sticas" data-toc="caracter-sticas#containers-101.md-caracter-sticas">Caracter&iacute;sticas</h4><ul class="list" id="871964087#-xkv88i_384" start="1"><li class="list-item" id="871964087#-xkv88i_385"><p id="871964087#-xkv88i_389">Mant&eacute;m dados entre restarts</p></li><li class="list-item" id="871964087#-xkv88i_386"><p id="871964087#-xkv88i_390">Requer volumes persistentes</p></li><li class="list-item" id="871964087#-xkv88i_387"><p id="871964087#-xkv88i_391">Mais complexo para escalar</p></li><li class="list-item" id="871964087#-xkv88i_388"><p id="871964087#-xkv88i_392">Precisa de backup strategy</p></li></ul></section><section class="detached"><h4 id="871964087#exemplos-de-uso" data-toc="exemplos-de-uso#containers-101.md-exemplos-de-uso">Exemplos de Uso</h4><ul class="list" id="871964087#-xkv88i_393" start="1"><li class="list-item" id="871964087#-xkv88i_394"><p id="871964087#-xkv88i_398">Databases</p></li><li class="list-item" id="871964087#-xkv88i_395"><p id="871964087#-xkv88i_399">Cache systems</p></li><li class="list-item" id="871964087#-xkv88i_396"><p id="871964087#-xkv88i_400">Message queues</p></li><li class="list-item" id="871964087#-xkv88i_397"><p id="871964087#-xkv88i_401">Session stores</p></li></ul></section></section></section><section class="detached"><h2 id="871964087#containers-vs-vms-an-lise-detalhada" data-toc="containers-vs-vms-an-lise-detalhada#containers-101.md-containers-vs-vms-an-lise-detalhada">Containers vs VMs: An&aacute;lise Detalhada <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#compara-o-de-arquitetura" data-toc="compara-o-de-arquitetura#containers-101.md-compara-o-de-arquitetura">Compara&ccedil;&atilde;o de Arquitetura</h3><div class="detached code-block" id="871964087#-xkv88i_404"><pre><code class="language-none">Containers  VMs
               
 App1 App2 App3         App1 App2 App3 
               
     Container Engine             
                              OS   OS   OS  
     Host Kernel                 
        Hypervisor      
                               </code></pre></div></section><section class="detached"><h3 id="871964087#matriz-de-compara-o" data-toc="matriz-de-compara-o#containers-101.md-matriz-de-compara-o">Matriz de Compara&ccedil;&atilde;o</h3><div class="table-wrapper detached"><table id="871964087#-xkv88i_405"><tr class="header-row" id="871964087#-xkv88i_406"><th id="871964087#-xkv88i_414"><p>Aspecto</p></th><th id="871964087#-xkv88i_415"><p>Containers</p></th><th id="871964087#-xkv88i_416"><p>VMs</p></th></tr><tr class="" id="871964087#-xkv88i_407"><td id="871964087#-xkv88i_417"><p>Boot Time</p></td><td id="871964087#-xkv88i_418"><p>Segundos</p></td><td id="871964087#-xkv88i_419"><p>Minutos</p></td></tr><tr class="" id="871964087#-xkv88i_408"><td id="871964087#-xkv88i_420"><p>Tamanho</p></td><td id="871964087#-xkv88i_421"><p>MBs</p></td><td id="871964087#-xkv88i_422"><p>GBs</p></td></tr><tr class="" id="871964087#-xkv88i_409"><td id="871964087#-xkv88i_423"><p>Performance</p></td><td id="871964087#-xkv88i_424"><p>Pr&oacute;ximo ao bare metal</p></td><td id="871964087#-xkv88i_425"><p>Overhead significativo</p></td></tr><tr class="" id="871964087#-xkv88i_410"><td id="871964087#-xkv88i_426"><p>Isolamento</p></td><td id="871964087#-xkv88i_427"><p>Processo-level</p></td><td id="871964087#-xkv88i_428"><p>Hardware-level</p></td></tr><tr class="" id="871964087#-xkv88i_411"><td id="871964087#-xkv88i_429"><p>Portabilidade</p></td><td id="871964087#-xkv88i_430"><p>Muito alta</p></td><td id="871964087#-xkv88i_431"><p>Limitada</p></td></tr><tr class="" id="871964087#-xkv88i_412"><td id="871964087#-xkv88i_432"><p>Seguran&ccedil;a</p></td><td id="871964087#-xkv88i_433"><p>Compartilha kernel</p></td><td id="871964087#-xkv88i_434"><p>Totalmente isolada</p></td></tr><tr class="" id="871964087#-xkv88i_413"><td id="871964087#-xkv88i_435"><p>Densidade</p></td><td id="871964087#-xkv88i_436"><p>Alta (100s)</p></td><td id="871964087#-xkv88i_437"><p>Baixa (10s)</p></td></tr></table></div></section></section><section class="detached"><h2 id="871964087#use-cases-detalhados" data-toc="use-cases-detalhados#containers-101.md-use-cases-detalhados">Use Cases Detalhados <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#ideal-para-containers" data-toc="ideal-para-containers#containers-101.md-ideal-para-containers">Ideal para Containers</h3><ol class="list list-decimal" id="871964087#-xkv88i_440" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_446"><p id="871964087#-xkv88i_447"><span class="control" id="871964087#-xkv88i_448">Microservi&ccedil;os</span></p></li></ol><div class="detached code-block" id="871964087#-xkv88i_441"><pre><code class="language-none">
    Microservices Architecture          
          
 API  Auth Cart User Pay      
          
</code></pre></div><ol class="list list-decimal" id="871964087#-xkv88i_442" type="1" start="2"><li class="list-item" id="871964087#-xkv88i_449"><p id="871964087#-xkv88i_450"><span class="control" id="871964087#-xkv88i_451">CI/CD Pipelines</span></p></li></ol><div class="detached code-block" id="871964087#-xkv88i_443"><pre><code class="language-none">         
Build  Test    Stage  Deploy
         </code></pre></div><ol class="list list-decimal" id="871964087#-xkv88i_444" type="1" start="3"><li class="list-item" id="871964087#-xkv88i_452"><p id="871964087#-xkv88i_453"><span class="control" id="871964087#-xkv88i_454">Desenvolvimento Local</span></p></li></ol><div class="detached code-block" id="871964087#-xkv88i_445"><pre><code class="language-none">
  Dev Environment   
   
 App  Database 
   
</code></pre></div></section><section class="detached"><h3 id="871964087#ideal-para-vms" data-toc="ideal-para-vms#containers-101.md-ideal-para-vms">Ideal para VMs</h3><ol class="list list-decimal" id="871964087#-xkv88i_455" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_459"><p id="871964087#-xkv88i_460"><span class="control" id="871964087#-xkv88i_461">Legacy Applications</span></p></li></ol><div class="detached code-block" id="871964087#-xkv88i_456"><pre><code class="language-none">
    Monolithic App      
    
   Full Stack App     
   + Dependencies     
   + Full OS         
    
</code></pre></div><ol class="list list-decimal" id="871964087#-xkv88i_457" type="1" start="2"><li class="list-item" id="871964087#-xkv88i_462"><p id="871964087#-xkv88i_463"><span class="control" id="871964087#-xkv88i_464">Isolamento Completo</span></p></li></ol><div class="detached code-block" id="871964087#-xkv88i_458"><pre><code class="language-none">
   Secure VM        
   
  Encrypted       
  Environment     
   
</code></pre></div></section></section><section class="detached"><h2 id="871964087#padr-es-de-deployment" data-toc="padr-es-de-deployment#containers-101.md-padr-es-de-deployment">Padr&otilde;es de Deployment <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#blue-green-deployment" data-toc="blue-green-deployment#containers-101.md-blue-green-deployment">Blue-Green Deployment</h3><div class="detached code-block" id="871964087#-xkv88i_467"><pre><code class="language-none">Blue   Green
  Version 1.0           Version 1.1      
             
   Container           Container     
             
   
                                  
    
               Load Balancer              
    
                                         
                                      Traffic</code></pre></div></section><section class="detached"><h3 id="871964087#rolling-updates" data-toc="rolling-updates#containers-101.md-rolling-updates">Rolling Updates</h3><div class="detached code-block" id="871964087#-xkv88i_468"><pre><code class="language-none">
    V1        V1        V2        V2 

    V1        V2        V2        V2 

     Time </code></pre></div></section></section><section class="detached"><h2 id="871964087#estrat-gias-de-persist-ncia" data-toc="estrat-gias-de-persist-ncia#containers-101.md-estrat-gias-de-persist-ncia">Estrat&eacute;gias de Persist&ecirc;ncia <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#volume-types" data-toc="volume-types#containers-101.md-volume-types">Volume Types</h3><div class="detached code-block" id="871964087#-xkv88i_470"><pre><code class="language-none">
    Container       
    
    Application   
    
                   
    
     Volume      Host Storage
    
</code></pre></div><ol class="list list-decimal" id="871964087#-xkv88i_471" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_477"><p id="871964087#-xkv88i_478"><span class="control" id="871964087#-xkv88i_479">Named Volumes</span></p></li></ol><div class="detached code-block" id="871964087#-xkv88i_472"><pre><code class="language-bash">docker volume create mydata
docker run -v mydata:/data nginx</code></pre></div><ol class="list list-decimal" id="871964087#-xkv88i_473" type="1" start="2"><li class="list-item" id="871964087#-xkv88i_480"><p id="871964087#-xkv88i_481"><span class="control" id="871964087#-xkv88i_482">Bind Mounts</span></p></li></ol><div class="detached code-block" id="871964087#-xkv88i_474"><pre><code class="language-bash">docker run -v /host/path:/container/path nginx</code></pre></div><ol class="list list-decimal" id="871964087#-xkv88i_475" type="1" start="3"><li class="list-item" id="871964087#-xkv88i_483"><p id="871964087#-xkv88i_484"><span class="control" id="871964087#-xkv88i_485">tmpfs Mounts</span></p></li></ol><div class="detached code-block" id="871964087#-xkv88i_476"><pre><code class="language-bash">docker run --tmpfs /tmp nginx</code></pre></div></section></section><section class="detached"><h2 id="871964087#networking-avan-ado" data-toc="networking-avan-ado#containers-101.md-networking-avan-ado">Networking Avan&ccedil;ado <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#network-types" data-toc="network-types#containers-101.md-network-types">Network Types</h3><div class="detached code-block" id="871964087#-xkv88i_488"><pre><code class="language-none">
    Container A     
     172.17.0.2    

           

  Docker Network    
    172.17.0.0/16  

           

    Container B     
     172.17.0.3    
</code></pre></div></section><section class="detached"><h3 id="871964087#network-modes" data-toc="network-modes#containers-101.md-network-modes">Network Modes</h3><ol class="list list-decimal" id="871964087#-xkv88i_489" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_490"><p id="871964087#-xkv88i_493"><span class="control" id="871964087#-xkv88i_495">Bridge Network</span></p><ul class="list" id="871964087#-xkv88i_494" start="1"><li class="list-item" id="871964087#-xkv88i_496"><p id="871964087#-xkv88i_499">Default network driver</p></li><li class="list-item" id="871964087#-xkv88i_497"><p id="871964087#-xkv88i_500">Isolated network</p></li><li class="list-item" id="871964087#-xkv88i_498"><p id="871964087#-xkv88i_501">Port mapping</p></li></ul></li><li class="list-item" id="871964087#-xkv88i_491"><p id="871964087#-xkv88i_502"><span class="control" id="871964087#-xkv88i_504">Host Network</span></p><ul class="list" id="871964087#-xkv88i_503" start="1"><li class="list-item" id="871964087#-xkv88i_505"><p id="871964087#-xkv88i_508">Uses host networking</p></li><li class="list-item" id="871964087#-xkv88i_506"><p id="871964087#-xkv88i_509">Better performance</p></li><li class="list-item" id="871964087#-xkv88i_507"><p id="871964087#-xkv88i_510">Less isolation</p></li></ul></li><li class="list-item" id="871964087#-xkv88i_492"><p id="871964087#-xkv88i_511"><span class="control" id="871964087#-xkv88i_513">Overlay Network</span></p><ul class="list" id="871964087#-xkv88i_512" start="1"><li class="list-item" id="871964087#-xkv88i_514"><p id="871964087#-xkv88i_517">Multi-host networking</p></li><li class="list-item" id="871964087#-xkv88i_515"><p id="871964087#-xkv88i_518">Swarm mode</p></li><li class="list-item" id="871964087#-xkv88i_516"><p id="871964087#-xkv88i_519">Service discovery</p></li></ul></li></ol></section></section><section class="detached"><h2 id="871964087#monitoramento-e-logging" data-toc="monitoramento-e-logging#containers-101.md-monitoramento-e-logging">Monitoramento e Logging <span class="no-bold"></span></h2><section class="detached"><h3 id="871964087#monitoring-stack" data-toc="monitoring-stack#containers-101.md-monitoring-stack">Monitoring Stack</h3><div class="detached code-block" id="871964087#-xkv88i_522"><pre><code class="language-none">    
   Container           Prometheus   
         Metrics DB    
   App                           
   +Metrics      
          Grafana    
        
                      </code></pre></div></section><section class="detached"><h3 id="871964087#logging-patterns" data-toc="logging-patterns#containers-101.md-logging-patterns">Logging Patterns</h3><ol class="list list-decimal" id="871964087#-xkv88i_523" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_527"><p id="871964087#-xkv88i_528"><span class="control" id="871964087#-xkv88i_529">Stdout/Stderr</span></p></li></ol><div class="detached code-block" id="871964087#-xkv88i_524"><pre><code class="language-bash">docker logs container_id</code></pre></div><ol class="list list-decimal" id="871964087#-xkv88i_525" type="1" start="2"><li class="list-item" id="871964087#-xkv88i_530"><p id="871964087#-xkv88i_531"><span class="control" id="871964087#-xkv88i_532">Sidecar Logger</span></p></li></ol><div class="detached code-block" id="871964087#-xkv88i_526"><pre><code class="language-yaml">services:
  app:
    image: myapp
  logger:
    image: fluentd
    volumes:
      - /var/log:/logs</code></pre></div></section></section><section class="detached"><h2 id="871964087#waifu-tips_1" data-toc="waifu-tips_1#containers-101.md-waifu-tips_1">Waifu Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="871964087#-xkv88i_535"><span class="control" id="871964087#-xkv88i_536">State-chan diz:</span> &quot;Stateless &eacute; como um caf&eacute; instant&acirc;neo - r&aacute;pido, pr&aacute;tico e sempre igual. Stateful &eacute; como um caf&eacute; gourmet - precisa de mais cuidado, mas vale a pena!&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="871964087#-xkv88i_537"><span class="control" id="871964087#-xkv88i_538">VM-sama avisa:</span> &quot;VMs s&atilde;o como apartamentos completos, containers s&atilde;o como quartos de hotel - escolha baseado no que precisa!&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="871964087#pr-ximos-passos_1" data-toc="pr-ximos-passos_1#containers-101.md-pr-ximos-passos_1">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="871964087#-xkv88i_539" type="1" start="1"><li class="list-item" id="871964087#-xkv88i_542"><p id="871964087#-xkv88i_547">Explore Docker Hub</p></li><li class="list-item" id="871964087#-xkv88i_543"><p id="871964087#-xkv88i_548">Crie seus pr&oacute;prios containers</p></li><li class="list-item" id="871964087#-xkv88i_544"><p id="871964087#-xkv88i_549">Aprenda sobre networking</p></li><li class="list-item" id="871964087#-xkv88i_545"><p id="871964087#-xkv88i_550">Estude volumes</p></li><li class="list-item" id="871964087#-xkv88i_546"><p id="871964087#-xkv88i_551">Pratique com projetos reais</p></li></ol><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="871964087#-xkv88i_552">&quot;No mundo dos containers, n&atilde;o existe 'funciona na minha m&aacute;quina' - porque sua m&aacute;quina est&aacute; no container!&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="896684810">Container Internals: Como Funciona Por Dentro <span class="no-bold"></span></h1><div class="detached code-block" id="896684810#z4rrrmj_3"><pre><code class="language-none">
  CONTAINER INTERNALS MATRIX                                           
                                                                       
  [ Namespaces + Cgroups + UnionFS = Container ]                      
                                                                       
  &quot;Isolamento, Controle e Eficincia&quot;                                 
                                                                       
</code></pre></div><section class="detached"><h2 id="896684810#linux-namespaces" data-toc="linux-namespaces#container-internals.md-linux-namespaces">Linux Namespaces <span class="no-bold"></span></h2><section class="detached"><h3 id="896684810#tipos-de-namespaces-detalhados" data-toc="tipos-de-namespaces-detalhados#container-internals.md-tipos-de-namespaces-detalhados">Tipos de Namespaces Detalhados</h3><section class="detached"><h4 id="896684810#1-pid-namespace" data-toc="1-pid-namespace#container-internals.md-1-pid-namespace">1. PID Namespace</h4><div class="detached code-block" id="896684810#z4rrrmj_19"><pre><code class="language-none">
 Host PID Namespace      
  pid: 1234             
    
  Container PID NS    
    pid: 1           
    
</code></pre></div><ul class="list" id="896684810#z4rrrmj_20" start="1"><li class="list-item" id="896684810#z4rrrmj_21"><p id="896684810#z4rrrmj_25">Isolamento de processos</p></li><li class="list-item" id="896684810#z4rrrmj_22"><p id="896684810#z4rrrmj_26">Hierarquia pr&oacute;pria</p></li><li class="list-item" id="896684810#z4rrrmj_23"><p id="896684810#z4rrrmj_27">PID 1 como init</p></li><li class="list-item" id="896684810#z4rrrmj_24"><p id="896684810#z4rrrmj_28">Nested namespaces</p></li></ul></section><section class="detached"><h4 id="896684810#2-network-namespace" data-toc="2-network-namespace#container-internals.md-2-network-namespace">2. Network Namespace</h4><div class="detached code-block" id="896684810#z4rrrmj_29"><pre><code class="language-none">
 Host Network               
 eth0: 192.168.1.10        
    
  Container Net NS        
   eth0: 172.17.0.2      
   lo: 127.0.0.1         
    
</code></pre></div><ul class="list" id="896684810#z4rrrmj_30" start="1"><li class="list-item" id="896684810#z4rrrmj_31"><p id="896684810#z4rrrmj_35">Interface virtual</p></li><li class="list-item" id="896684810#z4rrrmj_32"><p id="896684810#z4rrrmj_36">Routing tables pr&oacute;prias</p></li><li class="list-item" id="896684810#z4rrrmj_33"><p id="896684810#z4rrrmj_37">Firewall rules</p></li><li class="list-item" id="896684810#z4rrrmj_34"><p id="896684810#z4rrrmj_38">Socket isolation</p></li></ul></section><section class="detached"><h4 id="896684810#3-mount-namespace" data-toc="3-mount-namespace#container-internals.md-3-mount-namespace">3. Mount Namespace</h4><div class="detached code-block" id="896684810#z4rrrmj_39"><pre><code class="language-none">
 Host Mount NS          
  /                     
   bin              
   etc              
   container_root    
       [Container]  
</code></pre></div><ul class="list" id="896684810#z4rrrmj_40" start="1"><li class="list-item" id="896684810#z4rrrmj_41"><p id="896684810#z4rrrmj_45">Filesystem isolation</p></li><li class="list-item" id="896684810#z4rrrmj_42"><p id="896684810#z4rrrmj_46">Bind mounts</p></li><li class="list-item" id="896684810#z4rrrmj_43"><p id="896684810#z4rrrmj_47">Pivoting root</p></li><li class="list-item" id="896684810#z4rrrmj_44"><p id="896684810#z4rrrmj_48">Mount propagation</p></li></ul></section></section></section><section class="detached"><h2 id="896684810#control-groups-cgroups-v2" data-toc="control-groups-cgroups-v2#container-internals.md-control-groups-cgroups-v2">Control Groups (cgroups) v2 <span class="no-bold"></span></h2><section class="detached"><h3 id="896684810#hierarquia-unificada" data-toc="hierarquia-unificada#container-internals.md-hierarquia-unificada">Hierarquia Unificada</h3><div class="detached code-block" id="896684810#z4rrrmj_51"><pre><code class="language-none">
 /sys/fs/cgroup/                 

  container.slice            
     memory.max            
     cpu.max               
     io.max                
  system.slice              
</code></pre></div></section><section class="detached"><h3 id="896684810#controllers-detalhados" data-toc="controllers-detalhados#container-internals.md-controllers-detalhados">Controllers Detalhados</h3><section class="detached"><h4 id="896684810#cpu-controller" data-toc="cpu-controller#container-internals.md-cpu-controller">CPU Controller</h4><div class="detached code-block" id="896684810#z4rrrmj_55"><pre><code class="language-bash"># Limitar CPU para 50%
echo &quot;50000 100000&quot; &gt; cpu.max

# Definir peso CPU
echo &quot;100&quot; &gt; cpu.weight</code></pre></div></section><section class="detached"><h4 id="896684810#memory-controller" data-toc="memory-controller#container-internals.md-memory-controller">Memory Controller</h4><div class="detached code-block" id="896684810#z4rrrmj_56"><pre><code class="language-bash"># Limite de memria
echo &quot;256M&quot; &gt; memory.max

# Soft limit
echo &quot;200M&quot; &gt; memory.high</code></pre></div></section><section class="detached"><h4 id="896684810#i-o-controller" data-toc="i-o-controller#container-internals.md-i-o-controller">I/O Controller</h4><div class="detached code-block" id="896684810#z4rrrmj_57"><pre><code class="language-bash"># Limite de I/O
echo &quot;10485760&quot; &gt; io.max

# Peso I/O
echo &quot;100&quot; &gt; io.weight</code></pre></div></section></section></section><section class="detached"><h2 id="896684810#union-file-system-deep-dive" data-toc="union-file-system-deep-dive#container-internals.md-union-file-system-deep-dive">Union File System Deep Dive <span class="no-bold"></span></h2><section class="detached"><h3 id="896684810#overlay2-internals" data-toc="overlay2-internals#container-internals.md-overlay2-internals">Overlay2 Internals</h3><div class="detached code-block" id="896684810#z4rrrmj_61"><pre><code class="language-none">
 Container Layer (Upper)    

 Container Write Layer      

 Image Layer N (Lower)      

 Image Layer 2 (Lower)      

 Base Layer (Lower)         
</code></pre></div></section><section class="detached"><h3 id="896684810#layer-operations" data-toc="layer-operations#container-internals.md-layer-operations">Layer Operations</h3><div class="detached code-block" id="896684810#z4rrrmj_62"><pre><code class="language-none">
 Write Operation        
    
  Copy-Up             
  Modify Upper        
    
</code></pre></div></section><section class="detached"><h3 id="896684810#directory-structure" data-toc="directory-structure#container-internals.md-directory-structure">Directory Structure</h3><div class="detached code-block" id="896684810#z4rrrmj_63"><pre><code class="language-bash">/var/lib/docker/overlay2/
 l/                  # Layer shortcuts
 [layer-id]/         # Layer content
    diff/          # Layer fs content
    work/          # Overlay work dir
    merged/        # Mount point
    lower          # Lower layer refs</code></pre></div></section></section><section class="detached"><h2 id="896684810#container-runtime-spec" data-toc="container-runtime-spec#container-internals.md-container-runtime-spec">Container Runtime Spec <span class="no-bold"></span></h2><section class="detached"><h3 id="896684810#oci-runtime-specification" data-toc="oci-runtime-specification#container-internals.md-oci-runtime-specification">OCI Runtime Specification</h3><div class="detached code-block" id="896684810#z4rrrmj_66"><pre><code class="language-none">
 runtime-spec               

  config.json          
  rootfs/              
  state.json          
</code></pre></div></section><section class="detached"><h3 id="896684810#container-lifecycle-states" data-toc="container-lifecycle-states#container-internals.md-container-lifecycle-states">Container Lifecycle States</h3><div class="detached code-block" id="896684810#z4rrrmj_67"><pre><code class="language-none">     
 creating    created  
     
                      
                      
     
 stopped     running  
     </code></pre></div></section></section><section class="detached"><h2 id="896684810#security-internals" data-toc="security-internals#container-internals.md-security-internals">Security Internals <span class="no-bold"></span></h2><section class="detached"><h3 id="896684810#linux-capabilities" data-toc="linux-capabilities#container-internals.md-linux-capabilities">Linux Capabilities</h3><div class="detached code-block" id="896684810#z4rrrmj_71"><pre><code class="language-none">
 Default Container Capabilities 

 CHOWN           SETUID       
 DAC_OVERRIDE    SETGID       
 FOWNER          NET_BIND     
 MKNOD           SYS_CHROOT   
</code></pre></div></section><section class="detached"><h3 id="896684810#seccomp-profiles" data-toc="seccomp-profiles#container-internals.md-seccomp-profiles">Seccomp Profiles</h3><div class="detached code-block" id="896684810#z4rrrmj_72"><pre><code class="language-json">{
  &quot;defaultAction&quot;: &quot;SCMP_ACT_ERRNO&quot;,
  &quot;architectures&quot;: [&quot;SCMP_ARCH_X86_64&quot;],
  &quot;syscalls&quot;: [
    {
      &quot;names&quot;: [&quot;read&quot;, &quot;write&quot;],
      &quot;action&quot;: &quot;SCMP_ACT_ALLOW&quot;
    }
  ]
}</code></pre></div></section><section class="detached"><h3 id="896684810#apparmor-profiles" data-toc="apparmor-profiles#container-internals.md-apparmor-profiles">AppArmor Profiles</h3><div class="detached code-block" id="896684810#z4rrrmj_73"><pre><code class="language-none">
 Docker Default Profile     

 file,                     
 network,                  
 capability,               
 mount                     
</code></pre></div></section></section><section class="detached"><h2 id="896684810#advanced-networking" data-toc="advanced-networking#container-internals.md-advanced-networking">Advanced Networking <span class="no-bold"></span></h2><section class="detached"><h3 id="896684810#cni-container-network-interface" data-toc="cni-container-network-interface#container-internals.md-cni-container-network-interface">CNI (Container Network Interface)</h3><div class="detached code-block" id="896684810#z4rrrmj_76"><pre><code class="language-none">
 CNI Architecture          

   
  Plugin     IPAM      
   
</code></pre></div></section><section class="detached"><h3 id="896684810#network-drivers" data-toc="network-drivers#container-internals.md-network-drivers">Network Drivers</h3><div class="detached code-block" id="896684810#z4rrrmj_77"><pre><code class="language-none">
 Network Driver Types       

 bridge                    
 host                      
 overlay                   
 macvlan                   
 none                      
</code></pre></div></section></section><section class="detached"><h2 id="896684810#storage-deep-dive" data-toc="storage-deep-dive#container-internals.md-storage-deep-dive">Storage Deep Dive <span class="no-bold"></span></h2><section class="detached"><h3 id="896684810#storage-driver-operations" data-toc="storage-driver-operations#container-internals.md-storage-driver-operations">Storage Driver Operations</h3><div class="detached code-block" id="896684810#z4rrrmj_80"><pre><code class="language-none">
 Storage Driver Stack       

 Container Layer           
 Image Layers              
 Storage Driver           
 Block Device             
</code></pre></div></section><section class="detached"><h3 id="896684810#volume-types" data-toc="volume-types#container-internals.md-volume-types">Volume Types</h3><div class="detached code-block" id="896684810#z4rrrmj_81"><pre><code class="language-none">
 Volume Types               

 Named Volumes             
 Bind Mounts               
 tmpfs Mounts             
</code></pre></div></section></section><section class="detached"><h2 id="896684810#advanced-debugging" data-toc="advanced-debugging#container-internals.md-advanced-debugging">Advanced Debugging <span class="no-bold"></span></h2><section class="detached"><h3 id="896684810#trace-commands" data-toc="trace-commands#container-internals.md-trace-commands">Trace Commands</h3><div class="detached code-block" id="896684810#z4rrrmj_84"><pre><code class="language-bash"># Syscall tracing
strace -p $PID

# Network tracing
tcpdump -i any container_port

# Block I/O tracing
blktrace -d /dev/sda -o trace</code></pre></div></section><section class="detached"><h3 id="896684810#profiling" data-toc="profiling#container-internals.md-profiling">Profiling</h3><div class="detached code-block" id="896684810#z4rrrmj_85"><pre><code class="language-bash"># CPU profiling
perf record -p $PID

# Memory profiling
heaptrack $PID</code></pre></div></section></section><section class="detached"><h2 id="896684810#performance-tuning" data-toc="performance-tuning#container-internals.md-performance-tuning">Performance Tuning <span class="no-bold"></span></h2><section class="detached"><h3 id="896684810#resource-optimization" data-toc="resource-optimization#container-internals.md-resource-optimization">Resource Optimization</h3><div class="detached code-block" id="896684810#z4rrrmj_88"><pre><code class="language-none">
 Performance Factors        

 CPU Scheduling            
 Memory Management         
 I/O Throughput           
 Network Latency          
</code></pre></div></section><section class="detached"><h3 id="896684810#monitoring-metrics" data-toc="monitoring-metrics#container-internals.md-monitoring-metrics">Monitoring Metrics</h3><div class="detached code-block" id="896684810#z4rrrmj_89"><pre><code class="language-bash"># CPU stats
docker stats --format &quot;table {{.Container}}\t{{.CPUPerc}}&quot;

# Memory usage
docker stats --format &quot;table {{.Container}}\t{{.MemUsage}}&quot;</code></pre></div></section></section><section class="detached"><h2 id="896684810#waifu-tips" data-toc="waifu-tips#container-internals.md-waifu-tips">Waifu Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="896684810#z4rrrmj_93"><span class="control" id="896684810#z4rrrmj_94">Runtime-chan diz:</span> &quot;OCI &eacute; como um contrato m&aacute;gico que garante que todos os containers falem a mesma l&iacute;ngua!&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="896684810#z4rrrmj_95"><span class="control" id="896684810#z4rrrmj_96">Security-sama avisa:</span> &quot;Capabilities s&atilde;o como superpoderes - use com responsabilidade!&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="896684810#z4rrrmj_97"><span class="control" id="896684810#z4rrrmj_98">Network-chan lembra:</span> &quot;CNI &eacute; como um protocolo de comunica&ccedil;&atilde;o entre dimens&otilde;es paralelas!&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="896684810#refer-ncias-t-cnicas" data-toc="refer-ncias-t-cnicas#container-internals.md-refer-ncias-t-cnicas">Refer&ecirc;ncias T&eacute;cnicas <span class="no-bold"></span></h2><section class="detached"><h3 id="896684810#documenta-o-oficial" data-toc="documenta-o-oficial#container-internals.md-documenta-o-oficial">Documenta&ccedil;&atilde;o Oficial</h3><ul class="list" id="896684810#z4rrrmj_102" start="1"><li class="list-item" id="896684810#z4rrrmj_103"><p id="896684810#z4rrrmj_107">OCI Runtime Specification</p></li><li class="list-item" id="896684810#z4rrrmj_104"><p id="896684810#z4rrrmj_108">Linux Kernel Documentation</p></li><li class="list-item" id="896684810#z4rrrmj_105"><p id="896684810#z4rrrmj_109">Docker Engine Internals</p></li><li class="list-item" id="896684810#z4rrrmj_106"><p id="896684810#z4rrrmj_110">Container Security Guide</p></li></ul></section><section class="detached"><h3 id="896684810#ferramentas-teis" data-toc="ferramentas-teis#container-internals.md-ferramentas-teis">Ferramentas &Uacute;teis</h3><ul class="list" id="896684810#z4rrrmj_111" start="1"><li class="list-item" id="896684810#z4rrrmj_112"><p id="896684810#z4rrrmj_117">nsenter</p></li><li class="list-item" id="896684810#z4rrrmj_113"><p id="896684810#z4rrrmj_118">unshare</p></li><li class="list-item" id="896684810#z4rrrmj_114"><p id="896684810#z4rrrmj_119">runc</p></li><li class="list-item" id="896684810#z4rrrmj_115"><p id="896684810#z4rrrmj_120">ctr</p></li><li class="list-item" id="896684810#z4rrrmj_116"><p id="896684810#z4rrrmj_121">nerdctl</p></li></ul></section><section class="detached"><h3 id="896684810#debugging-tools" data-toc="debugging-tools#container-internals.md-debugging-tools">Debugging Tools</h3><ul class="list" id="896684810#z4rrrmj_122" start="1"><li class="list-item" id="896684810#z4rrrmj_123"><p id="896684810#z4rrrmj_127">strace</p></li><li class="list-item" id="896684810#z4rrrmj_124"><p id="896684810#z4rrrmj_128">tcpdump</p></li><li class="list-item" id="896684810#z4rrrmj_125"><p id="896684810#z4rrrmj_129">perf</p></li><li class="list-item" id="896684810#z4rrrmj_126"><p id="896684810#z4rrrmj_130">heaptrack</p></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="2096623244">Container Runtime: O Motor dos Containers <span class="no-bold"></span></h1><div class="detached code-block" id="2096623244#lh20nt_3"><pre><code class="language-none">
  CONTAINER RUNTIME MATRIX                                             
                                                                       
  [ OCI Runtime + Container Engine + Shim = Container Execution ]      
                                                                       
  &quot;O maestro que orquestra a execuo dos containers&quot;                 
                                                                       
</code></pre></div><section class="detached"><h2 id="2096623244#arquitetura-do-container-runtime" data-toc="arquitetura-do-container-runtime#container-runtime.md-arquitetura-do-container-runtime">Arquitetura do Container Runtime <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#camadas-de-runtime" data-toc="camadas-de-runtime#container-runtime.md-camadas-de-runtime">Camadas de Runtime</h3><div class="detached code-block" id="2096623244#lh20nt_22"><pre><code class="language-none">
 High-Level Runtime (Docker)     

 Container Engine (containerd)   

 Container Runtime (runc)        

 Linux Kernel                    
</code></pre></div></section><section class="detached"><h3 id="2096623244#componentes-do-kernel" data-toc="componentes-do-kernel#container-runtime.md-componentes-do-kernel">Componentes do Kernel</h3><ol class="list list-decimal" id="2096623244#lh20nt_23" type="1" start="1"><li class="list-item" id="2096623244#lh20nt_24"><p id="2096623244#lh20nt_27"><span class="control" id="2096623244#lh20nt_29">Namespaces</span></p><div class="detached code-block" id="2096623244#lh20nt_28"><pre><code class="language-bash"># Listar namespaces
lsns

# Criar novo namespace
unshare --mount --uts --ipc --net --pid --fork --user /bin/bash</code></pre></div></li><li class="list-item" id="2096623244#lh20nt_25"><p id="2096623244#lh20nt_30"><span class="control" id="2096623244#lh20nt_32">Cgroups v2</span></p><div class="detached code-block" id="2096623244#lh20nt_31"><pre><code class="language-bash"># Criar cgroup
mkdir /sys/fs/cgroup/container1

# Configurar limites
echo &quot;100000&quot; &gt; /sys/fs/cgroup/container1/cpu.max
echo &quot;256M&quot; &gt; /sys/fs/cgroup/container1/memory.max</code></pre></div></li><li class="list-item" id="2096623244#lh20nt_26"><p id="2096623244#lh20nt_33"><span class="control" id="2096623244#lh20nt_35">Capabilities</span></p><div class="detached code-block" id="2096623244#lh20nt_34"><pre><code class="language-bash"># Listar capabilities
capsh --print

# Dropar capabilities
capsh --drop=cap_sys_admin --</code></pre></div></li></ol></section></section><section class="detached"><h2 id="2096623244#oci-open-container-initiative" data-toc="oci-open-container-initiative#container-runtime.md-oci-open-container-initiative">OCI (Open Container Initiative) <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#runtime-specification-detalhada" data-toc="runtime-specification-detalhada#container-runtime.md-runtime-specification-detalhada">Runtime Specification Detalhada</h3><div class="detached code-block" id="2096623244#lh20nt_38"><pre><code class="language-json">{
  &quot;ociVersion&quot;: &quot;1.0.2&quot;,
  &quot;root&quot;: {
    &quot;path&quot;: &quot;rootfs&quot;,
    &quot;readonly&quot;: true
  },
  &quot;process&quot;: {
    &quot;terminal&quot;: true,
    &quot;user&quot;: {
      &quot;uid&quot;: 0,
      &quot;gid&quot;: 0
    },
    &quot;args&quot;: [
      &quot;sh&quot;
    ],
    &quot;env&quot;: [
      &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;,
      &quot;TERM=xterm&quot;
    ],
    &quot;cwd&quot;: &quot;/&quot;,
    &quot;capabilities&quot;: {
      &quot;bounding&quot;: [
        &quot;CAP_AUDIT_WRITE&quot;,
        &quot;CAP_KILL&quot;,
        &quot;CAP_NET_BIND_SERVICE&quot;
      ]
    }
  },
  &quot;mounts&quot;: [
    {
      &quot;destination&quot;: &quot;/proc&quot;,
      &quot;type&quot;: &quot;proc&quot;,
      &quot;source&quot;: &quot;proc&quot;
    }
  ]
}</code></pre></div></section><section class="detached"><h3 id="2096623244#image-manifest-detalhado" data-toc="image-manifest-detalhado#container-runtime.md-image-manifest-detalhado">Image Manifest Detalhado</h3><div class="detached code-block" id="2096623244#lh20nt_39"><pre><code class="language-json">{
  &quot;schemaVersion&quot;: 2,
  &quot;mediaType&quot;: &quot;application/vnd.docker.distribution.manifest.v2+json&quot;,
  &quot;config&quot;: {
    &quot;mediaType&quot;: &quot;application/vnd.docker.container.image.v1+json&quot;,
    &quot;size&quot;: 7023,
    &quot;digest&quot;: &quot;sha256:b5b2b2c507a0944348e0303114d8d93aaaa081732b86451d9bce1f432a537bc7&quot;
  },
  &quot;layers&quot;: [
    {
      &quot;mediaType&quot;: &quot;application/vnd.docker.image.rootfs.diff.tar.gzip&quot;,
      &quot;size&quot;: 32654,
      &quot;digest&quot;: &quot;sha256:e692418e4cbaf90ca69d05a66403747baa33ee08806650b51fab815ad7fc331f&quot;
    }
  ]
}</code></pre></div></section></section><section class="detached"><h2 id="2096623244#container-engine-containerd" data-toc="container-engine-containerd#container-runtime.md-container-engine-containerd">Container Engine: containerd <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#arquitetura-detalhada" data-toc="arquitetura-detalhada#container-runtime.md-arquitetura-detalhada">Arquitetura Detalhada</h3><div class="detached code-block" id="2096623244#lh20nt_43"><pre><code class="language-none">
 containerd                                  

     
  Image Store   Metadata   Snapshots  
     
     
    Events       Tasks     Plugins    
     
</code></pre></div></section><section class="detached"><h3 id="2096623244#api-grpc" data-toc="api-grpc#container-runtime.md-api-grpc">API gRPC</h3><div class="detached code-block" id="2096623244#lh20nt_44"><pre><code class="language-protobuf">service Containers {
  rpc Create(CreateContainerRequest) returns (CreateContainerResponse);
  rpc Get(GetContainerRequest) returns (GetContainerResponse);
  rpc List(ListContainersRequest) returns (ListContainersResponse);
  rpc Delete(DeleteContainerRequest) returns (DeleteContainerResponse);
  rpc Update(UpdateContainerRequest) returns (UpdateContainerResponse);
}</code></pre></div></section><section class="detached"><h3 id="2096623244#plugins-avan-ados" data-toc="plugins-avan-ados#container-runtime.md-plugins-avan-ados">Plugins Avan&ccedil;ados</h3><div class="detached code-block" id="2096623244#lh20nt_45"><pre><code class="language-none">
 Plugin Architecture       

  Snapshotter        
  Content Store      
  Diff Service      
  Metadata Store    
</code></pre></div></section></section><section class="detached"><h2 id="2096623244#low-level-runtime-runc" data-toc="low-level-runtime-runc#container-runtime.md-low-level-runtime-runc">Low-Level Runtime: runc <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#internals-do-runc" data-toc="internals-do-runc#container-runtime.md-internals-do-runc">Internals do runc</h3><div class="detached code-block" id="2096623244#lh20nt_48"><pre><code class="language-c">// libcontainer/configs/config.go
type Config struct {
    Rootfs     string   `json:&quot;rootfs&quot;`
    ReadonlyFs bool     `json:&quot;readonly&quot;`
    Namespaces []Namespace `json:&quot;namespaces&quot;`
    Cgroups    *Cgroup    `json:&quot;cgroups&quot;`
    Devices    []*Device  `json:&quot;devices&quot;`
    Mounts     []*Mount   `json:&quot;mounts&quot;`
    Hooks      Hooks      `json:&quot;hooks&quot;`
}</code></pre></div></section><section class="detached"><h3 id="2096623244#hooks-do-lifecycle" data-toc="hooks-do-lifecycle#container-runtime.md-hooks-do-lifecycle">Hooks do Lifecycle</h3><div class="detached code-block" id="2096623244#lh20nt_49"><pre><code class="language-json">{
  &quot;prestart&quot;: [
    {
      &quot;path&quot;: &quot;/usr/bin/fix-mounts&quot;,
      &quot;args&quot;: [&quot;fix-mounts&quot;, &quot;arg1&quot;],
      &quot;env&quot;: [ &quot;key1=value1&quot; ]
    }
  ],
  &quot;poststart&quot;: [
    {
      &quot;path&quot;: &quot;/usr/bin/notify-start&quot;,
      &quot;timeout&quot;: 5
    }
  ],
  &quot;poststop&quot;: [
    {
      &quot;path&quot;: &quot;/usr/bin/cleanup&quot;,
      &quot;args&quot;: [&quot;cleanup&quot;, &quot;arg1&quot;]
    }
  ]
}</code></pre></div></section></section><section class="detached"><h2 id="2096623244#container-shim-v2" data-toc="container-shim-v2#container-runtime.md-container-shim-v2">Container Shim v2</h2><section class="detached"><h3 id="2096623244#arquitetura-do-shim" data-toc="arquitetura-do-shim#container-runtime.md-arquitetura-do-shim">Arquitetura do Shim</h3><div class="detached code-block" id="2096623244#lh20nt_52"><pre><code class="language-none">
 containerd                         

 shim.v2.Task                      
  Start()                      
  Delete()                     
  Exec()                       
  ResizePty()                 
  State()                      
  Kill()                       
</code></pre></div></section><section class="detached"><h3 id="2096623244#implementa-o-do-shim" data-toc="implementa-o-do-shim#container-runtime.md-implementa-o-do-shim">Implementa&ccedil;&atilde;o do Shim</h3><div class="detached code-block" id="2096623244#lh20nt_53"><pre><code class="language-go">type Shim interface {
    StartShim(ctx context.Context, id string, opts ShimOpts) (string, error)
    Cleanup(ctx context.Context) (*Exit, error)
    Connect(ctx context.Context, onClose func()) error
}</code></pre></div></section></section><section class="detached"><h2 id="2096623244#runtime-alternatives-detalhadas" data-toc="runtime-alternatives-detalhadas#container-runtime.md-runtime-alternatives-detalhadas">Runtime Alternatives Detalhadas <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#gvisor-internals" data-toc="gvisor-internals#container-runtime.md-gvisor-internals">gVisor Internals</h3><div class="detached code-block" id="2096623244#lh20nt_56"><pre><code class="language-none">
 Application               

 Sentry (User Space)       

 Gofer (File Access)       

 Platform (KVM/ptrace)     
</code></pre></div></section><section class="detached"><h3 id="2096623244#kata-containers-architecture" data-toc="kata-containers-architecture#container-runtime.md-kata-containers-architecture">Kata Containers Architecture</h3><div class="detached code-block" id="2096623244#lh20nt_57"><pre><code class="language-none">
 Container                 

 Kata Runtime             

 Lightweight VM           

 Hypervisor              
</code></pre></div></section></section><section class="detached"><h2 id="2096623244#advanced-security-features" data-toc="advanced-security-features#container-runtime.md-advanced-security-features">Advanced Security Features <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#selinux-policies" data-toc="selinux-policies#container-runtime.md-selinux-policies">SELinux Policies</h3><div class="detached code-block" id="2096623244#lh20nt_60"><pre><code class="language-bash"># Poltica para container
cat &gt; container.te &lt;&lt;EOF
policy_module(container, 1.0)
require {
    type container_t;
    type container_file_t;
    class file { read write };
}
allow container_t container_file_t:file { read write };
EOF</code></pre></div></section><section class="detached"><h3 id="2096623244#apparmor-profile-detalhado" data-toc="apparmor-profile-detalhado#container-runtime.md-apparmor-profile-detalhado">AppArmor Profile Detalhado</h3><div class="detached code-block" id="2096623244#lh20nt_61"><pre><code class="language-none">profile docker-default flags=(attach_disconnected,mediate_deleted) {
  network,
  capability,
  file,
  umount,

  deny @{PROC}/{*,**^[0-9*],sys/kernel/shm*} wkx,
  deny @{PROC}/sysrq-trigger rwklx,
  deny @{PROC}/mem rwklx,
  deny @{PROC}/kmem rwklx,
}</code></pre></div></section></section><section class="detached"><h2 id="2096623244#advanced-networking-features" data-toc="advanced-networking-features#container-runtime.md-advanced-networking-features">Advanced Networking Features <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#cni-plugin-implementation" data-toc="cni-plugin-implementation#container-runtime.md-cni-plugin-implementation">CNI Plugin Implementation</h3><div class="detached code-block" id="2096623244#lh20nt_64"><pre><code class="language-go">type CNI interface {
    Setup(ctx context.Context, id string, path string, opts ...Opt) (*CNIResult, error)
    Remove(ctx context.Context, id string, path string, opts ...Opt) error
    Load(opts ...Opt) error
    Status() error
}</code></pre></div></section><section class="detached"><h3 id="2096623244#network-namespace-configuration" data-toc="network-namespace-configuration#container-runtime.md-network-namespace-configuration">Network Namespace Configuration</h3><div class="detached code-block" id="2096623244#lh20nt_65"><pre><code class="language-bash"># Criar veth pair
ip link add veth0 type veth peer name veth1

# Mover para namespace
ip link set veth1 netns container1

# Configurar IP
nsenter -t $PID -n ip addr add 172.17.0.2/16 dev eth0</code></pre></div></section></section><section class="detached"><h2 id="2096623244#storage-internals" data-toc="storage-internals#container-runtime.md-storage-internals">Storage Internals <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#overlay2-driver" data-toc="overlay2-driver#container-runtime.md-overlay2-driver">Overlay2 Driver</h3><div class="detached code-block" id="2096623244#lh20nt_68"><pre><code class="language-none">
 Container Layer           

 Upper Dir                

 Work Dir                 

 Merged Dir               

 Lower Dir                
</code></pre></div></section><section class="detached"><h3 id="2096623244#volume-driver-plugin" data-toc="volume-driver-plugin#container-runtime.md-volume-driver-plugin">Volume Driver Plugin</h3><div class="detached code-block" id="2096623244#lh20nt_69"><pre><code class="language-go">type Driver interface {
    Create(name string, opts map[string]string) error
    Remove(name string) error
    Path(name string) string
    Mount(name string) (string, error)
    Unmount(name string) error
}</code></pre></div></section></section><section class="detached"><h2 id="2096623244#advanced-debugging-techniques" data-toc="advanced-debugging-techniques#container-runtime.md-advanced-debugging-techniques">Advanced Debugging Techniques <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#tracing-com-bpf" data-toc="tracing-com-bpf#container-runtime.md-tracing-com-bpf">Tracing com BPF</h3><div class="detached code-block" id="2096623244#lh20nt_72"><pre><code class="language-bash"># Trace syscalls
bpftrace -e 'tracepoint:syscalls:sys_enter_* /pid == 1234/ { @[probe] = count(); }'

# Trace network
bpftrace -e 'tracepoint:net:netif_receive_skb { @packets = count(); }'</code></pre></div></section><section class="detached"><h3 id="2096623244#core-dumps-analysis" data-toc="core-dumps-analysis#container-runtime.md-core-dumps-analysis">Core Dumps Analysis</h3><div class="detached code-block" id="2096623244#lh20nt_73"><pre><code class="language-bash"># Gerar core dump
echo &quot;core.%e.%p&quot; &gt; /proc/sys/kernel/core_pattern

# Analisar com gdb
gdb `which containerd` /tmp/core.containerd.12345</code></pre></div></section></section><section class="detached"><h2 id="2096623244#performance-profiling" data-toc="performance-profiling#container-runtime.md-performance-profiling">Performance Profiling <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#cpu-profiling" data-toc="cpu-profiling#container-runtime.md-cpu-profiling">CPU Profiling</h3><div class="detached code-block" id="2096623244#lh20nt_76"><pre><code class="language-bash"># Profiling com perf
perf record -F 99 -p $PID -g -- sleep 30

# Anlise
perf report --stdio</code></pre></div></section><section class="detached"><h3 id="2096623244#memory-analysis" data-toc="memory-analysis#container-runtime.md-memory-analysis">Memory Analysis</h3><div class="detached code-block" id="2096623244#lh20nt_77"><pre><code class="language-bash"># Heap profile
go tool pprof http://localhost:6060/debug/pprof/heap

# Goroutine analysis
go tool pprof http://localhost:6060/debug/pprof/goroutine</code></pre></div></section></section><section class="detached"><h2 id="2096623244#runtime-metrics-monitoring" data-toc="runtime-metrics-monitoring#container-runtime.md-runtime-metrics-monitoring">Runtime Metrics &amp; Monitoring <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#prometheus-metrics" data-toc="prometheus-metrics#container-runtime.md-prometheus-metrics">Prometheus Metrics</h3><div class="detached code-block" id="2096623244#lh20nt_80"><pre><code class="language-yaml">- job_name: 'containerd'
  static_configs:
    - targets: ['localhost:9100']
  metrics_path: '/metrics'</code></pre></div></section><section class="detached"><h3 id="2096623244#custom-metrics" data-toc="custom-metrics#container-runtime.md-custom-metrics">Custom Metrics</h3><div class="detached code-block" id="2096623244#lh20nt_81"><pre><code class="language-go">var (
    containerStarts = prometheus.NewCounter(prometheus.CounterOpts{
        Name: &quot;container_starts_total&quot;,
        Help: &quot;Total number of container starts&quot;,
    })
)</code></pre></div></section></section><section class="detached"><h2 id="2096623244#advanced-configuration" data-toc="advanced-configuration#container-runtime.md-advanced-configuration">Advanced Configuration <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#runtime-config" data-toc="runtime-config#container-runtime.md-runtime-config">Runtime Config</h3><div class="detached code-block" id="2096623244#lh20nt_84"><pre><code class="language-toml">[plugins.&quot;io.containerd.grpc.v1.cri&quot;]
  stream_server_address = &quot;127.0.0.1&quot;
  stream_server_port = &quot;0&quot;
  enable_selinux = false
  enable_tls_streaming = false
  
[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd]
  snapshotter = &quot;overlayfs&quot;
  default_runtime_name = &quot;runc&quot;</code></pre></div></section><section class="detached"><h3 id="2096623244#custom-runtime-handler" data-toc="custom-runtime-handler#container-runtime.md-custom-runtime-handler">Custom Runtime Handler</h3><div class="detached code-block" id="2096623244#lh20nt_85"><pre><code class="language-yaml">runtime_handler_pool:
  runtime_handlers:
    - name: &quot;custom-handler&quot;
      runtime_type: &quot;io.containerd.runc.v2&quot;
      runtime_root: &quot;/run/containerd/custom-handler&quot;
      privileged_without_host_devices: false</code></pre></div></section></section><section class="detached"><h2 id="2096623244#waifu-advanced-tips" data-toc="waifu-advanced-tips#container-runtime.md-waifu-advanced-tips">Waifu Advanced Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="2096623244#lh20nt_89"><span class="control" id="2096623244#lh20nt_90">Kernel-chan sugere:</span> &quot;Namespaces e cgroups s&atilde;o como os poderes m&aacute;gicos dos containers - use-os com sabedoria!&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="2096623244#lh20nt_91"><span class="control" id="2096623244#lh20nt_92">Security-sama alerta:</span> &quot;AppArmor e SELinux s&atilde;o seus guardi&otilde;es - nunca os desative em produ&ccedil;&atilde;o!&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="2096623244#lh20nt_93"><span class="control" id="2096623244#lh20nt_94">Debug-chan ensina:</span> &quot;strace e perf s&atilde;o suas ferramentas de investiga&ccedil;&atilde;o - domine-as para resolver qualquer mist&eacute;rio!&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="2096623244#refer-ncias-avan-adas" data-toc="refer-ncias-avan-adas#container-runtime.md-refer-ncias-avan-adas">Refer&ecirc;ncias Avan&ccedil;adas <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#especifica-es" data-toc="especifica-es#container-runtime.md-especifica-es">Especifica&ccedil;&otilde;es</h3><ul class="list" id="2096623244#lh20nt_102" start="1"><li class="list-item" id="2096623244#lh20nt_103"><p id="2096623244#lh20nt_106">OCI Runtime Spec v1.0 (<a href="https://github.com/opencontainers/runtime-spec">https://github.com/opencontainers/runtime-spec</a>)</p></li><li class="list-item" id="2096623244#lh20nt_104"><p id="2096623244#lh20nt_108">Container Network Interface Spec (<a href="https://github.com/containernetworking/cni">https://github.com/containernetworking/cni</a>)</p></li><li class="list-item" id="2096623244#lh20nt_105"><p id="2096623244#lh20nt_110">Image Spec v1.0 (<a href="https://github.com/opencontainers/image-spec">https://github.com/opencontainers/image-spec</a>)</p></li></ul></section><section class="detached"><h3 id="2096623244#documenta-o-t-cnica" data-toc="documenta-o-t-cnica#container-runtime.md-documenta-o-t-cnica">Documenta&ccedil;&atilde;o T&eacute;cnica</h3><ul class="list" id="2096623244#lh20nt_112" start="1"><li class="list-item" id="2096623244#lh20nt_113"><p id="2096623244#lh20nt_117">containerd Architecture</p></li><li class="list-item" id="2096623244#lh20nt_114"><p id="2096623244#lh20nt_118">runc Internals</p></li><li class="list-item" id="2096623244#lh20nt_115"><p id="2096623244#lh20nt_119">Linux Kernel Namespaces</p></li><li class="list-item" id="2096623244#lh20nt_116"><p id="2096623244#lh20nt_120">Control Groups v2</p></li></ul></section><section class="detached"><h3 id="2096623244#ferramentas-de-debug" data-toc="ferramentas-de-debug#container-runtime.md-ferramentas-de-debug">Ferramentas de Debug</h3><ul class="list" id="2096623244#lh20nt_121" start="1"><li class="list-item" id="2096623244#lh20nt_122"><p id="2096623244#lh20nt_126">runc debug</p></li><li class="list-item" id="2096623244#lh20nt_123"><p id="2096623244#lh20nt_127">ctr debug</p></li><li class="list-item" id="2096623244#lh20nt_124"><p id="2096623244#lh20nt_128">crictl debug</p></li><li class="list-item" id="2096623244#lh20nt_125"><p id="2096623244#lh20nt_129">containerd-debug</p></li></ul></section><section class="detached"><h3 id="2096623244#recursos-de-performance" data-toc="recursos-de-performance#container-runtime.md-recursos-de-performance">Recursos de Performance</h3><ul class="list" id="2096623244#lh20nt_130" start="1"><li class="list-item" id="2096623244#lh20nt_131"><p id="2096623244#lh20nt_135">perf-tools</p></li><li class="list-item" id="2096623244#lh20nt_132"><p id="2096623244#lh20nt_136">bpftrace</p></li><li class="list-item" id="2096623244#lh20nt_133"><p id="2096623244#lh20nt_137">systemtap</p></li><li class="list-item" id="2096623244#lh20nt_134"><p id="2096623244#lh20nt_138">ftrace</p></li></ul></section><section class="detached"><h3 id="2096623244#seguran-a" data-toc="seguran-a#container-runtime.md-seguran-a">Seguran&ccedil;a</h3><ul class="list" id="2096623244#lh20nt_139" start="1"><li class="list-item" id="2096623244#lh20nt_140"><p id="2096623244#lh20nt_144">AppArmor Profiles</p></li><li class="list-item" id="2096623244#lh20nt_141"><p id="2096623244#lh20nt_145">SELinux Policies</p></li><li class="list-item" id="2096623244#lh20nt_142"><p id="2096623244#lh20nt_146">Seccomp Filters</p></li><li class="list-item" id="2096623244#lh20nt_143"><p id="2096623244#lh20nt_147">Linux Capabilities</p></li></ul></section><section class="detached"><h3 id="2096623244#networking" data-toc="networking#container-runtime.md-networking">Networking</h3><ul class="list" id="2096623244#lh20nt_148" start="1"><li class="list-item" id="2096623244#lh20nt_149"><p id="2096623244#lh20nt_153">CNI Plugins</p></li><li class="list-item" id="2096623244#lh20nt_150"><p id="2096623244#lh20nt_154">Network Namespaces</p></li><li class="list-item" id="2096623244#lh20nt_151"><p id="2096623244#lh20nt_155">iptables</p></li><li class="list-item" id="2096623244#lh20nt_152"><p id="2096623244#lh20nt_156">tc (traffic control)</p></li></ul></section><section class="detached"><h3 id="2096623244#storage" data-toc="storage#container-runtime.md-storage">Storage</h3><ul class="list" id="2096623244#lh20nt_157" start="1"><li class="list-item" id="2096623244#lh20nt_158"><p id="2096623244#lh20nt_162">Overlay2</p></li><li class="list-item" id="2096623244#lh20nt_159"><p id="2096623244#lh20nt_163">Device Mapper</p></li><li class="list-item" id="2096623244#lh20nt_160"><p id="2096623244#lh20nt_164">BTRFS</p></li><li class="list-item" id="2096623244#lh20nt_161"><p id="2096623244#lh20nt_165">ZFS</p></li></ul></section></section><section class="detached"><h2 id="2096623244#gloss-rio" data-toc="gloss-rio#container-runtime.md-gloss-rio">Gloss&aacute;rio <span class="no-bold"></span></h2><section class="detached"><h3 id="2096623244#termos-essenciais" data-toc="termos-essenciais#container-runtime.md-termos-essenciais">Termos Essenciais</h3><div class="detached code-block" id="2096623244#lh20nt_168"><pre><code class="language-none">
 OCI      : Open Container Initiative       
 CNI      : Container Network Interface     
 Seccomp  : Secure Computing Mode          
 AppArmor : Sistema MAC de segurana       
 SELinux  : Security-Enhanced Linux        
 cgroups  : Control Groups                 
</code></pre></div></section><section class="detached"><h3 id="2096623244#componentes-do-runtime" data-toc="componentes-do-runtime#container-runtime.md-componentes-do-runtime">Componentes do Runtime</h3><div class="detached code-block" id="2096623244#lh20nt_169"><pre><code class="language-none">
 containerd : Container engine de alto nvel
 runc      : Runtime OCI de baixo nvel    
 shim      : Processo intermedirio        
</code></pre></div></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="684732172">Seguran&ccedil;a de Containers <span class="no-bold"></span></h1><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="684732172#-vg9iav_19">&quot;Na matrix dos containers, a seguran&ccedil;a n&atilde;o &eacute; uma op&ccedil;&atilde;o - &eacute; uma arte marcial.&quot; - Manifesto do Security-Sama</p></div>
</blockquote>
<section class="detached"><h2 id="684732172#o-dojo-da-seguran-a" data-toc="o-dojo-da-seguran-a#container-security.md-o-dojo-da-seguran-a">O Dojo da Seguran&ccedil;a <span class="no-bold"></span></h2><div class="detached code-block" id="684732172#-vg9iav_20"><pre><code class="language-none">
    SECURITY MATRIX: DEFCON 1      
                                   
    &quot;Proteja seus containers       
     como se o hack dependesse     
     disso... porque depende.&quot;     
</code></pre></div></section><section class="detached"><h2 id="684732172#fundamentos-de-seguran-a" data-toc="fundamentos-de-seguran-a#container-security.md-fundamentos-de-seguran-a">Fundamentos de Seguran&ccedil;a <span class="no-bold"></span></h2><section class="detached"><h3 id="684732172#princ-pios-b-sicos" data-toc="princ-pios-b-sicos#container-security.md-princ-pios-b-sicos">Princ&iacute;pios B&aacute;sicos</h3><ul class="list" id="684732172#-vg9iav_23" start="1"><li class="list-item" id="684732172#-vg9iav_24"><p id="684732172#-vg9iav_29">Princ&iacute;pio do menor privil&eacute;gio</p></li><li class="list-item" id="684732172#-vg9iav_25"><p id="684732172#-vg9iav_30">Defense in depth</p></li><li class="list-item" id="684732172#-vg9iav_26"><p id="684732172#-vg9iav_31">Segrega&ccedil;&atilde;o de responsabilidades</p></li><li class="list-item" id="684732172#-vg9iav_27"><p id="684732172#-vg9iav_32">Fail-safe defaults</p></li><li class="list-item" id="684732172#-vg9iav_28"><p id="684732172#-vg9iav_33">Economia de mecanismos</p></li></ul></section><section class="detached"><h3 id="684732172#modelo-de-amea-as" data-toc="modelo-de-amea-as#container-security.md-modelo-de-amea-as">Modelo de Amea&ccedil;as</h3><ol class="list list-decimal" id="684732172#-vg9iav_34" type="1" start="1"><li class="list-item" id="684732172#-vg9iav_35"><p id="684732172#-vg9iav_40">Ataques de rede</p></li><li class="list-item" id="684732172#-vg9iav_36"><p id="684732172#-vg9iav_41">Escala&ccedil;&atilde;o de privil&eacute;gios</p></li><li class="list-item" id="684732172#-vg9iav_37"><p id="684732172#-vg9iav_42">Vulnerabilidades de imagem</p></li><li class="list-item" id="684732172#-vg9iav_38"><p id="684732172#-vg9iav_43">Configura&ccedil;&otilde;es incorretas</p></li><li class="list-item" id="684732172#-vg9iav_39"><p id="684732172#-vg9iav_44">Malware e c&oacute;digo malicioso</p></li></ol></section></section><section class="detached"><h2 id="684732172#as-cinco-artes-marciais-da-seguran-a" data-toc="as-cinco-artes-marciais-da-seguran-a#container-security.md-as-cinco-artes-marciais-da-seguran-a">As Cinco Artes Marciais da Seguran&ccedil;a </h2><section class="detached"><h3 id="684732172#1-namespaces-o-isolamento-perfeito" data-toc="1-namespaces-o-isolamento-perfeito#container-security.md-1-namespaces-o-isolamento-perfeito">1. Namespaces: O Isolamento Perfeito</h3><div class="detached code-block" id="684732172#-vg9iav_50"><pre><code class="language-bash"># O ritual do isolamento
docker run --pid=host --ipc=host nginx
# &quot;Como um monge em sua montanha digital&quot;</code></pre></div><section class="detached"><h4 id="684732172#tipos-de-namespaces" data-toc="tipos-de-namespaces#container-security.md-tipos-de-namespaces">Tipos de Namespaces</h4><ul class="list" id="684732172#-vg9iav_52" start="1"><li class="list-item" id="684732172#-vg9iav_53"><p id="684732172#-vg9iav_59">PID Namespace</p></li><li class="list-item" id="684732172#-vg9iav_54"><p id="684732172#-vg9iav_60">Network Namespace</p></li><li class="list-item" id="684732172#-vg9iav_55"><p id="684732172#-vg9iav_61">Mount Namespace</p></li><li class="list-item" id="684732172#-vg9iav_56"><p id="684732172#-vg9iav_62">UTS Namespace</p></li><li class="list-item" id="684732172#-vg9iav_57"><p id="684732172#-vg9iav_63">IPC Namespace</p></li><li class="list-item" id="684732172#-vg9iav_58"><p id="684732172#-vg9iav_64">User Namespace</p></li></ul></section></section><section class="detached"><h3 id="684732172#2-capabilities-o-poder-controlado" data-toc="2-capabilities-o-poder-controlado#container-security.md-2-capabilities-o-poder-controlado">2. Capabilities: O Poder Controlado</h3><div class="detached code-block" id="684732172#-vg9iav_65"><pre><code class="language-bash"># Dropping powers like it's hot
docker run --cap-drop ALL --cap-add NET_BIND_SERVICE nginx
# &quot;Com grandes poderes vm grandes vulnerabilidades&quot;</code></pre></div><section class="detached"><h4 id="684732172#capabilities-essenciais" data-toc="capabilities-essenciais#container-security.md-capabilities-essenciais">Capabilities Essenciais</h4><ul class="list" id="684732172#-vg9iav_67" start="1"><li class="list-item" id="684732172#-vg9iav_68"><p id="684732172#-vg9iav_74">CAP_NET_BIND_SERVICE</p></li><li class="list-item" id="684732172#-vg9iav_69"><p id="684732172#-vg9iav_75">CAP_CHOWN</p></li><li class="list-item" id="684732172#-vg9iav_70"><p id="684732172#-vg9iav_76">CAP_DAC_OVERRIDE</p></li><li class="list-item" id="684732172#-vg9iav_71"><p id="684732172#-vg9iav_77">CAP_SETGID</p></li><li class="list-item" id="684732172#-vg9iav_72"><p id="684732172#-vg9iav_78">CAP_SETUID</p></li><li class="list-item" id="684732172#-vg9iav_73"><p id="684732172#-vg9iav_79">CAP_SETFCAP</p></li></ul></section></section><section class="detached"><h3 id="684732172#3-seccomp-o-filtro-m-stico" data-toc="3-seccomp-o-filtro-m-stico#container-security.md-3-seccomp-o-filtro-m-stico">3. SecComp: O Filtro M&iacute;stico</h3><div class="detached code-block" id="684732172#-vg9iav_80"><pre><code class="language-json">{
  &quot;defaultAction&quot;: &quot;SCMP_ACT_ERRNO&quot;,
  &quot;architectures&quot;: [&quot;SCMP_ARCH_X86_64&quot;],
  &quot;syscalls&quot;: [
    {
      &quot;names&quot;: [&quot;accept&quot;, &quot;bind&quot;],
      &quot;action&quot;: &quot;SCMP_ACT_ALLOW&quot;
    }
  ]
}</code></pre></div><section class="detached"><h4 id="684732172#perfis-seccomp-comuns" data-toc="perfis-seccomp-comuns#container-security.md-perfis-seccomp-comuns">Perfis SecComp Comuns</h4><ul class="list" id="684732172#-vg9iav_82" start="1"><li class="list-item" id="684732172#-vg9iav_83"><p id="684732172#-vg9iav_86">Default Docker Profile</p></li><li class="list-item" id="684732172#-vg9iav_84"><p id="684732172#-vg9iav_87">Custom Restricted Profile</p></li><li class="list-item" id="684732172#-vg9iav_85"><p id="684732172#-vg9iav_88">No New Privileges Flag</p></li></ul></section></section><section class="detached"><h3 id="684732172#4-apparmor-o-escudo-invis-vel" data-toc="4-apparmor-o-escudo-invis-vel#container-security.md-4-apparmor-o-escudo-invis-vel">4. AppArmor: O Escudo Invis&iacute;vel</h3><div class="detached code-block" id="684732172#-vg9iav_89"><pre><code class="language-bash"># Profile de proteo
docker run --security-opt apparmor=docker-default nginx
# &quot;Protegido por foras alm da compreenso mortal&quot;</code></pre></div><section class="detached"><h4 id="684732172#pol-ticas-apparmor" data-toc="pol-ticas-apparmor#container-security.md-pol-ticas-apparmor">Pol&iacute;ticas AppArmor</h4><ul class="list" id="684732172#-vg9iav_91" start="1"><li class="list-item" id="684732172#-vg9iav_92"><p id="684732172#-vg9iav_96">Controle de acesso a arquivos</p></li><li class="list-item" id="684732172#-vg9iav_93"><p id="684732172#-vg9iav_97">Capacidades de rede</p></li><li class="list-item" id="684732172#-vg9iav_94"><p id="684732172#-vg9iav_98">Montagem de sistemas de arquivos</p></li><li class="list-item" id="684732172#-vg9iav_95"><p id="684732172#-vg9iav_99">Execu&ccedil;&atilde;o de programas</p></li></ul></section></section><section class="detached"><h3 id="684732172#5-selinux-o-guardi-o-ancestral" data-toc="5-selinux-o-guardi-o-ancestral#container-security.md-5-selinux-o-guardi-o-ancestral">5. SELinux: O Guardi&atilde;o Ancestral</h3><div class="detached code-block" id="684732172#-vg9iav_100"><pre><code class="language-bash"># Modo enforcing ativado
docker run --security-opt label=level:s0:c100,c200 nginx
# &quot;Porque s vezes, paranoia  apenas bom senso&quot;</code></pre></div><section class="detached"><h4 id="684732172#contextos-selinux" data-toc="contextos-selinux#container-security.md-contextos-selinux">Contextos SELinux</h4><ul class="list" id="684732172#-vg9iav_102" start="1"><li class="list-item" id="684732172#-vg9iav_103"><p id="684732172#-vg9iav_107">Processo</p></li><li class="list-item" id="684732172#-vg9iav_104"><p id="684732172#-vg9iav_108">Arquivo</p></li><li class="list-item" id="684732172#-vg9iav_105"><p id="684732172#-vg9iav_109">Porta</p></li><li class="list-item" id="684732172#-vg9iav_106"><p id="684732172#-vg9iav_110">Usu&aacute;rio</p></li></ul></section></section></section><section class="detached"><h2 id="684732172#seguran-a-em-camadas" data-toc="seguran-a-em-camadas#container-security.md-seguran-a-em-camadas">Seguran&ccedil;a em Camadas <span class="no-bold"></span></h2><section class="detached"><h3 id="684732172#1-seguran-a-da-imagem" data-toc="1-seguran-a-da-imagem#container-security.md-1-seguran-a-da-imagem">1. Seguran&ccedil;a da Imagem</h3><ul class="list" id="684732172#-vg9iav_114" start="1"><li class="list-item" id="684732172#-vg9iav_115"><p id="684732172#-vg9iav_120">Imagens base m&iacute;nimas</p></li><li class="list-item" id="684732172#-vg9iav_116"><p id="684732172#-vg9iav_121">Multi-stage builds</p></li><li class="list-item" id="684732172#-vg9iav_117"><p id="684732172#-vg9iav_122">Scanning de vulnerabilidades</p></li><li class="list-item" id="684732172#-vg9iav_118"><p id="684732172#-vg9iav_123">Versionamento expl&iacute;cito</p></li><li class="list-item" id="684732172#-vg9iav_119"><p id="684732172#-vg9iav_124">Pol&iacute;ticas de atualiza&ccedil;&atilde;o</p></li></ul></section><section class="detached"><h3 id="684732172#2-seguran-a-do-runtime" data-toc="2-seguran-a-do-runtime#container-security.md-2-seguran-a-do-runtime">2. Seguran&ccedil;a do Runtime</h3><ul class="list" id="684732172#-vg9iav_125" start="1"><li class="list-item" id="684732172#-vg9iav_126"><p id="684732172#-vg9iav_131">Limites de recursos</p></li><li class="list-item" id="684732172#-vg9iav_127"><p id="684732172#-vg9iav_132">Health checks</p></li><li class="list-item" id="684732172#-vg9iav_128"><p id="684732172#-vg9iav_133">Logging e monitoramento</p></li><li class="list-item" id="684732172#-vg9iav_129"><p id="684732172#-vg9iav_134">Pol&iacute;ticas de reinicializa&ccedil;&atilde;o</p></li><li class="list-item" id="684732172#-vg9iav_130"><p id="684732172#-vg9iav_135">Gest&atilde;o de secrets</p></li></ul></section><section class="detached"><h3 id="684732172#3-seguran-a-da-rede" data-toc="3-seguran-a-da-rede#container-security.md-3-seguran-a-da-rede">3. Seguran&ccedil;a da Rede</h3><ul class="list" id="684732172#-vg9iav_136" start="1"><li class="list-item" id="684732172#-vg9iav_137"><p id="684732172#-vg9iav_142">Redes isoladas</p></li><li class="list-item" id="684732172#-vg9iav_138"><p id="684732172#-vg9iav_143">Firewalls internos</p></li><li class="list-item" id="684732172#-vg9iav_139"><p id="684732172#-vg9iav_144">TLS m&uacute;tuo</p></li><li class="list-item" id="684732172#-vg9iav_140"><p id="684732172#-vg9iav_145">Service mesh</p></li><li class="list-item" id="684732172#-vg9iav_141"><p id="684732172#-vg9iav_146">Network policies</p></li></ul></section></section><section class="detached"><h2 id="684732172#best-practices-o-caminho-do-guerreiro" data-toc="best-practices-o-caminho-do-guerreiro#container-security.md-best-practices-o-caminho-do-guerreiro">Best Practices: O Caminho do Guerreiro <span class="no-bold"></span></h2><section class="detached"><h3 id="684732172#do-s" data-toc="do-s#container-security.md-do-s">DO's <span class="no-bold"></span></h3><div class="detached code-block" id="684732172#-vg9iav_149"><pre><code class="language-none">
 1. Minimize a superfcie       
 2. Use imagens oficiais        
 3. Scan de vulnerabilidades    
 4. Updates regulares           
 5. Monitore tudo              
</code></pre></div></section><section class="detached"><h3 id="684732172#don-ts" data-toc="don-ts#container-security.md-don-ts">DON'Ts <span class="no-bold"></span></h3><div class="detached code-block" id="684732172#-vg9iav_150"><pre><code class="language-none">
 1. Nunca use root             
 2. No ignore warnings        
 3. Evite portas desnecessrias
 4. No guarde secrets no code 
 5. No confie em ningum     
</code></pre></div></section></section><section class="detached"><h2 id="684732172#secrets-management-a-arte-do-sigilo" data-toc="secrets-management-a-arte-do-sigilo#container-security.md-secrets-management-a-arte-do-sigilo">Secrets Management: A Arte do Sigilo <span class="no-bold"></span></h2><section class="detached"><h3 id="684732172#vault-chan-s-tips" data-toc="vault-chan-s-tips#container-security.md-vault-chan-s-tips">Vault-chan's Tips</h3><div class="detached code-block" id="684732172#-vg9iav_153"><pre><code class="language-bash"># Gerenciando secrets como um ninja
docker secret create app_secret secret.txt
docker service create --secret app_secret nginx
# &quot;Seus segredos esto seguros comigo, senpai!&quot;</code></pre></div></section><section class="detached"><h3 id="684732172#estrat-gias-de-gest-o-de-secrets" data-toc="estrat-gias-de-gest-o-de-secrets#container-security.md-estrat-gias-de-gest-o-de-secrets">Estrat&eacute;gias de Gest&atilde;o de Secrets</h3><ol class="list list-decimal" id="684732172#-vg9iav_154" type="1" start="1"><li class="list-item" id="684732172#-vg9iav_155"><p id="684732172#-vg9iav_160">Docker Secrets</p></li><li class="list-item" id="684732172#-vg9iav_156"><p id="684732172#-vg9iav_161">HashiCorp Vault</p></li><li class="list-item" id="684732172#-vg9iav_157"><p id="684732172#-vg9iav_162">AWS Secrets Manager</p></li><li class="list-item" id="684732172#-vg9iav_158"><p id="684732172#-vg9iav_163">Azure Key Vault</p></li><li class="list-item" id="684732172#-vg9iav_159"><p id="684732172#-vg9iav_164">GCP Secret Manager</p></li></ol></section></section><section class="detached"><h2 id="684732172#container-hardening-a-forja-digital" data-toc="container-hardening-a-forja-digital#container-security.md-container-hardening-a-forja-digital">Container Hardening: A Forja Digital <span class="no-bold"></span></h2><section class="detached"><h3 id="684732172#dockerfile-fortificado" data-toc="dockerfile-fortificado#container-security.md-dockerfile-fortificado">Dockerfile Fortificado</h3><div class="detached code-block" id="684732172#-vg9iav_167"><pre><code class="language-none"># Base segura
FROM alpine:latest AS builder
RUN adduser -D appuser
USER appuser

# Multi-stage para minimizar superfcie
FROM scratch
COPY --from=builder /etc/passwd /etc/passwd
USER appuser</code></pre></div></section><section class="detached"><h3 id="684732172#checklist-de-hardening" data-toc="checklist-de-hardening#container-security.md-checklist-de-hardening">Checklist de Hardening</h3><ol class="list list-decimal" id="684732172#-vg9iav_168" type="1" start="1"><li class="list-item" id="684732172#-vg9iav_169"><p id="684732172#-vg9iav_174">Usu&aacute;rio n&atilde;o-root</p></li><li class="list-item" id="684732172#-vg9iav_170"><p id="684732172#-vg9iav_175">Filesystem read-only</p></li><li class="list-item" id="684732172#-vg9iav_171"><p id="684732172#-vg9iav_176">Capabilities m&iacute;nimas</p></li><li class="list-item" id="684732172#-vg9iav_172"><p id="684732172#-vg9iav_177">Seccomp profile</p></li><li class="list-item" id="684732172#-vg9iav_173"><p id="684732172#-vg9iav_178">AppArmor/SELinux</p></li></ol></section></section><section class="detached"><h2 id="684732172#security-scanning-o-olho-que-tudo-v" data-toc="security-scanning-o-olho-que-tudo-v#container-security.md-security-scanning-o-olho-que-tudo-v">Security Scanning: O Olho que Tudo V&ecirc; <span class="no-bold"></span></h2><section class="detached"><h3 id="684732172#ferramentas-de-scanning" data-toc="ferramentas-de-scanning#container-security.md-ferramentas-de-scanning">Ferramentas de Scanning</h3><ol class="list list-decimal" id="684732172#-vg9iav_181" type="1" start="1"><li class="list-item" id="684732172#-vg9iav_182"><p id="684732172#-vg9iav_187">Trivy</p></li><li class="list-item" id="684732172#-vg9iav_183"><p id="684732172#-vg9iav_188">Clair</p></li><li class="list-item" id="684732172#-vg9iav_184"><p id="684732172#-vg9iav_189">Anchore</p></li><li class="list-item" id="684732172#-vg9iav_185"><p id="684732172#-vg9iav_190">Snyk</p></li><li class="list-item" id="684732172#-vg9iav_186"><p id="684732172#-vg9iav_191">Docker Scan</p></li></ol></section><section class="detached"><h3 id="684732172#trivy-o-scanner-m-stico" data-toc="trivy-o-scanner-m-stico#container-security.md-trivy-o-scanner-m-stico">Trivy: O Scanner M&iacute;stico</h3><div class="detached code-block" id="684732172#-vg9iav_192"><pre><code class="language-bash"># Invocando o scanner
trivy image nginx:latest
# &quot;Deixe que os olhos do void examinem seu cdigo&quot;</code></pre></div></section></section><section class="detached"><h2 id="684732172#runtime-protection-a-guarda-eterna" data-toc="runtime-protection-a-guarda-eterna#container-security.md-runtime-protection-a-guarda-eterna">Runtime Protection: A Guarda Eterna <span class="no-bold"></span></h2><section class="detached"><h3 id="684732172#falco-o-sentinela" data-toc="falco-o-sentinela#container-security.md-falco-o-sentinela">Falco: O Sentinela</h3><div class="detached code-block" id="684732172#-vg9iav_195"><pre><code class="language-yaml">- rule: Terminal shell in container
  desc: A shell was spawned by a container
  condition: container.id != host and proc.name = bash
  output: Shell spawned in a container (user=%user.name container=%container.name)
  priority: WARNING</code></pre></div></section><section class="detached"><h3 id="684732172#ferramentas-de-runtime-protection" data-toc="ferramentas-de-runtime-protection#container-security.md-ferramentas-de-runtime-protection">Ferramentas de Runtime Protection</h3><ol class="list list-decimal" id="684732172#-vg9iav_196" type="1" start="1"><li class="list-item" id="684732172#-vg9iav_197"><p id="684732172#-vg9iav_202">Falco</p></li><li class="list-item" id="684732172#-vg9iav_198"><p id="684732172#-vg9iav_203">Aqua Security</p></li><li class="list-item" id="684732172#-vg9iav_199"><p id="684732172#-vg9iav_204">Twistlock</p></li><li class="list-item" id="684732172#-vg9iav_200"><p id="684732172#-vg9iav_205">NeuVector</p></li><li class="list-item" id="684732172#-vg9iav_201"><p id="684732172#-vg9iav_206">StackRox</p></li></ol></section></section><section class="detached"><h2 id="684732172#incident-response-o-plano-de-batalha" data-toc="incident-response-o-plano-de-batalha#container-security.md-incident-response-o-plano-de-batalha">Incident Response: O Plano de Batalha <span class="no-bold"></span></h2><section class="detached"><h3 id="684732172#o-protocolo-do-caos" data-toc="o-protocolo-do-caos#container-security.md-o-protocolo-do-caos">O Protocolo do Caos</h3><ol class="list list-decimal" id="684732172#-vg9iav_209" type="1" start="1"><li class="list-item" id="684732172#-vg9iav_210"><p id="684732172#-vg9iav_214">Detectar: &quot;Algo se move nas sombras...&quot;</p></li><li class="list-item" id="684732172#-vg9iav_211"><p id="684732172#-vg9iav_215">Conter: &quot;Sele as brechas!&quot;</p></li><li class="list-item" id="684732172#-vg9iav_212"><p id="684732172#-vg9iav_216">Erradicar: &quot;Purifica&ccedil;&atilde;o digital!&quot;</p></li><li class="list-item" id="684732172#-vg9iav_213"><p id="684732172#-vg9iav_217">Recuperar: &quot;Ressurrei&ccedil;&atilde;o dos sistemas!&quot;</p></li></ol></section><section class="detached"><h3 id="684732172#playbooks-de-resposta" data-toc="playbooks-de-resposta#container-security.md-playbooks-de-resposta">Playbooks de Resposta</h3><ol class="list list-decimal" id="684732172#-vg9iav_218" type="1" start="1"><li class="list-item" id="684732172#-vg9iav_219"><p id="684732172#-vg9iav_224">Container Compromise</p></li><li class="list-item" id="684732172#-vg9iav_220"><p id="684732172#-vg9iav_225">Image Vulnerability</p></li><li class="list-item" id="684732172#-vg9iav_221"><p id="684732172#-vg9iav_226">Network Breach</p></li><li class="list-item" id="684732172#-vg9iav_222"><p id="684732172#-vg9iav_227">Resource Exhaustion</p></li><li class="list-item" id="684732172#-vg9iav_223"><p id="684732172#-vg9iav_228">Privilege Escalation</p></li></ol></section></section><section class="detached"><h2 id="684732172#compliance-e-auditoria" data-toc="compliance-e-auditoria#container-security.md-compliance-e-auditoria">Compliance e Auditoria <span class="no-bold"></span></h2><section class="detached"><h3 id="684732172#frameworks-de-compliance" data-toc="frameworks-de-compliance#container-security.md-frameworks-de-compliance">Frameworks de Compliance</h3><ul class="list" id="684732172#-vg9iav_231" start="1"><li class="list-item" id="684732172#-vg9iav_232"><p id="684732172#-vg9iav_237">CIS Docker Benchmark</p></li><li class="list-item" id="684732172#-vg9iav_233"><p id="684732172#-vg9iav_238">NIST Container Security</p></li><li class="list-item" id="684732172#-vg9iav_234"><p id="684732172#-vg9iav_239">PCI DSS</p></li><li class="list-item" id="684732172#-vg9iav_235"><p id="684732172#-vg9iav_240">HIPAA</p></li><li class="list-item" id="684732172#-vg9iav_236"><p id="684732172#-vg9iav_241">SOC 2</p></li></ul></section><section class="detached"><h3 id="684732172#ferramentas-de-auditoria" data-toc="ferramentas-de-auditoria#container-security.md-ferramentas-de-auditoria">Ferramentas de Auditoria</h3><ol class="list list-decimal" id="684732172#-vg9iav_242" type="1" start="1"><li class="list-item" id="684732172#-vg9iav_243"><p id="684732172#-vg9iav_248">Docker Bench Security</p></li><li class="list-item" id="684732172#-vg9iav_244"><p id="684732172#-vg9iav_249">InSpec</p></li><li class="list-item" id="684732172#-vg9iav_245"><p id="684732172#-vg9iav_250">Dockle</p></li><li class="list-item" id="684732172#-vg9iav_246"><p id="684732172#-vg9iav_251">Lynis</p></li><li class="list-item" id="684732172#-vg9iav_247"><p id="684732172#-vg9iav_252">OpenSCAP</p></li></ol></section></section><section class="detached"><h2 id="684732172#waifu-security-tips" data-toc="waifu-security-tips#container-security.md-waifu-security-tips">Waifu Security Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="684732172#-vg9iav_255"><span class="control" id="684732172#-vg9iav_256">Security-chan avisa</span>: &quot;Containers s&atilde;o como castelos - proteja todas as entradas, ou prepare-se para invas&otilde;es! uwu&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="684732172#-vg9iav_257"><span class="control" id="684732172#-vg9iav_258">Firewall-sama declara</span>: &quot;Uma porta aberta &eacute; como um convite para o caos digital! Ara ara~&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="684732172#laborat-rio-pr-tico" data-toc="laborat-rio-pr-tico#container-security.md-laborat-rio-pr-tico">Laborat&oacute;rio Pr&aacute;tico <span class="no-bold"></span></h2><section class="detached"><h3 id="684732172#exerc-cio-1-configura-o-b-sica" data-toc="exerc-cio-1-configura-o-b-sica#container-security.md-exerc-cio-1-configura-o-b-sica">Exerc&iacute;cio 1: Configura&ccedil;&atilde;o B&aacute;sica</h3><ol class="list list-decimal" id="684732172#-vg9iav_262" type="1" start="1"><li class="list-item" id="684732172#-vg9iav_263"><p id="684732172#-vg9iav_268">Configure um container rootless</p></li><li class="list-item" id="684732172#-vg9iav_264"><p id="684732172#-vg9iav_269">Implemente AppArmor profile</p></li><li class="list-item" id="684732172#-vg9iav_265"><p id="684732172#-vg9iav_270">Configure network policies</p></li><li class="list-item" id="684732172#-vg9iav_266"><p id="684732172#-vg9iav_271">Estabele&ccedil;a resource limits</p></li><li class="list-item" id="684732172#-vg9iav_267"><p id="684732172#-vg9iav_272">Implemente health checks</p></li></ol></section><section class="detached"><h3 id="684732172#exerc-cio-2-hardening-avan-ado" data-toc="exerc-cio-2-hardening-avan-ado#container-security.md-exerc-cio-2-hardening-avan-ado">Exerc&iacute;cio 2: Hardening Avan&ccedil;ado</h3><ol class="list list-decimal" id="684732172#-vg9iav_273" type="1" start="1"><li class="list-item" id="684732172#-vg9iav_274"><p id="684732172#-vg9iav_279">Multi-stage build</p></li><li class="list-item" id="684732172#-vg9iav_275"><p id="684732172#-vg9iav_280">SecComp profile customizado</p></li><li class="list-item" id="684732172#-vg9iav_276"><p id="684732172#-vg9iav_281">SELinux policies</p></li><li class="list-item" id="684732172#-vg9iav_277"><p id="684732172#-vg9iav_282">Docker Secrets</p></li><li class="list-item" id="684732172#-vg9iav_278"><p id="684732172#-vg9iav_283">Scanning automation</p></li></ol></section><section class="detached"><h3 id="684732172#exerc-cio-3-monitoramento" data-toc="exerc-cio-3-monitoramento#container-security.md-exerc-cio-3-monitoramento">Exerc&iacute;cio 3: Monitoramento</h3><ol class="list list-decimal" id="684732172#-vg9iav_284" type="1" start="1"><li class="list-item" id="684732172#-vg9iav_285"><p id="684732172#-vg9iav_290">Configure Falco</p></li><li class="list-item" id="684732172#-vg9iav_286"><p id="684732172#-vg9iav_291">Implemente logging</p></li><li class="list-item" id="684732172#-vg9iav_287"><p id="684732172#-vg9iav_292">Setup alerting</p></li><li class="list-item" id="684732172#-vg9iav_288"><p id="684732172#-vg9iav_293">Trace syscalls</p></li><li class="list-item" id="684732172#-vg9iav_289"><p id="684732172#-vg9iav_294">Analyze metrics</p></li></ol></section></section><section class="detached"><h2 id="684732172#palavras-finais" data-toc="palavras-finais#container-security.md-palavras-finais">Palavras Finais</h2><p id="684732172#-vg9iav_295">Como diria o lend&aacute;rio Security Master: &quot;Na matrix dos containers, n&atilde;o existem sistemas 100% seguros - apenas n&iacute;veis diferentes de paranoia.&quot;</p></section><section class="detached"><h2 id="684732172#recursos-adicionais" data-toc="recursos-adicionais#container-security.md-recursos-adicionais">Recursos Adicionais <span class="no-bold"></span></h2><section class="detached"><h3 id="684732172#documenta-o-oficial" data-toc="documenta-o-oficial#container-security.md-documenta-o-oficial">Documenta&ccedil;&atilde;o Oficial</h3><ul class="list" id="684732172#-vg9iav_299" start="1"><li class="list-item" id="684732172#-vg9iav_300"><p id="684732172#-vg9iav_303">Docker Security (<a href="https://docs.docker.com/engine/security/">https://docs.docker.com/engine/security/</a>)</p></li><li class="list-item" id="684732172#-vg9iav_301"><p id="684732172#-vg9iav_305">Kubernetes Security (<a href="https://kubernetes.io/docs/concepts/security/">https://kubernetes.io/docs/concepts/security/</a>)</p></li><li class="list-item" id="684732172#-vg9iav_302"><p id="684732172#-vg9iav_307">Container Security Guide (<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf</a>)</p></li></ul></section><section class="detached"><h3 id="684732172#ferramentas" data-toc="ferramentas#container-security.md-ferramentas">Ferramentas</h3><ul class="list" id="684732172#-vg9iav_309" start="1"><li class="list-item" id="684732172#-vg9iav_310"><p id="684732172#-vg9iav_313">Docker Bench Security (<a href="https://github.com/docker/docker-bench-security">https://github.com/docker/docker-bench-security</a>)</p></li><li class="list-item" id="684732172#-vg9iav_311"><p id="684732172#-vg9iav_315">Trivy (<a href="https://github.com/aquasecurity/trivy">https://github.com/aquasecurity/trivy</a>)</p></li><li class="list-item" id="684732172#-vg9iav_312"><p id="684732172#-vg9iav_317">Falco (<a href="https://falco.org/">https://falco.org/</a>)</p></li></ul></section><section class="detached"><h3 id="684732172#comunidade" data-toc="comunidade#container-security.md-comunidade">Comunidade</h3><ul class="list" id="684732172#-vg9iav_319" start="1"><li class="list-item" id="684732172#-vg9iav_322"><p id="684732172#-vg9iav_325">Docker Security Mailing List</p></li><li class="list-item" id="684732172#-vg9iav_323"><p id="684732172#-vg9iav_326">Container Security Working Group</p></li><li class="list-item" id="684732172#-vg9iav_324"><p id="684732172#-vg9iav_327">CNCF Security SIG</p></li></ul><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="684732172#-vg9iav_328">&quot;E lembre-se: quando a noite digital cai, apenas seus controles de seguran&ccedil;a separam seus containers do caos.&quot; - Mem&oacute;rias de um Security Engineer, 2084</p></div>
</blockquote>
</section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-459582987">Orquestra&ccedil;&atilde;o de Containers: A Sinfonia do Caos Digital</h1><div class="detached code-block" id="-459582987#kbir4g_3"><pre><code class="language-none">
  ORQUESTRAO: A SINFONIA DO CAOS                                           
                                                                              
                                            
  Pod 1Pod 2Pod 3Conductor                                 
                                            
                                                                         
                                             
                                                                              
</code></pre></div><p id="-459582987#kbir4g_4">Ah, caro leitor, adentre comigo este submundo digital onde containers dan&ccedil;am sua valsa ef&ecirc;mera, nascendo e morrendo como sonhos em uma noite de ne&oacute;n. Como num romance g&oacute;tico-tech, onde cada microsservi&ccedil;o &eacute; um personagem em busca de seu prop&oacute;sito existencial, a orquestra&ccedil;&atilde;o emerge como o narrador onisciente, guiando destinos em meio ao caos dos datacenters.</p><section class="detached"><h2 id="-459582987#a-anatomia-do-caos-controlado" data-toc="a-anatomia-do-caos-controlado#container-orchestration.md-a-anatomia-do-caos-controlado">A Anatomia do Caos Controlado</h2><p id="-459582987#kbir4g_12">Imagine, se puder, uma metr&oacute;pole vertical onde cada container &eacute; um apartamento em um arranha-c&eacute;u infinito. Sem a orquestra&ccedil;&atilde;o, ter&iacute;amos o caos - containers brigando por recursos como moradores disputando o &uacute;ltimo peda&ccedil;o de pizza no elevador.</p><div class="detached mermaid" id="-459582987#kbir4g_13"><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 627.3125 326"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="627.3125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M317.688,55.293L289.461,62.577C261.234,69.862,204.781,84.431,176.555,94.799C148.328,105.167,148.328,111.333,148.328,116.833C148.328,122.333,148.328,127.167,148.328,129.583L148.328,132"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M396.32,62L396.32,68.167C396.32,74.333,396.32,86.667,396.32,95.917C396.32,105.167,396.32,111.333,396.32,116.833C396.32,122.333,396.32,127.167,396.32,129.583L396.32,132"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M466.068,62L481.998,68.167C497.928,74.333,529.788,86.667,545.718,95.917C561.648,105.167,561.648,111.333,561.648,116.833C561.648,122.333,561.648,127.167,561.648,129.583L561.648,132"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_E_3" d="M113.454,190L105.489,196.167C97.524,202.333,81.594,214.667,73.629,223.917C65.664,233.167,65.664,239.333,65.664,244.833C65.664,250.333,65.664,255.167,65.664,257.583L65.664,260"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_F_4" d="M183.202,190L191.167,196.167C199.132,202.333,215.062,214.667,223.027,223.917C230.992,233.167,230.992,239.333,230.992,244.833C230.992,250.333,230.992,255.167,230.992,257.583L230.992,260"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_G_5" d="M396.32,190L396.32,196.167C396.32,202.333,396.32,214.667,396.32,223.917C396.32,233.167,396.32,239.333,396.32,244.833C396.32,250.333,396.32,255.167,396.32,257.583L396.32,260"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_H_6" d="M561.648,190L561.648,196.167C561.648,202.333,561.648,214.667,561.648,223.917C561.648,233.167,561.648,239.333,561.648,244.833C561.648,250.333,561.648,255.167,561.648,257.583L561.648,260"></path></g><g class="edgeLabels"><g transform="translate(148.328125, 99)" class="edgeLabel"><g transform="translate(-34.7734375, -12)" class="label"><foreignObject height="24" width="69.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Comanda</p></span></div></foreignObject></g></g><g transform="translate(396.3203125, 99)" class="edgeLabel"><g transform="translate(-31.2265625, -12)" class="label"><foreignObject height="24" width="62.453125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Monitora</p></span></div></foreignObject></g></g><g transform="translate(561.6484375, 99)" class="edgeLabel"><g transform="translate(-30.3359375, -12)" class="label"><foreignObject height="24" width="60.671875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Controla</p></span></div></foreignObject></g></g><g transform="translate(65.6640625, 227)" class="edgeLabel"><g transform="translate(-28.9921875, -12)" class="label"><foreignObject height="24" width="57.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Executa</p></span></div></foreignObject></g></g><g transform="translate(230.9921875, 227)" class="edgeLabel"><g transform="translate(-28.9921875, -12)" class="label"><foreignObject height="24" width="57.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Executa</p></span></div></foreignObject></g></g><g transform="translate(396.3203125, 227)" class="edgeLabel"><g transform="translate(-28.9921875, -12)" class="label"><foreignObject height="24" width="57.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Executa</p></span></div></foreignObject></g></g><g transform="translate(561.6484375, 227)" class="edgeLabel"><g transform="translate(-28.9921875, -12)" class="label"><foreignObject height="24" width="57.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Executa</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(396.3203125, 35)" id="flowchart-A-108" class="node default"><rect height="54" width="157.265625" y="-27" x="-78.6328125" data-et="node" data-id="abc" style="fill:#ff0066 !important;stroke:#333 !important;stroke-width:4px !important" class="basic label-container"></rect><g transform="translate(-48.6328125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="97.265625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Control Plane</p></span></div></foreignObject></g></g><g transform="translate(148.328125, 163)" id="flowchart-B-109" class="node default"><rect height="54" width="111.75" y="-27" x="-55.875" data-et="node" data-id="abc" style="fill:#00ccff !important;stroke:#333 !important;stroke-width:2px !important" class="basic label-container"></rect><g transform="translate(-25.875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="51.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Node 1</p></span></div></foreignObject></g></g><g transform="translate(396.3203125, 163)" id="flowchart-C-111" class="node default"><rect height="54" width="111.75" y="-27" x="-55.875" data-et="node" data-id="abc" style="fill:#00ccff !important;stroke:#333 !important;stroke-width:2px !important" class="basic label-container"></rect><g transform="translate(-25.875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="51.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Node 2</p></span></div></foreignObject></g></g><g transform="translate(561.6484375, 163)" id="flowchart-D-113" class="node default"><rect height="54" width="111.75" y="-27" x="-55.875" data-et="node" data-id="abc" style="fill:#00ccff !important;stroke:#333 !important;stroke-width:2px !important" class="basic label-container"></rect><g transform="translate(-25.875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="51.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Node 3</p></span></div></foreignObject></g></g><g transform="translate(65.6640625, 291)" id="flowchart-E-115" class="node default"><rect height="54" width="115.328125" y="-27" x="-57.6640625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-27.6640625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="55.328125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Pod 1.1</p></span></div></foreignObject></g></g><g transform="translate(230.9921875, 291)" id="flowchart-F-117" class="node default"><rect height="54" width="115.328125" y="-27" x="-57.6640625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-27.6640625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="55.328125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Pod 1.2</p></span></div></foreignObject></g></g><g transform="translate(396.3203125, 291)" id="flowchart-G-119" class="node default"><rect height="54" width="115.328125" y="-27" x="-57.6640625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-27.6640625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="55.328125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Pod 2.1</p></span></div></foreignObject></g></g><g transform="translate(561.6484375, 291)" id="flowchart-H-121" class="node default"><rect height="54" width="115.328125" y="-27" x="-57.6640625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-27.6640625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="55.328125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Pod 3.1</p></span></div></foreignObject></g></g></g></g></g></svg></div><section class="detached"><h3 id="-459582987#a-dan-a-dos-containers" data-toc="a-dan-a-dos-containers#container-orchestration.md-a-dan-a-dos-containers">A Dan&ccedil;a dos Containers</h3><p id="-459582987#kbir4g_15">Como um baile de m&aacute;scaras em uma festa corporativa dist&oacute;pica, cada container executa sua coreografia precisamente ensaiada. O load balancer, qual mestre de cerim&ocirc;nias cibern&eacute;tico, direciona o fluxo de requests como um DJ mixando batidas em uma rave underground.</p><div class="detached code-block" id="-459582987#kbir4g_16"><pre><code class="language-none">
    A VALSA DOS CONTAINERS                          
                                                    
                                 
    App1LoadApp2           
             Bal                     
                                           
                                                
                                                
                                 
    App3CacheApp4           
                                 
</code></pre></div></section></section><section class="detached"><h2 id="-459582987#conceitos-fundamentais" data-toc="conceitos-fundamentais#container-orchestration.md-conceitos-fundamentais">Conceitos Fundamentais</h2><section class="detached"><h3 id="-459582987#orquestra-o" data-toc="orquestra-o#container-orchestration.md-orquestra-o">Orquestra&ccedil;&atilde;o</h3><p id="-459582987#kbir4g_19">Imagine uma sinfonia ca&oacute;tica, onde cada container &eacute; um m&uacute;sico rebelde tocando seu pr&oacute;prio instrumento. A orquestra&ccedil;&atilde;o &eacute; nosso maestro cibern&eacute;tico, transformando essa cacofonia digital em uma sinfonia harm&ocirc;nica. Como um controle de tr&aacute;fego a&eacute;reo para seus microsservi&ccedil;os, s&oacute; que com menos caf&eacute; e mais automa&ccedil;&atilde;o.</p><p id="-459582987#kbir4g_20">Em vez de ter DevOps insones monitorando dashboards intermin&aacute;veis (embora isso ainda aconte&ccedil;a, n&atilde;o nos enganemos), a orquestra&ccedil;&atilde;o &eacute; nosso piloto autom&aacute;tico em meio ao caos. &Eacute; como ter um mordomo digital que:</p><ul class="list" id="-459582987#kbir4g_21" start="1"><li class="list-item" id="-459582987#kbir4g_22"><p id="-459582987#kbir4g_26">Ressuscita containers mortos como um necromante high-tech</p></li><li class="list-item" id="-459582987#kbir4g_23"><p id="-459582987#kbir4g_27">Equilibra carga como um malabarista quantum</p></li><li class="list-item" id="-459582987#kbir4g_24"><p id="-459582987#kbir4g_28">Escala aplica&ccedil;&otilde;es mais r&aacute;pido que fofocas em rede social</p></li><li class="list-item" id="-459582987#kbir4g_25"><p id="-459582987#kbir4g_29">Auto-cura como um Wolverine dos microsservi&ccedil;os</p></li></ul></section><section class="detached"><h3 id="-459582987#principais-orquestradores" data-toc="principais-orquestradores#container-orchestration.md-principais-orquestradores">Principais Orquestradores</h3><p id="-459582987#kbir4g_30">Como num mercado negro de implantes cibern&eacute;ticos, cada orquestrador tem sua especialidade:</p><ul class="list" id="-459582987#kbir4g_31" start="1"><li class="list-item" id="-459582987#kbir4g_32"><p id="-459582987#kbir4g_36">Kubernetes: O tit&atilde; cromado, complexo como um romance russo, mas igualmente recompensador</p></li><li class="list-item" id="-459582987#kbir4g_33"><p id="-459582987#kbir4g_37">Docker Swarm: O irm&atilde;o mais simples, para quando voc&ecirc; n&atilde;o quer um doutorado s&oacute; para fazer deploy</p></li><li class="list-item" id="-459582987#kbir4g_34"><p id="-459582987#kbir4g_38">Apache Mesos: O veterano de guerra, cicatrizes de batalhas corporativas inclu&iacute;das</p></li><li class="list-item" id="-459582987#kbir4g_35"><p id="-459582987#kbir4g_39">Nomad: O infiltrado HashiCorp, minimalista como um apartamento japon&ecirc;s</p></li></ul></section></section><section class="detached"><h2 id="-459582987#kubernetes-o-leviat-digital" data-toc="kubernetes-o-leviat-digital#container-orchestration.md-kubernetes-o-leviat-digital">Kubernetes: O Leviat&atilde; Digital</h2><p id="-459582987#kbir4g_40">Ah, Kubernetes! O leviat&atilde; dos mares digitais, onde cada tent&aacute;culo &eacute; um controller e cada escama um pod. Como um romance de Lovecraft reescrito em YAML, sua complexidade &eacute; tanto seu charme quanto sua maldi&ccedil;&atilde;o.</p><section class="detached"><h3 id="-459582987#o-ciclo-de-vida-uma-trag-dia-em-cinco-atos" data-toc="o-ciclo-de-vida-uma-trag-dia-em-cinco-atos#container-orchestration.md-o-ciclo-de-vida-uma-trag-dia-em-cinco-atos">O Ciclo de Vida: Uma Trag&eacute;dia em Cinco Atos</h3><div class="detached mermaid" id="-459582987#kbir4g_46"><svg aria-roledescription="stateDiagram" role="graphics-document document" viewBox="0 0 469.6796875 460" style="max-width: 469.6796875px;" class="statediagram" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><defs><marker orient="auto" markerUnits="userSpaceOnUse" markerHeight="14" markerWidth="20" refY="7" refX="19" id="mermaid_stateDiagram-barbEnd"><path d="M 19,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_stateDiagram-barbEnd)" style=";fill:none" class="edge-thickness-normal edge-pattern-solid transition" id="edge0" d="M228.969,22L228.969,28.167C228.969,34.333,228.969,46.667,228.969,55.917C228.969,65.167,228.969,71.333,228.969,77.5C228.969,83.667,228.969,89.833,228.969,92.917L228.969,96"></path><path marker-end="url(#mermaid_stateDiagram-barbEnd)" style=";fill:none" class="edge-thickness-normal edge-pattern-solid transition" id="edge1" d="M228.969,136L228.969,142.167C228.969,148.333,228.969,160.667,228.969,169.917C228.969,179.167,228.969,185.333,228.969,191.5C228.969,197.667,228.969,203.833,228.969,206.917L228.969,210"></path><path marker-end="url(#mermaid_stateDiagram-barbEnd)" style=";fill:none" class="edge-thickness-normal edge-pattern-solid transition" id="edge2" d="M191.078,241.302L165.543,248.918C140.008,256.534,88.938,271.767,63.402,282.467C37.867,293.167,37.867,299.333,37.867,305.5C37.867,311.667,37.867,317.833,37.867,320.917L37.867,324"></path><path marker-end="url(#mermaid_stateDiagram-barbEnd)" style=";fill:none" class="edge-thickness-normal edge-pattern-solid transition" id="edge3" d="M206.831,250L200.005,256.167C193.179,262.333,179.527,274.667,172.701,283.917C165.875,293.167,165.875,299.333,165.875,305.5C165.875,311.667,165.875,317.833,165.875,320.917L165.875,324"></path><path marker-end="url(#mermaid_stateDiagram-barbEnd)" style=";fill:none" class="edge-thickness-normal edge-pattern-solid transition" id="edge4" d="M37.867,364L37.867,370.167C37.867,376.333,37.867,388.667,42.72,398.17C47.573,407.672,57.279,414.345,66.985,421.017C76.691,427.69,86.397,434.362,91.25,437.698L96.103,441.034"></path><path marker-end="url(#mermaid_stateDiagram-barbEnd)" style=";fill:none" class="edge-thickness-normal edge-pattern-solid transition" id="edge5" d="M165.875,364L165.875,370.167C165.875,376.333,165.875,388.667,161.022,398.17C156.169,407.672,146.463,414.345,136.757,421.017C127.051,427.69,117.345,434.362,112.492,437.698L107.64,441.034"></path><path marker-end="url(#mermaid_stateDiagram-barbEnd)" style=";fill:none" class="edge-thickness-normal edge-pattern-solid transition" id="edge6" d="M259.457,250L268.857,256.167C278.258,262.333,297.058,274.667,309.305,283.917C321.551,293.167,327.243,299.333,332.934,305.5C338.626,311.667,344.318,317.833,347.163,320.917L350.009,324"></path><path marker-end="url(#mermaid_stateDiagram-barbEnd)" style=";fill:none" class="edge-thickness-normal edge-pattern-solid transition" id="edge7" d="M386.928,324L392.62,317.833C398.311,311.667,409.695,299.333,402.535,289.354C395.375,279.374,369.672,271.747,343.969,264.121C318.266,256.495,292.563,248.869,279.711,245.056L266.859,241.242"></path></g><g class="edgeLabels"><g transform="translate(228.96875, 59)" class="edgeLabel"><g transform="translate(-69.140625, -12)" class="label"><foreignObject height="24" width="138.28125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Nasce a esperana</p></span></div></foreignObject></g></g><g transform="translate(228.96875, 173)" class="edgeLabel"><g transform="translate(-42.375, -12)" class="label"><foreignObject height="24" width="84.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>O despertar</p></span></div></foreignObject></g></g><g transform="translate(37.8671875, 287)" class="edgeLabel"><g transform="translate(-29.453125, -12)" class="label"><foreignObject height="24" width="58.90625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>A queda</p></span></div></foreignObject></g></g><g transform="translate(165.875, 287)" class="edgeLabel"><g transform="translate(-61.5703125, -12)" class="label"><foreignObject height="24" width="123.140625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>A transcendncia</p></span></div></foreignObject></g></g><g transform="translate(37.8671875, 401)" class="edgeLabel"><g transform="translate(-19.171875, -12)" class="label"><foreignObject height="24" width="38.34375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>O fim</p></span></div></foreignObject></g></g><g transform="translate(165.875, 401)" class="edgeLabel"><g transform="translate(-41.484375, -12)" class="label"><foreignObject height="24" width="82.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>A ascenso</p></span></div></foreignObject></g></g><g transform="translate(315.859375, 287)" class="edgeLabel"><g transform="translate(-44.6171875, -12)" class="label"><foreignObject height="24" width="89.234375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>O purgatrio</p></span></div></foreignObject></g></g><g transform="translate(421.078125, 287)" class="edgeLabel"><g transform="translate(-40.6015625, -12)" class="label"><foreignObject height="24" width="81.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>A redeno</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(228.96875, 15)" id="state-root_start-0" class="node default"><circle height="14" width="14" r="7" class="state-start"></circle></g><g transform="translate(228.96875, 116)" id="state-Pending-1" class="node  statediagram-state"><rect height="40" width="74.890625" y="-20" x="-37.4453125" ry="5" data-et="node" data-id="abc" rx="5" style="" class="basic label-container"></rect><g transform="translate(-29.4453125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="58.890625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Pending</p></span></div></foreignObject></g></g><g transform="translate(228.96875, 230)" id="state-Running-7" class="node  statediagram-state"><rect height="40" width="75.78125" y="-20" x="-37.890625" ry="5" data-et="node" data-id="abc" rx="5" style="" class="basic label-container"></rect><g transform="translate(-29.890625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="59.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Running</p></span></div></foreignObject></g></g><g transform="translate(37.8671875, 344)" id="state-Failed-4" class="node  statediagram-state"><rect height="40" width="59.734375" y="-20" x="-29.8671875" ry="5" data-et="node" data-id="abc" rx="5" style="" class="basic label-container"></rect><g transform="translate(-21.8671875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="43.734375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Failed</p></span></div></foreignObject></g></g><g transform="translate(165.875, 344)" id="state-Succeeded-5" class="node  statediagram-state"><rect height="40" width="96.28125" y="-20" x="-48.140625" ry="5" data-et="node" data-id="abc" rx="5" style="" class="basic label-container"></rect><g transform="translate(-40.140625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.28125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Succeeded</p></span></div></foreignObject></g></g><g transform="translate(101.87109375, 445)" id="state-root_end-5" class="node default"><circle height="14" width="14" r="7" class="state-start"></circle><circle height="10" width="10" r="5" class="state-end"></circle></g><g transform="translate(368.46875, 344)" id="state-CrashLoopBackOff-7" class="node  statediagram-state"><rect height="40" width="151.28125" y="-20" x="-75.640625" ry="5" data-et="node" data-id="abc" rx="5" style="" class="basic label-container"></rect><g transform="translate(-67.640625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="135.28125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>CrashLoopBackOff</p></span></div></foreignObject></g></g></g></g></g></svg></div><p id="-459582987#kbir4g_47">Cada pod &eacute; um protagonista em sua pr&oacute;pria novela existencial. Alguns vivem vidas longas e pr&oacute;speras, servindo requests at&eacute; o sunset de sua &uacute;ltima replica. Outros, qual velas ao vento, apagam-se no primeiro sopro de um OOMKilled.</p></section><section class="detached"><h3 id="-459582987#a-hierarquia-do-poder-uma-distopia-corporativa" data-toc="a-hierarquia-do-poder-uma-distopia-corporativa#container-orchestration.md-a-hierarquia-do-poder-uma-distopia-corporativa">A Hierarquia do Poder: Uma Distopia Corporativa</h3><div class="detached code-block" id="-459582987#kbir4g_48"><pre><code class="language-none">
 KUBERNETES HIERARCHY OF NEEDS                          
                                                        
                                            
                    Control                           
                    Plane                             
                                            
                                                       
                        
                               
     Master                      Workers           
     Node                        Nodes             
                               
                                                     
                          
                                                  
                     
 Pods    Pods           Pods       Pods      
                     
</code></pre></div><p id="-459582987#kbir4g_49">O Control Plane, qual CEO de uma megacorpora&ccedil;&atilde;o, comanda seu imp&eacute;rio de microsservi&ccedil;os do alto de sua torre de marfim. Os nodes, trabalhadores incans&aacute;veis, executam suas ordens sem questionar, enquanto pods nascem e morrem ao sabor dos deployments.</p></section><section class="detached"><h3 id="-459582987#a-coreografia-do-caos" data-toc="a-coreografia-do-caos#container-orchestration.md-a-coreografia-do-caos">A Coreografia do Caos</h3><div class="detached mermaid" id="-459582987#kbir4g_50"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1201 728" style="max-width: 1201px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Container" height="65" width="215" stroke="#666" fill="#eaeaea" y="642" x="886"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="674.5" x="993.5"><tspan dy="0" x="993.5">Container (O Condenado)</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Node" height="65" width="161" stroke="#666" fill="#eaeaea" y="642" x="675"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="674.5" x="755.5"><tspan dy="0" x="755.5">Node (O Executor)</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Scheduler" height="65" width="186" stroke="#666" fill="#eaeaea" y="642" x="439"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="674.5" x="532"><tspan dy="0" x="532">Scheduler (O Destino)</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="API" height="65" width="188" stroke="#666" fill="#eaeaea" y="642" x="201"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="674.5" x="295"><tspan dy="0" x="295">API Server (O Orculo)</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="User" height="65" width="150" stroke="#666" fill="#eaeaea" y="642" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="674.5" x="75"><tspan dy="0" x="75">Usurio Mortal</tspan></text></g><g><line name="Container" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="642" x2="993.5" y1="5" x1="993.5" id="actor34"></line><g id="root-34"><rect class="actor actor-top" ry="3" rx="3" name="Container" height="65" width="215" stroke="#666" fill="#eaeaea" y="0" x="886"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="993.5"><tspan dy="0" x="993.5">Container (O Condenado)</tspan></text></g></g><g><line name="Node" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="642" x2="755.5" y1="5" x1="755.5" id="actor33"></line><g id="root-33"><rect class="actor actor-top" ry="3" rx="3" name="Node" height="65" width="161" stroke="#666" fill="#eaeaea" y="0" x="675"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="755.5"><tspan dy="0" x="755.5">Node (O Executor)</tspan></text></g></g><g><line name="Scheduler" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="642" x2="532" y1="5" x1="532" id="actor32"></line><g id="root-32"><rect class="actor actor-top" ry="3" rx="3" name="Scheduler" height="65" width="186" stroke="#666" fill="#eaeaea" y="0" x="439"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="532"><tspan dy="0" x="532">Scheduler (O Destino)</tspan></text></g></g><g><line name="API" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="642" x2="295" y1="5" x1="295" id="actor31"></line><g id="root-31"><rect class="actor actor-top" ry="3" rx="3" name="API" height="65" width="188" stroke="#666" fill="#eaeaea" y="0" x="201"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="295"><tspan dy="0" x="295">API Server (O Orculo)</tspan></text></g></g><g><line name="User" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="642" x2="75" y1="5" x1="75" id="actor30"></line><g id="root-30"><rect class="actor actor-top" ry="3" rx="3" name="User" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Usurio Mortal</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="37" width="215" stroke="#666" fill="#EDF2AE" y="363" x="886"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="368" x="994"><tspan x="994">A vida  um loop infinito...</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="184">Implora por um Pod</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="291" y1="113" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="412">Consulta o destino</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="161" x2="528" y1="161" x1="296"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="176" x="642">Designa a sentena</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="209" x2="751.5" y1="209" x1="533"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="224" x="873">Materializa o sonho</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="257" x2="989.5" y1="257" x1="756.5"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="272" x="876">Respira vida</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="305" x2="759.5" y1="305" x1="992.5"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="320" x="527">Proclama existncia</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="353" x2="299" y1="353" x1="754.5"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="415" x="995">Falha health check</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 994.5,448 C 1054.5,438 1054.5,478 994.5,468"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="493" x="876">Agoniza</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="526" x2="759.5" y1="526" x1="992.5"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="541" x="527">Reporta a tragdia</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="574" x2="299" y1="574" x1="754.5"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="589" x="524">Ordena ressurreio</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="622" x2="751.5" y1="622" x1="296"></line></svg></div></section><section class="detached"><h3 id="-459582987#componentes-b-sicos" data-toc="componentes-b-sicos#container-orchestration.md-componentes-b-sicos">Componentes B&aacute;sicos</h3><p id="-459582987#kbir4g_51">Como uma corpora&ccedil;&atilde;o megacapitalista dist&oacute;pica, K8s tem sua pr&oacute;pria hierarquia:</p><ul class="list" id="-459582987#kbir4g_52" start="1"><li class="list-item" id="-459582987#kbir4g_53"><p id="-459582987#kbir4g_58">Control Plane: O conselho diretor do seu datacenter, tomando decis&otilde;es que afetam a vida de milhares de containers</p></li><li class="list-item" id="-459582987#kbir4g_54"><p id="-459582987#kbir4g_59">Nodes: Trabalhadores incans&aacute;veis, como replicantes em uma linha de montagem digital</p></li><li class="list-item" id="-459582987#kbir4g_55"><p id="-459582987#kbir4g_60">Pods: Pequenos apartamentos compartilhados onde containers vivem em harmonia (ou n&atilde;o)</p></li><li class="list-item" id="-459582987#kbir4g_56"><p id="-459582987#kbir4g_61">Services: O sistema de metr&ocirc; do seu cluster - conectando pods como esta&ccedil;&otilde;es em uma malha neon</p></li><li class="list-item" id="-459582987#kbir4g_57"><p id="-459582987#kbir4g_62">Deployments: Manifestos digitais que descrevem seu mundo ideal (que nunca existe exatamente como planejado)</p></li></ul></section><section class="detached"><h3 id="-459582987#arquitetura" data-toc="arquitetura#container-orchestration.md-arquitetura">Arquitetura</h3><ul class="list" id="-459582987#kbir4g_63" start="1"><li class="list-item" id="-459582987#kbir4g_64"><p id="-459582987#kbir4g_70">API Server: O c&eacute;rebro do sistema, onde todas as decis&otilde;es s&atilde;o tomadas</p></li><li class="list-item" id="-459582987#kbir4g_65"><p id="-459582987#kbir4g_71">Scheduler: O gerente de recursos, como um diretor de orquestra</p></li><li class="list-item" id="-459582987#kbir4g_66"><p id="-459582987#kbir4g_72">Controller Manager: O executivo, garantindo que tudo esteja no lugar certo</p></li><li class="list-item" id="-459582987#kbir4g_67"><p id="-459582987#kbir4g_73">etcd: O banco de dados, armazenando o estado do cluster</p></li><li class="list-item" id="-459582987#kbir4g_68"><p id="-459582987#kbir4g_74">kubelet: O agente de cada n&oacute;, como um agente de seguran&ccedil;a</p></li><li class="list-item" id="-459582987#kbir4g_69"><p id="-459582987#kbir4g_75">kube-proxy: O roteador, como um detetive de tr&aacute;fego</p></li></ul></section></section><section class="detached"><h2 id="-459582987#docker-swarm-a-colmeia-digital" data-toc="docker-swarm-a-colmeia-digital#container-orchestration.md-docker-swarm-a-colmeia-digital">Docker Swarm: A Colmeia Digital</h2><p id="-459582987#kbir4g_76">Enquanto Kubernetes &eacute; o leviat&atilde; dos mares profundos, Swarm &eacute; a colmeia no jardim dos fundos - menor, mais simples, mas n&atilde;o menos fascinante em sua complexidade organizada.</p><div class="detached code-block" id="-459582987#kbir4g_77"><pre><code class="language-none">
 SWARM ARCHITECTURE                                    
                                                       
    Manager Nodes                                      
                                    
  LeadMgr Mgr                               
                                    
                                                    
                     
                                                      
  Worker Nodes                                        
                       
  Wrk1Wrk2Wrk3Wrk4Wrk5             
                       
</code></pre></div><section class="detached"><h3 id="-459582987#conceitos-b-sicos" data-toc="conceitos-b-sicos#container-orchestration.md-conceitos-b-sicos">Conceitos B&aacute;sicos</h3><ul class="list" id="-459582987#kbir4g_80" start="1"><li class="list-item" id="-459582987#kbir4g_81"><p id="-459582987#kbir4g_85">Nodes</p></li><li class="list-item" id="-459582987#kbir4g_82"><p id="-459582987#kbir4g_86">Services</p></li><li class="list-item" id="-459582987#kbir4g_83"><p id="-459582987#kbir4g_87">Tasks</p></li><li class="list-item" id="-459582987#kbir4g_84"><p id="-459582987#kbir4g_88">Stacks</p></li></ul></section><section class="detached"><h3 id="-459582987#comandos-essenciais" data-toc="comandos-essenciais#container-orchestration.md-comandos-essenciais">Comandos Essenciais</h3><div class="detached code-block" id="-459582987#kbir4g_89"><pre><code class="language-bash"># Inicializar swarm
docker swarm init

# Criar servio
docker service create --name web nginx

# Escalar servio
docker service scale web=3</code></pre></div></section></section><section class="detached"><h2 id="-459582987#comparativo-de-orquestradores" data-toc="comparativo-de-orquestradores#container-orchestration.md-comparativo-de-orquestradores">Comparativo de Orquestradores</h2><section class="detached"><h3 id="-459582987#kubernetes-vs-swarm" data-toc="kubernetes-vs-swarm#container-orchestration.md-kubernetes-vs-swarm">Kubernetes vs Swarm</h3><div class="table-wrapper detached"><table id="-459582987#kbir4g_91"><tr class="header-row" id="-459582987#kbir4g_92"><th id="-459582987#kbir4g_97"><p>Aspecto</p></th><th id="-459582987#kbir4g_98"><p>Kubernetes</p></th><th id="-459582987#kbir4g_99"><p>Swarm</p></th></tr><tr class="" id="-459582987#kbir4g_93"><td id="-459582987#kbir4g_100"><p>Complexidade</p></td><td id="-459582987#kbir4g_101"><p>Alta</p></td><td id="-459582987#kbir4g_102"><p>Baixa</p></td></tr><tr class="" id="-459582987#kbir4g_94"><td id="-459582987#kbir4g_103"><p>Escalabilidade</p></td><td id="-459582987#kbir4g_104"><p>Muito Alta</p></td><td id="-459582987#kbir4g_105"><p>Moderada</p></td></tr><tr class="" id="-459582987#kbir4g_95"><td id="-459582987#kbir4g_106"><p>Curva de Aprendizado</p></td><td id="-459582987#kbir4g_107"><p>&Iacute;ngreme</p></td><td id="-459582987#kbir4g_108"><p>Suave</p></td></tr><tr class="" id="-459582987#kbir4g_96"><td id="-459582987#kbir4g_109"><p>Recursos</p></td><td id="-459582987#kbir4g_110"><p>Abundantes</p></td><td id="-459582987#kbir4g_111"><p>B&aacute;sicos</p></td></tr></table></div></section></section><section class="detached"><h2 id="-459582987#melhores-pr-ticas" data-toc="melhores-pr-ticas#container-orchestration.md-melhores-pr-ticas">Melhores Pr&aacute;ticas</h2><section class="detached"><h3 id="-459582987#planejamento" data-toc="planejamento#container-orchestration.md-planejamento">Planejamento</h3><ul class="list" id="-459582987#kbir4g_114" start="1"><li class="list-item" id="-459582987#kbir4g_115"><p id="-459582987#kbir4g_119">Arquitetura distribu&iacute;da</p></li><li class="list-item" id="-459582987#kbir4g_116"><p id="-459582987#kbir4g_120">Estrat&eacute;gia de deployment</p></li><li class="list-item" id="-459582987#kbir4g_117"><p id="-459582987#kbir4g_121">Pol&iacute;tica de recursos</p></li><li class="list-item" id="-459582987#kbir4g_118"><p id="-459582987#kbir4g_122">Monitoramento</p></li></ul></section><section class="detached"><h3 id="-459582987#seguran-a" data-toc="seguran-a#container-orchestration.md-seguran-a">Seguran&ccedil;a</h3><ul class="list" id="-459582987#kbir4g_123" start="1"><li class="list-item" id="-459582987#kbir4g_124"><p id="-459582987#kbir4g_128">RBAC</p></li><li class="list-item" id="-459582987#kbir4g_125"><p id="-459582987#kbir4g_129">Network Policies</p></li><li class="list-item" id="-459582987#kbir4g_126"><p id="-459582987#kbir4g_130">Secrets Management</p></li><li class="list-item" id="-459582987#kbir4g_127"><p id="-459582987#kbir4g_131">Container Security</p></li></ul></section></section><section class="detached"><h2 id="-459582987#troubleshooting" data-toc="troubleshooting#container-orchestration.md-troubleshooting">Troubleshooting</h2><section class="detached"><h3 id="-459582987#problemas-comuns" data-toc="problemas-comuns#container-orchestration.md-problemas-comuns">Problemas Comuns</h3><ul class="list" id="-459582987#kbir4g_134" start="1"><li class="list-item" id="-459582987#kbir4g_135"><p id="-459582987#kbir4g_139">Node failures</p></li><li class="list-item" id="-459582987#kbir4g_136"><p id="-459582987#kbir4g_140">Network issues</p></li><li class="list-item" id="-459582987#kbir4g_137"><p id="-459582987#kbir4g_141">Resource constraints</p></li><li class="list-item" id="-459582987#kbir4g_138"><p id="-459582987#kbir4g_142">Configuration errors</p></li></ul></section><section class="detached"><h3 id="-459582987#ferramentas-de-debug" data-toc="ferramentas-de-debug#container-orchestration.md-ferramentas-de-debug">Ferramentas de Debug</h3><ul class="list" id="-459582987#kbir4g_143" start="1"><li class="list-item" id="-459582987#kbir4g_144"><p id="-459582987#kbir4g_148">Logs centralizados</p></li><li class="list-item" id="-459582987#kbir4g_145"><p id="-459582987#kbir4g_149">M&eacute;tricas</p></li><li class="list-item" id="-459582987#kbir4g_146"><p id="-459582987#kbir4g_150">Tracing</p></li><li class="list-item" id="-459582987#kbir4g_147"><p id="-459582987#kbir4g_151">Health checks</p></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1175689492">Container Monitoring: Os Olhos do Sistema <span class="no-bold"></span></h1><div class="detached code-block" id="1175689492#ftmln5_3"><pre><code class="language-none">
 MONITORING MATRIX                            
                                              
            
    Mtricas  Alerting  Action  
            
                                           
                                           
            
     Logging  Analysis  Report  
            
</code></pre></div><section class="detached"><h2 id="1175689492#m-tricas-essenciais" data-toc="m-tricas-essenciais#container-monitoring.md-m-tricas-essenciais">M&eacute;tricas Essenciais <span class="no-bold"></span></h2><section class="detached"><h3 id="1175689492#container-health" data-toc="container-health#container-monitoring.md-container-health">Container Health</h3><div class="detached code-block" id="1175689492#ftmln5_13"><pre><code class="language-bash"># CPU Usage
docker stats --format &quot;table {{.Container}}\t{{.CPUPerc}}&quot;

# Memory Consumption
docker stats --format &quot;table {{.Container}}\t{{.MemUsage}}&quot;

# I/O Operations
docker stats --format &quot;table {{.Container}}\t{{.BlockIO}}&quot;

# Detailed Stats
docker stats --no-stream --format \
  &quot;table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}\t{{.NetIO}}\t{{.BlockIO}}&quot;</code></pre></div></section><section class="detached"><h3 id="1175689492#advanced-metrics-collection" data-toc="advanced-metrics-collection#container-monitoring.md-advanced-metrics-collection">Advanced Metrics Collection</h3><section class="detached"><h4 id="1175689492#cadvisor-integration" data-toc="cadvisor-integration#container-monitoring.md-cadvisor-integration">cAdvisor Integration</h4><div class="detached code-block" id="1175689492#ftmln5_16"><pre><code class="language-yaml">version: '3'
services:
  cadvisor:
    image: gcr.io/cadvisor/cadvisor:v0.47.0
    container_name: cadvisor
    privileged: true
    devices:
      - /dev/kmsg:/dev/kmsg
    volumes:
      - /:/rootfs:ro
      - /var/run:/var/run:ro
      - /sys:/sys:ro
      - /var/lib/docker/:/var/lib/docker:ro
      - /dev/disk/:/dev/disk:ro
    ports:
      - &quot;8080:8080&quot;</code></pre></div></section><section class="detached"><h4 id="1175689492#node-exporter-setup" data-toc="node-exporter-setup#container-monitoring.md-node-exporter-setup">Node Exporter Setup</h4><div class="detached code-block" id="1175689492#ftmln5_17"><pre><code class="language-yaml">version: '3'
services:
  node-exporter:
    image: prom/node-exporter:latest
    container_name: node-exporter
    command:
      - '--path.procfs=/host/proc'
      - '--path.rootfs=/rootfs'
      - '--path.sysfs=/host/sys'
      - '--collector.filesystem.mount-points-exclude=^/(sys|proc|dev|host|etc)($$|/)'
    volumes:
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /:/rootfs:ro
    ports:
      - &quot;9100:9100&quot;</code></pre></div></section></section></section><section class="detached"><h2 id="1175689492#observability-stack" data-toc="observability-stack#container-monitoring.md-observability-stack">Observability Stack <span class="no-bold"></span></h2><section class="detached"><h3 id="1175689492#prometheus-advanced-configuration" data-toc="prometheus-advanced-configuration#container-monitoring.md-prometheus-advanced-configuration">Prometheus Advanced Configuration</h3><div class="detached code-block" id="1175689492#ftmln5_20"><pre><code class="language-yaml">global:
  scrape_interval: 15s
  evaluation_interval: 15s

rule_files:
  - &quot;alert.rules&quot;

scrape_configs:
  - job_name: 'containers'
    static_configs:
      - targets: ['localhost:9090']
    metrics_path: '/metrics'
    relabel_configs:
      - source_labels: [__meta_docker_container_name]
        target_label: container_name
      - source_labels: [__meta_docker_container_label_com_docker_compose_service]
        target_label: service_name

  - job_name: 'cadvisor'
    static_configs:
      - targets: ['cadvisor:8080']

  - job_name: 'node-exporter'
    static_configs:
      - targets: ['node-exporter:9100']</code></pre></div></section><section class="detached"><h3 id="1175689492#grafana-dashboards" data-toc="grafana-dashboards#container-monitoring.md-grafana-dashboards">Grafana Dashboards</h3><section class="detached"><h4 id="1175689492#container-overview" data-toc="container-overview#container-monitoring.md-container-overview">Container Overview</h4><div class="detached code-block" id="1175689492#ftmln5_22"><pre><code class="language-json">{
  &quot;dashboard&quot;: {
    &quot;panels&quot;: [
      {
        &quot;title&quot;: &quot;CPU Usage&quot;,
        &quot;type&quot;: &quot;graph&quot;,
        &quot;targets&quot;: [
          {
            &quot;expr&quot;: &quot;rate(container_cpu_usage_seconds_total{name=~\&quot;$container\&quot;}[1m])&quot;,
            &quot;legendFormat&quot;: &quot;{{name}}&quot;
          }
        ]
      },
      {
        &quot;title&quot;: &quot;Memory Usage&quot;,
        &quot;type&quot;: &quot;graph&quot;,
        &quot;targets&quot;: [
          {
            &quot;expr&quot;: &quot;container_memory_usage_bytes{name=~\&quot;$container\&quot;}&quot;,
            &quot;legendFormat&quot;: &quot;{{name}}&quot;
          }
        ]
      }
    ]
  }
}</code></pre></div></section></section></section><section class="detached"><h2 id="1175689492#advanced-logging-architecture" data-toc="advanced-logging-architecture#container-monitoring.md-advanced-logging-architecture">Advanced Logging Architecture <span class="no-bold"></span></h2><section class="detached"><h3 id="1175689492#fluentd-configuration" data-toc="fluentd-configuration#container-monitoring.md-fluentd-configuration">Fluentd Configuration</h3><div class="detached code-block" id="1175689492#ftmln5_25"><pre><code class="language-markup">&lt;source&gt;
  @type forward
  port 24224
  bind 0.0.0.0
&lt;/source&gt;

&lt;filter docker.**&gt;
  @type parser
  format json
  key_name log
  reserve_data true
&lt;/filter&gt;

&lt;match docker.**&gt;
  @type elasticsearch
  host elasticsearch
  port 9200
  logstash_format true
  logstash_prefix docker
  include_tag_key true
&lt;/match&gt;</code></pre></div></section><section class="detached"><h3 id="1175689492#vector-pipeline" data-toc="vector-pipeline#container-monitoring.md-vector-pipeline">Vector Pipeline</h3><div class="detached code-block" id="1175689492#ftmln5_26"><pre><code class="language-toml">[sources.docker_logs]
type = &quot;docker_logs&quot;
include_containers = [&quot;app*&quot;, &quot;web*&quot;]

[transforms.parse_json]
type = &quot;remap&quot;
inputs = [&quot;docker_logs&quot;]
source = '''
. = parse_json!(.message)
'''

[sinks.elasticsearch]
type = &quot;elasticsearch&quot;
inputs = [&quot;parse_json&quot;]
endpoint = &quot;http://elasticsearch:9200&quot;
index = &quot;logs-%Y-%m-%d&quot;</code></pre></div></section></section><section class="detached"><h2 id="1175689492#distributed-tracing" data-toc="distributed-tracing#container-monitoring.md-distributed-tracing">Distributed Tracing <span class="no-bold"></span></h2><section class="detached"><h3 id="1175689492#jaeger-configuration" data-toc="jaeger-configuration#container-monitoring.md-jaeger-configuration">Jaeger Configuration</h3><div class="detached code-block" id="1175689492#ftmln5_29"><pre><code class="language-yaml">version: '3'
services:
  jaeger:
    image: jaegertracing/all-in-one:latest
    ports:
      - &quot;5775:5775/udp&quot;
      - &quot;6831:6831/udp&quot;
      - &quot;6832:6832/udp&quot;
      - &quot;5778:5778&quot;
      - &quot;16686:16686&quot;
      - &quot;14250:14250&quot;
      - &quot;14268:14268&quot;
      - &quot;14269:14269&quot;
      - &quot;9411:9411&quot;</code></pre></div></section><section class="detached"><h3 id="1175689492#opentelemetry-integration" data-toc="opentelemetry-integration#container-monitoring.md-opentelemetry-integration">OpenTelemetry Integration</h3><div class="detached code-block" id="1175689492#ftmln5_30"><pre><code class="language-yaml">receivers:
  otlp:
    protocols:
      grpc:
        endpoint: 0.0.0.0:4317
      http:
        endpoint: 0.0.0.0:4318

processors:
  batch:
    timeout: 1s
    send_batch_size: 1024

exporters:
  jaeger:
    endpoint: jaeger:14250
    tls:
      insecure: true

service:
  pipelines:
    traces:
      receivers: [otlp]
      processors: [batch]
      exporters: [jaeger]</code></pre></div></section></section><section class="detached"><h2 id="1175689492#advanced-alerting-strategies" data-toc="advanced-alerting-strategies#container-monitoring.md-advanced-alerting-strategies">Advanced Alerting Strategies <span class="no-bold"></span></h2><section class="detached"><h3 id="1175689492#alert-manager-configuration" data-toc="alert-manager-configuration#container-monitoring.md-alert-manager-configuration">Alert Manager Configuration</h3><div class="detached code-block" id="1175689492#ftmln5_33"><pre><code class="language-yaml">global:
  resolve_timeout: 5m
  slack_api_url: 'https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK'

route:
  group_by: ['alertname', 'cluster', 'service']
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 4h
  receiver: 'slack-notifications'

receivers:
- name: 'slack-notifications'
  slack_configs:
  - channel: '#monitoring'
    title: &quot;{{ range .Alerts }}{{ .Annotations.summary }}\n{{ end }}&quot;
    text: &quot;{{ range .Alerts }}{{ .Annotations.description }}\n{{ end }}&quot;</code></pre></div></section><section class="detached"><h3 id="1175689492#pagerduty-integration" data-toc="pagerduty-integration#container-monitoring.md-pagerduty-integration">PagerDuty Integration</h3><div class="detached code-block" id="1175689492#ftmln5_34"><pre><code class="language-yaml">receivers:
- name: 'pagerduty-critical'
  pagerduty_configs:
  - service_key: '&lt;your-pagerduty-key&gt;'
    severity: 'critical'
    description: '{{ template &quot;pagerduty.default.description&quot; . }}'
    client: 'monitoring-system'
    client_url: '{{ template &quot;pagerduty.default.clientURL&quot; . }}'</code></pre></div></section></section><section class="detached"><h2 id="1175689492#performance-optimization" data-toc="performance-optimization#container-monitoring.md-performance-optimization">Performance Optimization <span class="no-bold"></span></h2><section class="detached"><h3 id="1175689492#resource-quotas" data-toc="resource-quotas#container-monitoring.md-resource-quotas">Resource Quotas</h3><div class="detached code-block" id="1175689492#ftmln5_37"><pre><code class="language-yaml">apiVersion: v1
kind: ResourceQuota
metadata:
  name: compute-resources
spec:
  hard:
    requests.cpu: &quot;4&quot;
    requests.memory: 8Gi
    limits.cpu: &quot;8&quot;
    limits.memory: 16Gi</code></pre></div></section><section class="detached"><h3 id="1175689492#monitoring-best-practices" data-toc="monitoring-best-practices#container-monitoring.md-monitoring-best-practices">Monitoring Best Practices</h3><section class="detached"><h4 id="1175689492#retention-policies" data-toc="retention-policies#container-monitoring.md-retention-policies">Retention Policies</h4><div class="detached code-block" id="1175689492#ftmln5_40"><pre><code class="language-sql">CREATE RETENTION POLICY &quot;one_month&quot;
ON &quot;docker_metrics&quot;
DURATION 30d
REPLICATION 1
DEFAULT</code></pre></div></section><section class="detached"><h4 id="1175689492#downsampling" data-toc="downsampling#container-monitoring.md-downsampling">Downsampling</h4><div class="detached code-block" id="1175689492#ftmln5_41"><pre><code class="language-sql">SELECT mean(&quot;value&quot;)
FROM &quot;cpu_usage&quot;
WHERE time &gt; now() - 7d
GROUP BY time(1h)</code></pre></div></section></section></section><section class="detached"><h2 id="1175689492#troubleshooting-guide" data-toc="troubleshooting-guide#container-monitoring.md-troubleshooting-guide">Troubleshooting Guide <span class="no-bold"></span></h2><section class="detached"><h3 id="1175689492#common-scenarios-matrix" data-toc="common-scenarios-matrix#container-monitoring.md-common-scenarios-matrix">Common Scenarios Matrix</h3><div class="table-wrapper detached"><table id="1175689492#ftmln5_44"><tr class="header-row" id="1175689492#ftmln5_45"><th id="1175689492#ftmln5_50"><p>Cen&aacute;rio</p></th><th id="1175689492#ftmln5_51"><p>Sintomas</p></th><th id="1175689492#ftmln5_52"><p>M&eacute;tricas Chave</p></th><th id="1175689492#ftmln5_53"><p>A&ccedil;&atilde;o Corretiva</p></th></tr><tr class="" id="1175689492#ftmln5_46"><td id="1175689492#ftmln5_54"><p>Memory Leak</p></td><td id="1175689492#ftmln5_55"><p>Crescimento constante de mem&oacute;ria</p></td><td id="1175689492#ftmln5_56"><p>container_memory_usage_bytes</p></td><td id="1175689492#ftmln5_57"><p>Heap dump e an&aacute;lise</p></td></tr><tr class="" id="1175689492#ftmln5_47"><td id="1175689492#ftmln5_58"><p>Network Bottleneck</p></td><td id="1175689492#ftmln5_59"><p>Lat&ecirc;ncia alta</p></td><td id="1175689492#ftmln5_60"><p>container_network_transmit_bytes_total</p></td><td id="1175689492#ftmln5_61"><p>Network trace</p></td></tr><tr class="" id="1175689492#ftmln5_48"><td id="1175689492#ftmln5_62"><p>Disk I/O</p></td><td id="1175689492#ftmln5_63"><p>Tempo de resposta alto</p></td><td id="1175689492#ftmln5_64"><p>container_fs_writes_bytes_total</p></td><td id="1175689492#ftmln5_65"><p>iostat an&aacute;lise</p></td></tr><tr class="" id="1175689492#ftmln5_49"><td id="1175689492#ftmln5_66"><p>CPU Throttling</p></td><td id="1175689492#ftmln5_67"><p>Performance degradada</p></td><td id="1175689492#ftmln5_68"><p>container_cpu_cfs_throttled_seconds_total</p></td><td id="1175689492#ftmln5_69"><p>Profile CPU</p></td></tr></table></div></section><section class="detached"><h3 id="1175689492#debug-toolkit" data-toc="debug-toolkit#container-monitoring.md-debug-toolkit">Debug Toolkit</h3><div class="detached code-block" id="1175689492#ftmln5_70"><pre><code class="language-bash"># Container Process Tree
pstree -p $(docker inspect -f '{{.State.Pid}}' container_id)

# Network Connections
nsenter -t $(docker inspect -f '{{.State.Pid}}' container_id) -n netstat -tupn

# File System Usage
docker run --rm -v /:/host:ro alpine:latest df -h /host

# Stack Trace
docker exec container_id jstack $(pgrep java)</code></pre></div><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1175689492#ftmln5_74"><span class="control" id="1175689492#ftmln5_75">Monitor-chan diz:</span> &quot;M&eacute;tricas s&atilde;o como batimentos card&iacute;acos do sistema - monitore-os ou enfrente o flatline! uwu&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1175689492#ftmln5_76"><span class="control" id="1175689492#ftmln5_77">Alert-sama avisa:</span> &quot;Um alerta ignorado hoje &eacute; um incidente cr&iacute;tico amanh&atilde;! Nya~&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1175689492#ftmln5_78"><span class="control" id="1175689492#ftmln5_79">Trace-senpai sugere:</span> &quot;Distributed tracing &eacute; como seguir pegadas digitais no cyberspa&ccedil;o! owo&quot;</p></div>
</blockquote>
</section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-796822905">Images vs Containers: O Dual Boot do Futuro <span class="no-bold"></span></h1><div class="detached code-block" id="-796822905#-relx4y_3"><pre><code class="language-none">
 IMAGES VS CONTAINERS MATRIX                                       
                                                                  
                                          
     Images   docker run Containers              
                                          
    Blueprint                           Running Instance          
                                                                 
</code></pre></div><section class="detached"><h2 id="-796822905#o-que-voc-vai-aprender" data-toc="o-que-voc-vai-aprender#images-containers.md-o-que-voc-vai-aprender">O que voc&ecirc; vai aprender <span class="no-bold"></span></h2><p id="-796822905#-relx4y_10">Neste m&oacute;dulo, voc&ecirc; mergulhar&aacute; no universo das imagens e containers Docker, entendendo:</p><ul class="list" id="-796822905#-relx4y_11" start="1"><li class="list-item" id="-796822905#-relx4y_12"><p id="-796822905#-relx4y_17">A diferen&ccedil;a fundamental entre imagens e containers</p></li><li class="list-item" id="-796822905#-relx4y_13"><p id="-796822905#-relx4y_18">Como imagens funcionam como blueprints para containers</p></li><li class="list-item" id="-796822905#-relx4y_14"><p id="-796822905#-relx4y_19">O ciclo de vida de containers</p></li><li class="list-item" id="-796822905#-relx4y_15"><p id="-796822905#-relx4y_20">Gerenciamento b&aacute;sico de imagens e containers</p></li><li class="list-item" id="-796822905#-relx4y_16"><p id="-796822905#-relx4y_21">Melhores pr&aacute;ticas e padr&otilde;es comuns</p></li></ul></section><section class="detached"><h2 id="-796822905#a-dualidade-fundamental" data-toc="a-dualidade-fundamental#images-containers.md-a-dualidade-fundamental">A Dualidade Fundamental <span class="no-bold"></span></h2><section class="detached"><h3 id="-796822905#imagens-o-blueprint-imut-vel" data-toc="imagens-o-blueprint-imut-vel#images-containers.md-imagens-o-blueprint-imut-vel">Imagens: O Blueprint Imut&aacute;vel</h3><p id="-796822905#-relx4y_24">Imagens Docker s&atilde;o como plantas arquitet&ocirc;nicas digitais - templates read-only que cont&ecirc;m:</p><ul class="list" id="-796822905#-relx4y_25" start="1"><li class="list-item" id="-796822905#-relx4y_26"><p id="-796822905#-relx4y_30">Sistema operacional base</p></li><li class="list-item" id="-796822905#-relx4y_27"><p id="-796822905#-relx4y_31">Depend&ecirc;ncias</p></li><li class="list-item" id="-796822905#-relx4y_28"><p id="-796822905#-relx4y_32">Configura&ccedil;&otilde;es</p></li><li class="list-item" id="-796822905#-relx4y_29"><p id="-796822905#-relx4y_33">C&oacute;digo da aplica&ccedil;&atilde;o</p></li></ul></section><section class="detached"><h3 id="-796822905#containers-a-inst-ncia-viva" data-toc="containers-a-inst-ncia-viva#images-containers.md-containers-a-inst-ncia-viva">Containers: A Inst&acirc;ncia Viva</h3><p id="-796822905#-relx4y_34">Containers s&atilde;o inst&acirc;ncias em execu&ccedil;&atilde;o de uma imagem, como um pr&eacute;dio constru&iacute;do a partir de uma planta:</p><ul class="list" id="-796822905#-relx4y_35" start="1"><li class="list-item" id="-796822905#-relx4y_36"><p id="-796822905#-relx4y_40">Ambiente isolado e execut&aacute;vel</p></li><li class="list-item" id="-796822905#-relx4y_37"><p id="-796822905#-relx4y_41">Estado mut&aacute;vel</p></li><li class="list-item" id="-796822905#-relx4y_38"><p id="-796822905#-relx4y_42">Processos em execu&ccedil;&atilde;o</p></li><li class="list-item" id="-796822905#-relx4y_39"><p id="-796822905#-relx4y_43">Recursos computacionais alocados</p></li></ul></section></section><section class="detached"><h2 id="-796822905#analogia-matrix" data-toc="analogia-matrix#images-containers.md-analogia-matrix">Analogia Matrix <span class="no-bold"></span></h2><div class="detached code-block" id="-796822905#-relx4y_44"><pre><code class="language-none">
 IMAGEM                          CONTAINER                      
                                                
 - Blueprint                     - Instncia em execuo        
 - Imutvel                      - Mutvel                      
 - Template                      - Processo vivo                
 - Compartilhvel               - Isolado                      
 - Armazenada em disco          - Executa em memria           
</code></pre></div></section><section class="detached"><h2 id="-796822905#roadmap-de-aprendizado" data-toc="roadmap-de-aprendizado#images-containers.md-roadmap-de-aprendizado">Roadmap de Aprendizado <span class="no-bold"></span></h2><ol class="list list-decimal" id="-796822905#-relx4y_45" type="1" start="1"><li class="list-item" id="-796822905#-relx4y_46"><p id="-796822905#-relx4y_53">Fundamentos de Imagens (<a href="#902649088">Fundamentos de Imagens Docker </a>)</p><ul class="list" id="-796822905#-relx4y_54" start="1"><li class="list-item" id="-796822905#-relx4y_56"><p id="-796822905#-relx4y_59">Conceitos b&aacute;sicos</p></li><li class="list-item" id="-796822905#-relx4y_57"><p id="-796822905#-relx4y_60">Componentes principais</p></li><li class="list-item" id="-796822905#-relx4y_58"><p id="-796822905#-relx4y_61">Caracter&iacute;sticas essenciais</p></li></ul></li><li class="list-item" id="-796822905#-relx4y_47"><p id="-796822905#-relx4y_62">Anatomia de uma Imagem (<a href="#1554569929">Anatomia de uma Imagem Docker </a>)</p><ul class="list" id="-796822905#-relx4y_63" start="1"><li class="list-item" id="-796822905#-relx4y_65"><p id="-796822905#-relx4y_68">Sistema de layers</p></li><li class="list-item" id="-796822905#-relx4y_66"><p id="-796822905#-relx4y_69">Manifests e configura&ccedil;&otilde;es</p></li><li class="list-item" id="-796822905#-relx4y_67"><p id="-796822905#-relx4y_70">Formato e especifica&ccedil;&otilde;es</p></li></ul></li><li class="list-item" id="-796822905#-relx4y_48"><p id="-796822905#-relx4y_71">Gerenciamento de Imagens (<a href="#486630389">Gerenciamento de Imagens Docker </a>)</p><ul class="list" id="-796822905#-relx4y_72" start="1"><li class="list-item" id="-796822905#-relx4y_74"><p id="-796822905#-relx4y_77">Comandos b&aacute;sicos</p></li><li class="list-item" id="-796822905#-relx4y_75"><p id="-796822905#-relx4y_78">Tags e versionamento</p></li><li class="list-item" id="-796822905#-relx4y_76"><p id="-796822905#-relx4y_79">Registries e distribui&ccedil;&atilde;o</p></li></ul></li><li class="list-item" id="-796822905#-relx4y_49"><p id="-796822905#-relx4y_80">Opera&ccedil;&otilde;es com Containers (<a href="#-672215880">Opera&ccedil;&otilde;es com Containers: O Manual do Operador </a>)</p><ul class="list" id="-796822905#-relx4y_81" start="1"><li class="list-item" id="-796822905#-relx4y_83"><p id="-796822905#-relx4y_86">Ciclo de vida</p></li><li class="list-item" id="-796822905#-relx4y_84"><p id="-796822905#-relx4y_87">Comandos essenciais</p></li><li class="list-item" id="-796822905#-relx4y_85"><p id="-796822905#-relx4y_88">Estados e transi&ccedil;&otilde;es</p></li></ul></li><li class="list-item" id="-796822905#-relx4y_50"><p id="-796822905#-relx4y_89">Melhores Pr&aacute;ticas (<a href="#1223070191">Melhores Pr&aacute;ticas Docker: O Caminho do Mestre </a>)</p><ul class="list" id="-796822905#-relx4y_90" start="1"><li class="list-item" id="-796822905#-relx4y_92"><p id="-796822905#-relx4y_95">Guidelines de seguran&ccedil;a</p></li><li class="list-item" id="-796822905#-relx4y_93"><p id="-796822905#-relx4y_96">Otimiza&ccedil;&otilde;es</p></li><li class="list-item" id="-796822905#-relx4y_94"><p id="-796822905#-relx4y_97">Padr&otilde;es recomendados</p></li></ul></li><li class="list-item" id="-796822905#-relx4y_51"><p id="-796822905#-relx4y_98">Laborat&oacute;rio Pr&aacute;tico (<a href="#659198120">Laborat&oacute;rio Pr&aacute;tico: M&atilde;o na Massa! </a>)</p><ul class="list" id="-796822905#-relx4y_99" start="1"><li class="list-item" id="-796822905#-relx4y_101"><p id="-796822905#-relx4y_104">Exerc&iacute;cios guiados</p></li><li class="list-item" id="-796822905#-relx4y_102"><p id="-796822905#-relx4y_105">Casos de uso reais</p></li><li class="list-item" id="-796822905#-relx4y_103"><p id="-796822905#-relx4y_106">Desafios pr&aacute;ticos</p></li></ul></li><li class="list-item" id="-796822905#-relx4y_52"><p id="-796822905#-relx4y_107">Guia de Troubleshooting (<a href="#1568904649">Guia de Troubleshooting: Debugando na Matrix </a>)</p><ul class="list" id="-796822905#-relx4y_108" start="1"><li class="list-item" id="-796822905#-relx4y_110"><p id="-796822905#-relx4y_113">Problemas comuns</p></li><li class="list-item" id="-796822905#-relx4y_111"><p id="-796822905#-relx4y_114">Solu&ccedil;&otilde;es</p></li><li class="list-item" id="-796822905#-relx4y_112"><p id="-796822905#-relx4y_115">Debugging</p></li></ul></li></ol></section><section class="detached"><h2 id="-796822905#quick-start" data-toc="quick-start#images-containers.md-quick-start">Quick Start <span class="no-bold"></span></h2><div class="detached code-block" id="-796822905#-relx4y_116"><pre><code class="language-bash"># Baixar uma imagem
docker pull nginx:latest

# Criar e executar um container
docker run -d -p 80:80 nginx:latest

# Listar containers em execuo
docker ps

# Parar o container
docker stop &lt;container-id&gt;</code></pre></div><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-796822905#-relx4y_119"><span class="control" id="-796822905#-relx4y_120">Image-chan diz:</span> &quot;Pense em mim como seu template perfeito - imut&aacute;vel e confi&aacute;vel! uwu&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-796822905#-relx4y_121"><span class="control" id="-796822905#-relx4y_122">Container-kun avisa:</span> &quot;E eu sou a manifesta&ccedil;&atilde;o viva do seu c&oacute;digo - ativo e din&acirc;mico! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="-796822905#pr-ximos-passos" data-toc="pr-ximos-passos#images-containers.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><p id="-796822905#-relx4y_123">Explore cada subt&oacute;pico na ordem sugerida para uma jornada de aprendizado estruturada. Comece com os Fundamentos de Imagens (<a href="#902649088">Fundamentos de Imagens Docker </a>) para construir uma base s&oacute;lida.</p><blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-796822905#-relx4y_126"><span class="control" id="-796822905#-relx4y_127">Sensei's Corner:</span> &quot;A jornada de mil containers come&ccedil;a com uma &uacute;nica imagem!&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="902649088">Fundamentos de Imagens Docker <span class="no-bold"></span></h1><div class="detached code-block" id="902649088#z61lqxx_3"><pre><code class="language-none">
 IMAGE FUNDAMENTALS MATRIX                                        
                                                                  
                               
      Layer    Layer    Layer                   
                               
                                                              
    Base Image     Dependencies      App Code                    
                                                                
</code></pre></div><section class="detached"><h2 id="902649088#conceitos-fundamentais" data-toc="conceitos-fundamentais#image-fundamentals.md-conceitos-fundamentais">Conceitos Fundamentais <span class="no-bold"></span></h2><section class="detached"><h3 id="902649088#o-que-uma-imagem-docker" data-toc="o-que-uma-imagem-docker#image-fundamentals.md-o-que-uma-imagem-docker">O que &eacute; uma Imagem Docker?</h3><p id="902649088#z61lqxx_15">Uma imagem Docker &eacute; um pacote leve, aut&ocirc;nomo e execut&aacute;vel que inclui tudo necess&aacute;rio para rodar uma aplica&ccedil;&atilde;o:</p><ul class="list" id="902649088#z61lqxx_16" start="1"><li class="list-item" id="902649088#z61lqxx_17"><p id="902649088#z61lqxx_22">C&oacute;digo</p></li><li class="list-item" id="902649088#z61lqxx_18"><p id="902649088#z61lqxx_23">Runtime</p></li><li class="list-item" id="902649088#z61lqxx_19"><p id="902649088#z61lqxx_24">Bibliotecas</p></li><li class="list-item" id="902649088#z61lqxx_20"><p id="902649088#z61lqxx_25">Vari&aacute;veis de ambiente</p></li><li class="list-item" id="902649088#z61lqxx_21"><p id="902649088#z61lqxx_26">Arquivos de configura&ccedil;&atilde;o</p></li></ul></section><section class="detached"><h3 id="902649088#caracter-sticas-principais" data-toc="caracter-sticas-principais#image-fundamentals.md-caracter-sticas-principais">Caracter&iacute;sticas Principais <span class="no-bold"></span></h3><div class="detached code-block" id="902649088#z61lqxx_27"><pre><code class="language-none">
 CARACTERSTICAS ESSENCIAIS                                 

  Imutabilidade                                           
  Sistema de Camadas                                      
  Compartilhamento de Recursos                            
  Portabilidade                                           
  Versionamento                                           
</code></pre></div></section></section><section class="detached"><h2 id="902649088#anatomia-de-uma-imagem" data-toc="anatomia-de-uma-imagem#image-fundamentals.md-anatomia-de-uma-imagem">Anatomia de uma Imagem <span class="no-bold"></span></h2><section class="detached"><h3 id="902649088#sistema-de-camadas" data-toc="sistema-de-camadas#image-fundamentals.md-sistema-de-camadas">Sistema de Camadas</h3><ol class="list list-decimal" id="902649088#z61lqxx_29" type="1" start="1"><li class="list-item" id="902649088#z61lqxx_30"><p id="902649088#z61lqxx_33"><span class="control" id="902649088#z61lqxx_35">Base Layer</span></p><ul class="list" id="902649088#z61lqxx_34" start="1"><li class="list-item" id="902649088#z61lqxx_36"><p id="902649088#z61lqxx_38">Sistema operacional m&iacute;nimo</p></li><li class="list-item" id="902649088#z61lqxx_37"><p id="902649088#z61lqxx_39">Bibliotecas essenciais</p></li></ul></li><li class="list-item" id="902649088#z61lqxx_31"><p id="902649088#z61lqxx_40"><span class="control" id="902649088#z61lqxx_42">Camadas Intermedi&aacute;rias</span></p><ul class="list" id="902649088#z61lqxx_41" start="1"><li class="list-item" id="902649088#z61lqxx_43"><p id="902649088#z61lqxx_46">Depend&ecirc;ncias</p></li><li class="list-item" id="902649088#z61lqxx_44"><p id="902649088#z61lqxx_47">Ferramentas</p></li><li class="list-item" id="902649088#z61lqxx_45"><p id="902649088#z61lqxx_48">Configura&ccedil;&otilde;es</p></li></ul></li><li class="list-item" id="902649088#z61lqxx_32"><p id="902649088#z61lqxx_49"><span class="control" id="902649088#z61lqxx_51">Camada de Aplica&ccedil;&atilde;o</span></p><ul class="list" id="902649088#z61lqxx_50" start="1"><li class="list-item" id="902649088#z61lqxx_52"><p id="902649088#z61lqxx_55">C&oacute;digo fonte</p></li><li class="list-item" id="902649088#z61lqxx_53"><p id="902649088#z61lqxx_56">Assets</p></li><li class="list-item" id="902649088#z61lqxx_54"><p id="902649088#z61lqxx_57">Configura&ccedil;&otilde;es espec&iacute;ficas</p></li></ul></li></ol></section></section><section class="detached"><h2 id="902649088#tipos-de-imagens" data-toc="tipos-de-imagens#image-fundamentals.md-tipos-de-imagens">Tipos de Imagens <span class="no-bold"></span></h2><section class="detached"><h3 id="902649088#1-imagens-base" data-toc="1-imagens-base#image-fundamentals.md-1-imagens-base">1. Imagens Base</h3><ul class="list" id="902649088#z61lqxx_61" start="1"><li class="list-item" id="902649088#z61lqxx_62"><p id="902649088#z61lqxx_66">Alpine</p></li><li class="list-item" id="902649088#z61lqxx_63"><p id="902649088#z61lqxx_67">Ubuntu</p></li><li class="list-item" id="902649088#z61lqxx_64"><p id="902649088#z61lqxx_68">Debian</p></li><li class="list-item" id="902649088#z61lqxx_65"><p id="902649088#z61lqxx_69">Scratch</p></li></ul></section><section class="detached"><h3 id="902649088#2-imagens-de-runtime" data-toc="2-imagens-de-runtime#image-fundamentals.md-2-imagens-de-runtime">2. Imagens de Runtime</h3><ul class="list" id="902649088#z61lqxx_70" start="1"><li class="list-item" id="902649088#z61lqxx_71"><p id="902649088#z61lqxx_75">Node.js</p></li><li class="list-item" id="902649088#z61lqxx_72"><p id="902649088#z61lqxx_76">Python</p></li><li class="list-item" id="902649088#z61lqxx_73"><p id="902649088#z61lqxx_77">Java</p></li><li class="list-item" id="902649088#z61lqxx_74"><p id="902649088#z61lqxx_78">Go</p></li></ul></section><section class="detached"><h3 id="902649088#3-imagens-de-aplica-o" data-toc="3-imagens-de-aplica-o#image-fundamentals.md-3-imagens-de-aplica-o">3. Imagens de Aplica&ccedil;&atilde;o</h3><ul class="list" id="902649088#z61lqxx_79" start="1"><li class="list-item" id="902649088#z61lqxx_80"><p id="902649088#z61lqxx_84">Nginx</p></li><li class="list-item" id="902649088#z61lqxx_81"><p id="902649088#z61lqxx_85">MongoDB</p></li><li class="list-item" id="902649088#z61lqxx_82"><p id="902649088#z61lqxx_86">Redis</p></li><li class="list-item" id="902649088#z61lqxx_83"><p id="902649088#z61lqxx_87">PostgreSQL</p></li></ul></section></section><section class="detached"><h2 id="902649088#nomenclatura-e-tags" data-toc="nomenclatura-e-tags#image-fundamentals.md-nomenclatura-e-tags">Nomenclatura e Tags <span class="no-bold"></span></h2><div class="detached code-block" id="902649088#z61lqxx_88"><pre><code class="language-none">
 ANATOMIA DE UM NOME DE IMAGEM                             
                                                           
  registry.example.com/organization/image-name:tag         
   Registry   Owner   Name   Tag      
                                                           
</code></pre></div><section class="detached"><h3 id="902649088#conven-es-de-tags" data-toc="conven-es-de-tags#image-fundamentals.md-conven-es-de-tags">Conven&ccedil;&otilde;es de Tags</h3><ul class="list" id="902649088#z61lqxx_90" start="1"><li class="list-item" id="902649088#z61lqxx_91"><p id="902649088#z61lqxx_95"><span class="inline-code" id="902649088#z61lqxx_96">latest</span>: vers&atilde;o mais recente</p></li><li class="list-item" id="902649088#z61lqxx_92"><p id="902649088#z61lqxx_97"><span class="inline-code" id="902649088#z61lqxx_98">1.0.0</span>: vers&atilde;o espec&iacute;fica</p></li><li class="list-item" id="902649088#z61lqxx_93"><p id="902649088#z61lqxx_99"><span class="inline-code" id="902649088#z61lqxx_100">stable</span>: vers&atilde;o est&aacute;vel</p></li><li class="list-item" id="902649088#z61lqxx_94"><p id="902649088#z61lqxx_101"><span class="inline-code" id="902649088#z61lqxx_102">alpine</span>: baseada em Alpine Linux</p></li></ul></section></section><section class="detached"><h2 id="902649088#comandos-essenciais" data-toc="comandos-essenciais#image-fundamentals.md-comandos-essenciais">Comandos Essenciais <span class="no-bold"></span></h2><div class="detached code-block" id="902649088#z61lqxx_103"><pre><code class="language-bash"># Listar imagens locais
docker images

# Baixar uma imagem
docker pull nginx:latest

# Inspecionar uma imagem
docker inspect nginx:latest

# Remover uma imagem
docker rmi nginx:latest

# Mostrar histrico de camadas
docker history nginx:latest</code></pre></div></section><section class="detached"><h2 id="902649088#boas-pr-ticas" data-toc="boas-pr-ticas#image-fundamentals.md-boas-pr-ticas">Boas Pr&aacute;ticas <span class="no-bold"></span></h2><section class="detached"><h3 id="902649088#do-s" data-toc="do-s#image-fundamentals.md-do-s">DO's <span class="no-bold"></span></h3><ul class="list" id="902649088#z61lqxx_106" start="1"><li class="list-item" id="902649088#z61lqxx_107"><p id="902649088#z61lqxx_112">Use tags espec&iacute;ficas</p></li><li class="list-item" id="902649088#z61lqxx_108"><p id="902649088#z61lqxx_113">Minimize o tamanho das imagens</p></li><li class="list-item" id="902649088#z61lqxx_109"><p id="902649088#z61lqxx_114">Documente depend&ecirc;ncias</p></li><li class="list-item" id="902649088#z61lqxx_110"><p id="902649088#z61lqxx_115">Utilize multi-stage builds</p></li><li class="list-item" id="902649088#z61lqxx_111"><p id="902649088#z61lqxx_116">Mantenha imagens atualizadas</p></li></ul></section><section class="detached"><h3 id="902649088#don-ts" data-toc="don-ts#image-fundamentals.md-don-ts">DON'Ts <span class="no-bold"></span></h3><ul class="list" id="902649088#z61lqxx_117" start="1"><li class="list-item" id="902649088#z61lqxx_118"><p id="902649088#z61lqxx_123">Evite <span class="inline-code" id="902649088#z61lqxx_124">latest</span> em produ&ccedil;&atilde;o</p></li><li class="list-item" id="902649088#z61lqxx_119"><p id="902649088#z61lqxx_125">N&atilde;o armazene secrets</p></li><li class="list-item" id="902649088#z61lqxx_120"><p id="902649088#z61lqxx_126">N&atilde;o instale ferramentas desnecess&aacute;rias</p></li><li class="list-item" id="902649088#z61lqxx_121"><p id="902649088#z61lqxx_127">N&atilde;o use imagens n&atilde;o oficiais sem verifica&ccedil;&atilde;o</p></li><li class="list-item" id="902649088#z61lqxx_122"><p id="902649088#z61lqxx_128">N&atilde;o ignore vulnerabilidades</p></li></ul></section></section><section class="detached"><h2 id="902649088#waifu-tips" data-toc="waifu-tips#image-fundamentals.md-waifu-tips">Waifu Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="902649088#z61lqxx_131"><span class="control" id="902649088#z61lqxx_132">Image-chan diz:</span> &quot;Mantenha suas camadas organizadas como um bento box perfeito! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="902649088#z61lqxx_133"><span class="control" id="902649088#z61lqxx_134">Security-chan avisa:</span> &quot;Sempre verifique a origem das suas imagens base! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="902649088#pr-ximos-passos" data-toc="pr-ximos-passos#image-fundamentals.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="902649088#z61lqxx_135" type="1" start="1"><li class="list-item" id="902649088#z61lqxx_136"><p id="902649088#z61lqxx_139">Anatomia de uma Imagem (<a href="#1554569929">Anatomia de uma Imagem Docker </a>)</p></li><li class="list-item" id="902649088#z61lqxx_137"><p id="902649088#z61lqxx_141">Gerenciamento de Imagens (<a href="#486630389">Gerenciamento de Imagens Docker </a>)</p></li><li class="list-item" id="902649088#z61lqxx_138"><p id="902649088#z61lqxx_143">Melhores Pr&aacute;ticas (<a href="#1223070191">Melhores Pr&aacute;ticas Docker: O Caminho do Mestre </a>)</p></li></ol></section><section class="detached"><h2 id="902649088#checkpoint" data-toc="checkpoint#image-fundamentals.md-checkpoint">Checkpoint <span class="no-bold"></span></h2><p id="902649088#z61lqxx_145">Voc&ecirc; agora entende:</p><ul class="list" id="902649088#z61lqxx_146" start="1"><li class="list-item" id="902649088#z61lqxx_148"><p id="902649088#z61lqxx_154">[x] O que s&atilde;o imagens Docker</p></li><li class="list-item" id="902649088#z61lqxx_149"><p id="902649088#z61lqxx_155">[x] Sistema de camadas</p></li><li class="list-item" id="902649088#z61lqxx_150"><p id="902649088#z61lqxx_156">[x] Tipos de imagens</p></li><li class="list-item" id="902649088#z61lqxx_151"><p id="902649088#z61lqxx_157">[x] Nomenclatura e tags</p></li><li class="list-item" id="902649088#z61lqxx_152"><p id="902649088#z61lqxx_158">[x] Comandos b&aacute;sicos</p></li><li class="list-item" id="902649088#z61lqxx_153"><p id="902649088#z61lqxx_159">[x] Boas pr&aacute;ticas</p></li></ul><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="902649088#z61lqxx_160"><span class="control" id="902649088#z61lqxx_161">Sensei's Corner:</span> &quot;Uma imagem bem constru&iacute;da &eacute; como um kata bem executado - precisa, eficiente e elegante.&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1554569929">Anatomia de uma Imagem Docker <span class="no-bold"></span></h1><p id="1554569929#-8qipok_3">Uma imagem Docker &eacute; composta por v&aacute;rias camadas sobrepostas que formam um sistema de arquivos unificado. Vamos dissecar cada componente.</p><section class="detached"><h2 id="1554569929#vis-o-geral-da-estrutura" data-toc="vis-o-geral-da-estrutura#image-anatomy.md-vis-o-geral-da-estrutura">Vis&atilde;o Geral da Estrutura</h2><div class="detached code-block" id="1554569929#-8qipok_12"><pre><code class="language-none">
 IMAGE ANATOMY MATRIX                                             
                                                                  
                                                  
       Config                                                  
                                                  
                                                                 
                                  
      Manifest     Metadata                            
                                  
                                                                 
                                                  
       Layers                                                  
                                                  
                                                                 
</code></pre></div></section><section class="detached"><h2 id="1554569929#1-arquivo-de-configura-o" data-toc="1-arquivo-de-configura-o#image-anatomy.md-1-arquivo-de-configura-o">1. Arquivo de Configura&ccedil;&atilde;o</h2><p id="1554569929#-8qipok_13">O arquivo de configura&ccedil;&atilde;o &eacute; um documento JSON que define o comportamento da imagem.</p><section class="detached"><h3 id="1554569929#componentes-principais" data-toc="componentes-principais#image-anatomy.md-componentes-principais">Componentes Principais</h3><div class="detached code-block" id="1554569929#-8qipok_16"><pre><code class="language-json">{
  &quot;config&quot;: {
    &quot;Hostname&quot;: &quot;&quot;,
    &quot;Domainname&quot;: &quot;&quot;,
    &quot;User&quot;: &quot;&quot;,
    &quot;ExposedPorts&quot;: {
      &quot;80/tcp&quot;: {}
    },
    &quot;Env&quot;: [
      &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;
    ],
    &quot;Cmd&quot;: [
      &quot;nginx&quot;,
      &quot;-g&quot;,
      &quot;daemon off;&quot;
    ],
    &quot;WorkingDir&quot;: &quot;/&quot;,
    &quot;Volumes&quot;: null
  }
}</code></pre></div></section><section class="detached"><h3 id="1554569929#elementos-essenciais" data-toc="elementos-essenciais#image-anatomy.md-elementos-essenciais">Elementos Essenciais</h3><ul class="list" id="1554569929#-8qipok_17" start="1"><li class="list-item" id="1554569929#-8qipok_18"><p id="1554569929#-8qipok_23"><span class="inline-code" id="1554569929#-8qipok_24">ExposedPorts</span>: Portas que o container exp&otilde;e</p></li><li class="list-item" id="1554569929#-8qipok_19"><p id="1554569929#-8qipok_25"><span class="inline-code" id="1554569929#-8qipok_26">Env</span>: Vari&aacute;veis de ambiente padr&atilde;o</p></li><li class="list-item" id="1554569929#-8qipok_20"><p id="1554569929#-8qipok_27"><span class="inline-code" id="1554569929#-8qipok_28">Cmd</span>: Comando padr&atilde;o executado no container</p></li><li class="list-item" id="1554569929#-8qipok_21"><p id="1554569929#-8qipok_29"><span class="inline-code" id="1554569929#-8qipok_30">WorkingDir</span>: Diret&oacute;rio de trabalho inicial</p></li><li class="list-item" id="1554569929#-8qipok_22"><p id="1554569929#-8qipok_31"><span class="inline-code" id="1554569929#-8qipok_32">User</span>: Usu&aacute;rio padr&atilde;o do container</p></li></ul></section></section><section class="detached"><h2 id="1554569929#2-manifesto-da-imagem" data-toc="2-manifesto-da-imagem#image-anatomy.md-2-manifesto-da-imagem">2. Manifesto da Imagem</h2><p id="1554569929#-8qipok_33">O manifesto &eacute; um documento JSON que descreve a composi&ccedil;&atilde;o da imagem.</p><section class="detached"><h3 id="1554569929#estrutura-do-manifesto" data-toc="estrutura-do-manifesto#image-anatomy.md-estrutura-do-manifesto">Estrutura do Manifesto</h3><div class="detached code-block" id="1554569929#-8qipok_36"><pre><code class="language-json">{
  &quot;schemaVersion&quot;: 2,
  &quot;mediaType&quot;: &quot;application/vnd.docker.distribution.manifest.v2+json&quot;,
  &quot;config&quot;: {
    &quot;mediaType&quot;: &quot;application/vnd.docker.container.image.v1+json&quot;,
    &quot;size&quot;: 1234,
    &quot;digest&quot;: &quot;sha256:a1b2c3...&quot;
  },
  &quot;layers&quot;: [
    {
      &quot;mediaType&quot;: &quot;application/vnd.docker.image.rootfs.diff.tar.gzip&quot;,
      &quot;size&quot;: 5678,
      &quot;digest&quot;: &quot;sha256:d4e5f6...&quot;
    }
  ]
}</code></pre></div></section><section class="detached"><h3 id="1554569929#elementos-do-manifesto" data-toc="elementos-do-manifesto#image-anatomy.md-elementos-do-manifesto">Elementos do Manifesto</h3><ul class="list" id="1554569929#-8qipok_37" start="1"><li class="list-item" id="1554569929#-8qipok_38"><p id="1554569929#-8qipok_42"><span class="inline-code" id="1554569929#-8qipok_43">schemaVersion</span>: Vers&atilde;o do formato do manifesto</p></li><li class="list-item" id="1554569929#-8qipok_39"><p id="1554569929#-8qipok_44"><span class="inline-code" id="1554569929#-8qipok_45">config</span>: Refer&ecirc;ncia ao arquivo de configura&ccedil;&atilde;o</p></li><li class="list-item" id="1554569929#-8qipok_40"><p id="1554569929#-8qipok_46"><span class="inline-code" id="1554569929#-8qipok_47">layers</span>: Lista de camadas que comp&otilde;em a imagem</p></li><li class="list-item" id="1554569929#-8qipok_41"><p id="1554569929#-8qipok_48"><span class="inline-code" id="1554569929#-8qipok_49">digest</span>: Hash SHA256 &uacute;nico da camada</p></li></ul></section></section><section class="detached"><h2 id="1554569929#3-sistema-de-camadas" data-toc="3-sistema-de-camadas#image-anatomy.md-3-sistema-de-camadas">3. Sistema de Camadas</h2><p id="1554569929#-8qipok_50">As camadas s&atilde;o organizadas em uma estrutura de pilha, onde cada camada representa uma modifica&ccedil;&atilde;o no sistema de arquivos.</p><div class="detached code-block" id="1554569929#-8qipok_51"><pre><code class="language-none">
 LAYER STACK                                                
                                                           
                                     
    App Layer         &lt;- Cdigo da aplicao             
                                     
    Dependencies      &lt;- Bibliotecas e deps              
                                     
    Runtime           &lt;- Ambiente de execuo            
                                     
    Base OS           &lt;- Sistema operacional base        
                                     
                                                           
</code></pre></div><section class="detached"><h3 id="1554569929#caracter-sticas-das-camadas" data-toc="caracter-sticas-das-camadas#image-anatomy.md-caracter-sticas-das-camadas">Caracter&iacute;sticas das Camadas</h3><section class="detached"><h4 id="1554569929#camadas-read-only" data-toc="camadas-read-only#image-anatomy.md-camadas-read-only">Camadas Read-Only</h4><ul class="list" id="1554569929#-8qipok_55" start="1"><li class="list-item" id="1554569929#-8qipok_56"><p id="1554569929#-8qipok_59">Imut&aacute;veis ap&oacute;s cria&ccedil;&atilde;o</p></li><li class="list-item" id="1554569929#-8qipok_57"><p id="1554569929#-8qipok_60">Compartilhadas entre containers</p></li><li class="list-item" id="1554569929#-8qipok_58"><p id="1554569929#-8qipok_61">Armazenadas em cache localmente</p></li></ul></section><section class="detached"><h4 id="1554569929#camada-read-write" data-toc="camada-read-write#image-anatomy.md-camada-read-write">Camada Read-Write</h4><ul class="list" id="1554569929#-8qipok_62" start="1"><li class="list-item" id="1554569929#-8qipok_63"><p id="1554569929#-8qipok_66">Criada ao iniciar um container</p></li><li class="list-item" id="1554569929#-8qipok_64"><p id="1554569929#-8qipok_67">Espec&iacute;fica para cada container</p></li><li class="list-item" id="1554569929#-8qipok_65"><p id="1554569929#-8qipok_68">Cont&eacute;m todas as altera&ccedil;&otilde;es em runtime</p></li></ul></section></section></section><section class="detached"><h2 id="1554569929#4-sistema-de-arquivos-union" data-toc="4-sistema-de-arquivos-union#image-anatomy.md-4-sistema-de-arquivos-union">4. Sistema de Arquivos Union</h2><p id="1554569929#-8qipok_69">O Docker utiliza um sistema de arquivos em camadas que combina todas as camadas em uma &uacute;nica vis&atilde;o.</p><div class="detached code-block" id="1554569929#-8qipok_70"><pre><code class="language-none">
 UNION FILESYSTEM                                           
                                                           
 /container                                                
    /bin                                              
    /etc                                              
    /lib    Unio de todas as camadas                
    /usr                                              
    /var                                              
                                                           
</code></pre></div><section class="detached"><h3 id="1554569929#funcionamento" data-toc="funcionamento#image-anatomy.md-funcionamento">Funcionamento</h3><ol class="list list-decimal" id="1554569929#-8qipok_72" type="1" start="1"><li class="list-item" id="1554569929#-8qipok_73"><p id="1554569929#-8qipok_77">Cada camada representa um conjunto de diferen&ccedil;as</p></li><li class="list-item" id="1554569929#-8qipok_74"><p id="1554569929#-8qipok_78">As camadas s&atilde;o montadas sobrepostas</p></li><li class="list-item" id="1554569929#-8qipok_75"><p id="1554569929#-8qipok_79">Arquivos mais recentes t&ecirc;m preced&ecirc;ncia</p></li><li class="list-item" id="1554569929#-8qipok_76"><p id="1554569929#-8qipok_80">Dele&ccedil;&otilde;es s&atilde;o marcadas com whiteouts</p></li></ol></section></section><section class="detached"><h2 id="1554569929#5-comandos-de-inspe-o" data-toc="5-comandos-de-inspe-o#image-anatomy.md-5-comandos-de-inspe-o">5. Comandos de Inspe&ccedil;&atilde;o</h2><section class="detached"><h3 id="1554569929#an-lise-de-imagens" data-toc="an-lise-de-imagens#image-anatomy.md-an-lise-de-imagens">An&aacute;lise de Imagens</h3><div class="detached code-block" id="1554569929#-8qipok_82"><pre><code class="language-bash"># Metadata da imagem
docker inspect nginx:latest

# Histrico de camadas
docker history nginx:latest

# Digest da imagem
docker images --digests nginx

# Exportar imagem
docker save nginx:latest &gt; nginx.tar</code></pre></div></section></section><section class="detached"><h2 id="1554569929#waifu-tips" data-toc="waifu-tips#image-anatomy.md-waifu-tips">Waifu Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1554569929#-8qipok_85"><span class="control" id="1554569929#-8qipok_86">Layer-chan diz:</span> &quot;Cada camada &eacute; como um cap&iacute;tulo da hist&oacute;ria do seu container. Mantenha-a interessante, mas concisa! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1554569929#-8qipok_87"><span class="control" id="1554569929#-8qipok_88">Storage-chan avisa:</span> &quot;Cuidado com o copy-on-write! Muitas escritas podem impactar a performance! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="1554569929#pr-ximos-passos" data-toc="pr-ximos-passos#image-anatomy.md-pr-ximos-passos">Pr&oacute;ximos Passos</h2><ol class="list list-decimal" id="1554569929#-8qipok_89" type="1" start="1"><li class="list-item" id="1554569929#-8qipok_90"><p id="1554569929#-8qipok_93">Gerenciamento de Imagens (<a href="#486630389">Gerenciamento de Imagens Docker </a>)</p></li><li class="list-item" id="1554569929#-8qipok_91"><p id="1554569929#-8qipok_95">Opera&ccedil;&otilde;es com Containers (<a href="#-672215880">Opera&ccedil;&otilde;es com Containers: O Manual do Operador </a>)</p></li><li class="list-item" id="1554569929#-8qipok_92"><p id="1554569929#-8qipok_97">Melhores Pr&aacute;ticas (<a href="#1223070191">Melhores Pr&aacute;ticas Docker: O Caminho do Mestre </a>)</p></li></ol></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="486630389">Gerenciamento de Imagens Docker <span class="no-bold"></span></h1><div class="detached code-block" id="486630389#-h91tc_3"><pre><code class="language-none">
 IMAGE MANAGEMENT MATRIX                                          
                                                                  
                               
      Pull     Tag      Push                    
                               
                                                              
                                
                                                                
</code></pre></div><section class="detached"><h2 id="486630389#comandos-essenciais" data-toc="comandos-essenciais#image-management.md-comandos-essenciais">Comandos Essenciais <span class="no-bold"></span></h2><section class="detached"><h3 id="486630389#gerenciamento-b-sico" data-toc="gerenciamento-b-sico#image-management.md-gerenciamento-b-sico">Gerenciamento B&aacute;sico</h3><div class="detached code-block" id="486630389#-h91tc_15"><pre><code class="language-bash"># Listar imagens
docker images

# Baixar imagem
docker pull nginx:latest

# Remover imagem
docker rmi nginx:latest

# Remover todas imagens no utilizadas
docker image prune</code></pre></div></section><section class="detached"><h3 id="486630389#tagging-e-versionamento" data-toc="tagging-e-versionamento#image-management.md-tagging-e-versionamento">Tagging e Versionamento</h3><div class="detached code-block" id="486630389#-h91tc_16"><pre><code class="language-bash"># Criar tag
docker tag nginx:latest meu-registry.com/nginx:v1.0

# Remover tag
docker rmi meu-registry.com/nginx:v1.0

# Listar tags de uma imagem
docker image inspect nginx --format='{{.RepoTags}}'</code></pre></div></section></section><section class="detached"><h2 id="486630389#sistema-de-tags" data-toc="sistema-de-tags#image-management.md-sistema-de-tags">Sistema de Tags <span class="no-bold"></span></h2><div class="detached code-block" id="486630389#-h91tc_17"><pre><code class="language-none">
 TAG CONVENTIONS                                            
                                                           
  registry.example.com/org/app:1.0.0-alpine               
   Registry   Name   Tag   Variant     
                                                           
</code></pre></div><section class="detached"><h3 id="486630389#conven-es-comuns" data-toc="conven-es-comuns#image-management.md-conven-es-comuns">Conven&ccedil;&otilde;es Comuns</h3><ul class="list" id="486630389#-h91tc_19" start="1"><li class="list-item" id="486630389#-h91tc_20"><p id="486630389#-h91tc_25"><span class="inline-code" id="486630389#-h91tc_26">latest</span>: vers&atilde;o mais recente</p></li><li class="list-item" id="486630389#-h91tc_21"><p id="486630389#-h91tc_27"><span class="inline-code" id="486630389#-h91tc_28">1.0.0</span>: vers&atilde;o sem&acirc;ntica</p></li><li class="list-item" id="486630389#-h91tc_22"><p id="486630389#-h91tc_29"><span class="inline-code" id="486630389#-h91tc_30">stable</span>: vers&atilde;o est&aacute;vel</p></li><li class="list-item" id="486630389#-h91tc_23"><p id="486630389#-h91tc_31"><span class="inline-code" id="486630389#-h91tc_32">dev</span>: vers&atilde;o desenvolvimento</p></li><li class="list-item" id="486630389#-h91tc_24"><p id="486630389#-h91tc_33"><span class="inline-code" id="486630389#-h91tc_34">alpine</span>: variante espec&iacute;fica</p></li></ul></section></section><section class="detached"><h2 id="486630389#registries-e-distribui-o" data-toc="registries-e-distribui-o#image-management.md-registries-e-distribui-o">Registries e Distribui&ccedil;&atilde;o <span class="no-bold"></span></h2><section class="detached"><h3 id="486630389#docker-hub" data-toc="docker-hub#image-management.md-docker-hub">Docker Hub</h3><div class="detached code-block" id="486630389#-h91tc_37"><pre><code class="language-bash"># Login no Docker Hub
docker login

# Push para Docker Hub
docker push username/app:tag

# Pull do Docker Hub
docker pull username/app:tag</code></pre></div></section><section class="detached"><h3 id="486630389#registry-privado" data-toc="registry-privado#image-management.md-registry-privado">Registry Privado</h3><div class="detached code-block" id="486630389#-h91tc_38"><pre><code class="language-bash"># Login em registry privado
docker login meu-registry.com

# Push para registry privado
docker push meu-registry.com/app:tag

# Pull de registry privado
docker pull meu-registry.com/app:tag</code></pre></div></section></section><section class="detached"><h2 id="486630389#otimiza-o-e-limpeza" data-toc="otimiza-o-e-limpeza#image-management.md-otimiza-o-e-limpeza">Otimiza&ccedil;&atilde;o e Limpeza <span class="no-bold"></span></h2><section class="detached"><h3 id="486630389#limpeza-de-sistema" data-toc="limpeza-de-sistema#image-management.md-limpeza-de-sistema">Limpeza de Sistema</h3><div class="detached code-block" id="486630389#-h91tc_41"><pre><code class="language-bash"># Remover imagens no utilizadas
docker image prune -a

# Remover imagens dangling
docker image prune

# Limpar todo o sistema
docker system prune</code></pre></div></section><section class="detached"><h3 id="486630389#otimiza-o-de-espa-o" data-toc="otimiza-o-de-espa-o#image-management.md-otimiza-o-de-espa-o">Otimiza&ccedil;&atilde;o de Espa&ccedil;o</h3><div class="detached code-block" id="486630389#-h91tc_42"><pre><code class="language-bash"># Verificar uso de espao
docker system df

# Anlise detalhada
docker system df -v</code></pre></div></section></section><section class="detached"><h2 id="486630389#boas-pr-ticas" data-toc="boas-pr-ticas#image-management.md-boas-pr-ticas">Boas Pr&aacute;ticas <span class="no-bold"></span></h2><section class="detached"><h3 id="486630389#do-s" data-toc="do-s#image-management.md-do-s">DO's <span class="no-bold"></span></h3><ul class="list" id="486630389#-h91tc_45" start="1"><li class="list-item" id="486630389#-h91tc_46"><p id="486630389#-h91tc_51">Use tags espec&iacute;ficas em produ&ccedil;&atilde;o</p></li><li class="list-item" id="486630389#-h91tc_47"><p id="486630389#-h91tc_52">Mantenha um registro de vers&otilde;es</p></li><li class="list-item" id="486630389#-h91tc_48"><p id="486630389#-h91tc_53">Documente variantes de imagens</p></li><li class="list-item" id="486630389#-h91tc_49"><p id="486630389#-h91tc_54">Implemente pol&iacute;tica de reten&ccedil;&atilde;o</p></li><li class="list-item" id="486630389#-h91tc_50"><p id="486630389#-h91tc_55">Automatize o processo de build/push</p></li></ul></section><section class="detached"><h3 id="486630389#don-ts" data-toc="don-ts#image-management.md-don-ts">DON'Ts <span class="no-bold"></span></h3><ul class="list" id="486630389#-h91tc_56" start="1"><li class="list-item" id="486630389#-h91tc_57"><p id="486630389#-h91tc_62">Evite usar <span class="inline-code" id="486630389#-h91tc_63">latest</span> em produ&ccedil;&atilde;o</p></li><li class="list-item" id="486630389#-h91tc_58"><p id="486630389#-h91tc_64">N&atilde;o acumule imagens antigas</p></li><li class="list-item" id="486630389#-h91tc_59"><p id="486630389#-h91tc_65">N&atilde;o armazene dados sens&iacute;veis</p></li><li class="list-item" id="486630389#-h91tc_60"><p id="486630389#-h91tc_66">N&atilde;o ignore vulnerabilidades</p></li><li class="list-item" id="486630389#-h91tc_61"><p id="486630389#-h91tc_67">N&atilde;o deixe imagens sem tag</p></li></ul></section></section><section class="detached"><h2 id="486630389#automa-o-e-ci-cd" data-toc="automa-o-e-ci-cd#image-management.md-automa-o-e-ci-cd">Automa&ccedil;&atilde;o e CI/CD <span class="no-bold"></span></h2><section class="detached"><h3 id="486630389#github-actions-example" data-toc="github-actions-example#image-management.md-github-actions-example">GitHub Actions Example</h3><div class="detached code-block" id="486630389#-h91tc_69"><pre><code class="language-yaml">steps:
  - uses: actions/checkout@v2
  
  - name: Login to Registry
    run: docker login -u ${{ secrets.DOCKER_USER }} -p ${{ secrets.DOCKER_TOKEN }}
    
  - name: Build and Push
    run: |
      docker build -t app:${{ github.sha }} .
      docker push app:${{ github.sha }}</code></pre></div></section></section><section class="detached"><h2 id="486630389#waifu-tips" data-toc="waifu-tips#image-management.md-waifu-tips">Waifu Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="486630389#-h91tc_72"><span class="control" id="486630389#-h91tc_73">Registry-chan diz:</span> &quot;Mantenha suas tags organizadas como uma cole&ccedil;&atilde;o de mang&aacute;s! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="486630389#-h91tc_74"><span class="control" id="486630389#-h91tc_75">Space-chan avisa:</span> &quot;N&atilde;o deixe imagens antigas ocuparem espa&ccedil;o! Fa&ccedil;a limpeza regularmente! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="486630389#troubleshooting" data-toc="troubleshooting#image-management.md-troubleshooting">Troubleshooting <span class="no-bold"></span></h2><section class="detached"><h3 id="486630389#problemas-comuns" data-toc="problemas-comuns#image-management.md-problemas-comuns">Problemas Comuns</h3><ol class="list list-decimal" id="486630389#-h91tc_77" type="1" start="1"><li class="list-item" id="486630389#-h91tc_78"><p id="486630389#-h91tc_80"><span class="control" id="486630389#-h91tc_82">Pull Fails</span></p><div class="detached code-block" id="486630389#-h91tc_81"><pre><code class="language-bash"># Verificar conectividade
docker info

# Limpar cache DNS
docker system prune --volumes</code></pre></div></li><li class="list-item" id="486630389#-h91tc_79"><p id="486630389#-h91tc_83"><span class="control" id="486630389#-h91tc_85">Push Errors</span></p><div class="detached code-block" id="486630389#-h91tc_84"><pre><code class="language-bash"># Verificar autenticao
docker login

# Verificar permisses
docker push app:tag</code></pre></div></li></ol></section></section><section class="detached"><h2 id="486630389#pr-ximos-passos" data-toc="pr-ximos-passos#image-management.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="486630389#-h91tc_86" type="1" start="1"><li class="list-item" id="486630389#-h91tc_88"><p id="486630389#-h91tc_91">Opera&ccedil;&otilde;es com Containers (<a href="#-672215880">Opera&ccedil;&otilde;es com Containers: O Manual do Operador </a>)</p></li><li class="list-item" id="486630389#-h91tc_89"><p id="486630389#-h91tc_93">Melhores Pr&aacute;ticas (<a href="#1223070191">Melhores Pr&aacute;ticas Docker: O Caminho do Mestre </a>)</p></li><li class="list-item" id="486630389#-h91tc_90"><p id="486630389#-h91tc_95">Laborat&oacute;rio Pr&aacute;tico (<a href="#659198120">Laborat&oacute;rio Pr&aacute;tico: M&atilde;o na Massa! </a>)</p></li></ol><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="486630389#-h91tc_97"><span class="control" id="486630389#-h91tc_98">Sensei's Note:</span> &quot;Um bom gerenciamento de imagens &eacute; como manter um dojo organizado - cada coisa em seu lugar.&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-672215880">Opera&ccedil;&otilde;es com Containers: O Manual do Operador <span class="no-bold"></span></h1><div class="detached code-block" id="-672215880#-n3clcj_3"><pre><code class="language-none">
 CONTAINER LIFECYCLE                                       
                                                          
    created  running  paused                       
                                                       
                  stopped                          
                                                        
         removed                         
                                                          
</code></pre></div><section class="detached"><h2 id="-672215880#opera-es-b-sicas" data-toc="opera-es-b-sicas#container-operations.md-opera-es-b-sicas">Opera&ccedil;&otilde;es B&aacute;sicas <span class="no-bold"></span></h2><section class="detached"><h3 id="-672215880#ciclo-de-vida" data-toc="ciclo-de-vida#container-operations.md-ciclo-de-vida">Ciclo de Vida</h3><div class="detached code-block" id="-672215880#-n3clcj_18"><pre><code class="language-bash"># Criar container
docker create --name meu-app nginx

# Iniciar container
docker start meu-app

# Parar container
docker stop meu-app

# Remover container
docker rm meu-app</code></pre></div></section><section class="detached"><h3 id="-672215880#execu-o-e-acesso" data-toc="execu-o-e-acesso#container-operations.md-execu-o-e-acesso">Execu&ccedil;&atilde;o e Acesso</h3><div class="detached code-block" id="-672215880#-n3clcj_19"><pre><code class="language-bash"># Executar novo container
docker run -d --name web nginx

# Executar comando em container
docker exec -it web bash

# Visualizar logs
docker logs web

# Copiar arquivos
docker cp arquivo.txt web:/app/</code></pre></div></section></section><section class="detached"><h2 id="-672215880#gerenciamento-de-estado" data-toc="gerenciamento-de-estado#container-operations.md-gerenciamento-de-estado">Gerenciamento de Estado <span class="no-bold"></span></h2><section class="detached"><h3 id="-672215880#status-e-inspe-o" data-toc="status-e-inspe-o#container-operations.md-status-e-inspe-o">Status e Inspe&ccedil;&atilde;o</h3><div class="detached code-block" id="-672215880#-n3clcj_22"><pre><code class="language-bash"># Listar containers
docker ps -a

# Inspecionar container
docker inspect web

# Estatsticas em tempo real
docker stats web

# Processos em execuo
docker top web</code></pre></div></section><section class="detached"><h3 id="-672215880#controle-de-recursos" data-toc="controle-de-recursos#container-operations.md-controle-de-recursos">Controle de Recursos</h3><div class="detached code-block" id="-672215880#-n3clcj_23"><pre><code class="language-bash"># Limitar CPU e memria
docker run -d \
  --cpus=&quot;.5&quot; \
  --memory=&quot;512m&quot; \
  --name app \
  nginx

# Atualizar limites
docker update --cpus=&quot;.8&quot; app</code></pre></div></section></section><section class="detached"><h2 id="-672215880#network-operations" data-toc="network-operations#container-operations.md-network-operations">Network Operations <span class="no-bold"></span></h2><section class="detached"><h3 id="-672215880#conectividade" data-toc="conectividade#container-operations.md-conectividade">Conectividade</h3><div class="detached code-block" id="-672215880#-n3clcj_25"><pre><code class="language-bash"># Criar rede
docker network create minha-rede

# Conectar container
docker network connect minha-rede web

# Desconectar container
docker network disconnect minha-rede web

# Inspecionar rede
docker network inspect minha-rede</code></pre></div></section></section><section class="detached"><h2 id="-672215880#volume-operations" data-toc="volume-operations#container-operations.md-volume-operations">Volume Operations <span class="no-bold"></span></h2><section class="detached"><h3 id="-672215880#persist-ncia-de-dados" data-toc="persist-ncia-de-dados#container-operations.md-persist-ncia-de-dados">Persist&ecirc;ncia de Dados</h3><div class="detached code-block" id="-672215880#-n3clcj_27"><pre><code class="language-bash"># Criar volume
docker volume create meus-dados

# Montar volume
docker run -d \
  -v meus-dados:/data \
  --name db \
  postgres

# Listar volumes
docker volume ls

# Remover volume
docker volume rm meus-dados</code></pre></div></section></section><section class="detached"><h2 id="-672215880#troubleshooting-matrix" data-toc="troubleshooting-matrix#container-operations.md-troubleshooting-matrix">Troubleshooting Matrix <span class="no-bold"></span></h2><div class="table-wrapper detached"><table id="-672215880#-n3clcj_28"><tr class="header-row" id="-672215880#-n3clcj_29"><th id="-672215880#-n3clcj_34"><p>Problema</p></th><th id="-672215880#-n3clcj_35"><p>Comando</p></th><th id="-672215880#-n3clcj_36"><p>Solu&ccedil;&atilde;o</p></th></tr><tr class="" id="-672215880#-n3clcj_30"><td id="-672215880#-n3clcj_37"><p>Container n&atilde;o inicia</p></td><td id="-672215880#-n3clcj_38"><p><span class="inline-code" id="-672215880#-n3clcj_40">docker logs</span></p></td><td id="-672215880#-n3clcj_39"><p>Verificar logs de erro</p></td></tr><tr class="" id="-672215880#-n3clcj_31"><td id="-672215880#-n3clcj_41"><p>Container travado</p></td><td id="-672215880#-n3clcj_42"><p><span class="inline-code" id="-672215880#-n3clcj_44">docker restart</span></p></td><td id="-672215880#-n3clcj_43"><p>Reiniciar container</p></td></tr><tr class="" id="-672215880#-n3clcj_32"><td id="-672215880#-n3clcj_45"><p>Mem&oacute;ria alta</p></td><td id="-672215880#-n3clcj_46"><p><span class="inline-code" id="-672215880#-n3clcj_48">docker stats</span></p></td><td id="-672215880#-n3clcj_47"><p>Ajustar limites</p></td></tr><tr class="" id="-672215880#-n3clcj_33"><td id="-672215880#-n3clcj_49"><p>Rede inst&aacute;vel</p></td><td id="-672215880#-n3clcj_50"><p><span class="inline-code" id="-672215880#-n3clcj_52">docker network inspect</span></p></td><td id="-672215880#-n3clcj_51"><p>Verificar conectividade</p></td></tr></table></div></section><section class="detached"><h2 id="-672215880#batch-operations" data-toc="batch-operations#container-operations.md-batch-operations">Batch Operations <span class="no-bold"></span></h2><section class="detached"><h3 id="-672215880#opera-es-em-massa" data-toc="opera-es-em-massa#container-operations.md-opera-es-em-massa">Opera&ccedil;&otilde;es em Massa</h3><div class="detached code-block" id="-672215880#-n3clcj_54"><pre><code class="language-bash"># Parar todos containers
docker stop $(docker ps -q)

# Remover containers parados
docker container prune

# Remover tudo no usado
docker system prune -a

# Backup de volumes
docker run --rm \
  -v volume_name:/source \
  -v $(pwd):/backup \
  alpine tar czf /backup/volume_backup.tar.gz /source</code></pre></div></section></section><section class="detached"><h2 id="-672215880#health-checks" data-toc="health-checks#container-operations.md-health-checks">Health Checks <span class="no-bold"></span></h2><section class="detached"><h3 id="-672215880#monitoramento-de-sa-de" data-toc="monitoramento-de-sa-de#container-operations.md-monitoramento-de-sa-de">Monitoramento de Sa&uacute;de</h3><div class="detached code-block" id="-672215880#-n3clcj_56"><pre><code class="language-bash"># Container com health check
docker run -d \
  --health-cmd=&quot;curl -f http://localhost/ || exit 1&quot; \
  --health-interval=5s \
  --name web \
  nginx

# Verificar status
docker inspect --format='{{.State.Health.Status}}' web</code></pre></div></section></section><section class="detached"><h2 id="-672215880#waifu-operation-tips" data-toc="waifu-operation-tips#container-operations.md-waifu-operation-tips">Waifu Operation Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-672215880#-n3clcj_59"><span class="control" id="-672215880#-n3clcj_60">Container-chan diz:</span> &quot;Mantenha seus containers leves e eficientes! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-672215880#-n3clcj_61"><span class="control" id="-672215880#-n3clcj_62">Resource-sama avisa:</span> &quot;Sempre defina limites de recursos para evitar surpresas! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="-672215880#debug-commands" data-toc="debug-commands#container-operations.md-debug-commands">Debug Commands <span class="no-bold"></span></h2><section class="detached"><h3 id="-672215880#ferramentas-de-debug" data-toc="ferramentas-de-debug#container-operations.md-ferramentas-de-debug">Ferramentas de Debug</h3><div class="detached code-block" id="-672215880#-n3clcj_64"><pre><code class="language-bash"># Logs em tempo real
docker logs -f web

# Histrico de eventos
docker events --filter container=web

# Dump de estado
docker inspect web &gt; debug.json

# Trace de rede
docker run --net container:web nicolaka/netshoot</code></pre></div></section></section><section class="detached"><h2 id="-672215880#automation-scripts" data-toc="automation-scripts#container-operations.md-automation-scripts">Automation Scripts <span class="no-bold"></span></h2><section class="detached"><h3 id="-672215880#exemplos-de-automa-o" data-toc="exemplos-de-automa-o#container-operations.md-exemplos-de-automa-o">Exemplos de Automa&ccedil;&atilde;o</h3><div class="detached code-block" id="-672215880#-n3clcj_66"><pre><code class="language-bash">#!/bin/bash
# Restart containers mais velhos que 7 dias
docker ps -q | xargs docker inspect \
  --format='{{.Id}} {{.State.StartedAt}}' | \
  awk '{if ($2 &lt;= &quot;'$(date -d'7 days ago' -Ins --utc)'&quot;) print $1}' | \
  xargs docker restart</code></pre></div></section></section><section class="detached"><h2 id="-672215880#checkpoint" data-toc="checkpoint#container-operations.md-checkpoint">Checkpoint <span class="no-bold"></span></h2><p id="-672215880#-n3clcj_67">Voc&ecirc; agora sabe:</p><ul class="list" id="-672215880#-n3clcj_68" start="1"><li class="list-item" id="-672215880#-n3clcj_69"><p id="-672215880#-n3clcj_75">[x] Gerenciar ciclo de vida</p></li><li class="list-item" id="-672215880#-n3clcj_70"><p id="-672215880#-n3clcj_76">[x] Controlar recursos</p></li><li class="list-item" id="-672215880#-n3clcj_71"><p id="-672215880#-n3clcj_77">[x] Operar redes</p></li><li class="list-item" id="-672215880#-n3clcj_72"><p id="-672215880#-n3clcj_78">[x] Gerenciar volumes</p></li><li class="list-item" id="-672215880#-n3clcj_73"><p id="-672215880#-n3clcj_79">[x] Debugar problemas</p></li><li class="list-item" id="-672215880#-n3clcj_74"><p id="-672215880#-n3clcj_80">[x] Automatizar opera&ccedil;&otilde;es</p></li></ul></section><section class="detached"><h2 id="-672215880#pr-ximos-passos" data-toc="pr-ximos-passos#container-operations.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="-672215880#-n3clcj_81" type="1" start="1"><li class="list-item" id="-672215880#-n3clcj_83"><p id="-672215880#-n3clcj_86">Melhores Pr&aacute;ticas (<a href="#1223070191">Melhores Pr&aacute;ticas Docker: O Caminho do Mestre </a>)</p></li><li class="list-item" id="-672215880#-n3clcj_84"><p id="-672215880#-n3clcj_88">Laborat&oacute;rio Pr&aacute;tico (<a href="#659198120">Laborat&oacute;rio Pr&aacute;tico: M&atilde;o na Massa! </a>)</p></li><li class="list-item" id="-672215880#-n3clcj_85"><p id="-672215880#-n3clcj_90">Guia de Troubleshooting (<a href="#1568904649">Guia de Troubleshooting: Debugando na Matrix </a>)</p></li></ol><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-672215880#-n3clcj_92"><span class="control" id="-672215880#-n3clcj_93">Sensei's Note:</span> &quot;A maestria em opera&ccedil;&otilde;es de containers vem da pr&aacute;tica constante e da aten&ccedil;&atilde;o aos detalhes.&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1223070191">Melhores Pr&aacute;ticas Docker: O Caminho do Mestre <span class="no-bold"></span></h1><div class="detached code-block" id="1223070191#-7u4ckq_3"><pre><code class="language-none">
 DOCKER BEST PRACTICES MATRIX                              
                                                          
    Security  Performance  Maintainability    
                                                       
                                                       
                        
                   DevOps Flow                           
                                                          
</code></pre></div><section class="detached"><h2 id="1223070191#dockerfile-best-practices" data-toc="dockerfile-best-practices#best-practices.md-dockerfile-best-practices">Dockerfile Best Practices <span class="no-bold"></span></h2><section class="detached"><h3 id="1223070191#otimiza-o-de-imagens" data-toc="otimiza-o-de-imagens#best-practices.md-otimiza-o-de-imagens">Otimiza&ccedil;&atilde;o de Imagens</h3><div class="detached code-block" id="1223070191#-7u4ckq_18"><pre><code class="language-none">#  Multi-stage build
FROM node:alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html</code></pre></div></section><section class="detached"><h3 id="1223070191#layer-optimization" data-toc="layer-optimization#best-practices.md-layer-optimization">Layer Optimization</h3><div class="detached code-block" id="1223070191#-7u4ckq_19"><pre><code class="language-none">#  Combine RUN commands
RUN apt-get update &amp;&amp; \
    apt-get install -y \
    package1 \
    package2 &amp;&amp; \
    rm -rf /var/lib/apt/lists/*

#  Avoid multiple RUN commands
RUN apt-get update
RUN apt-get install package1
RUN apt-get install package2</code></pre></div></section></section><section class="detached"><h2 id="1223070191#security-guidelines" data-toc="security-guidelines#best-practices.md-security-guidelines">Security Guidelines <span class="no-bold"></span></h2><section class="detached"><h3 id="1223070191#container-hardening" data-toc="container-hardening#best-practices.md-container-hardening">Container Hardening</h3><div class="detached code-block" id="1223070191#-7u4ckq_22"><pre><code class="language-none">#  Use non-root user
FROM alpine
RUN adduser -D appuser
USER appuser

#  Read-only root filesystem
docker run --read-only nginx</code></pre></div></section><section class="detached"><h3 id="1223070191#secrets-management" data-toc="secrets-management#best-practices.md-secrets-management">Secrets Management</h3><div class="detached code-block" id="1223070191#-7u4ckq_23"><pre><code class="language-bash">#  Use Docker secrets
docker secret create app_secret secret.txt
docker service create \
    --secret app_secret \
    myapp

#  Avoid environment variables for secrets
docker run -e &quot;API_KEY=secret&quot; myapp</code></pre></div></section></section><section class="detached"><h2 id="1223070191#performance-optimization" data-toc="performance-optimization#best-practices.md-performance-optimization">Performance Optimization <span class="no-bold"></span></h2><section class="detached"><h3 id="1223070191#resource-management" data-toc="resource-management#best-practices.md-resource-management">Resource Management</h3><div class="detached code-block" id="1223070191#-7u4ckq_26"><pre><code class="language-bash">#  Set resource limits
docker run \
    --cpus=&quot;.5&quot; \
    --memory=&quot;512m&quot; \
    --memory-swap=&quot;1g&quot; \
    nginx</code></pre></div></section><section class="detached"><h3 id="1223070191#networking" data-toc="networking#best-practices.md-networking">Networking</h3><div class="detached code-block" id="1223070191#-7u4ckq_27"><pre><code class="language-bash">#  Use user-defined networks
docker network create --driver overlay mynet

#  Enable DNS caching
docker run --dns-opt=&quot;ndots:1&quot; nginx</code></pre></div></section></section><section class="detached"><h2 id="1223070191#development-workflow" data-toc="development-workflow#best-practices.md-development-workflow">Development Workflow <span class="no-bold"></span></h2><section class="detached"><h3 id="1223070191#docker-compose" data-toc="docker-compose#best-practices.md-docker-compose">Docker Compose</h3><div class="detached code-block" id="1223070191#-7u4ckq_30"><pre><code class="language-yaml">#  docker-compose.yml
version: '3.8'
services:
  app:
    build:
      context: .
      target: development
    volumes:
      - .:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development</code></pre></div></section><section class="detached"><h3 id="1223070191#testing" data-toc="testing#best-practices.md-testing">Testing</h3><div class="detached code-block" id="1223070191#-7u4ckq_31"><pre><code class="language-bash">#  Dedicated test container
docker-compose -f docker-compose.test.yml up</code></pre></div></section></section><section class="detached"><h2 id="1223070191#production-deployment" data-toc="production-deployment#best-practices.md-production-deployment">Production Deployment <span class="no-bold"></span></h2><section class="detached"><h3 id="1223070191#health-checks" data-toc="health-checks#best-practices.md-health-checks">Health Checks</h3><div class="detached code-block" id="1223070191#-7u4ckq_34"><pre><code class="language-none">#  Add HEALTHCHECK
HEALTHCHECK --interval=30s --timeout=3s \
  CMD curl -f http://localhost/ || exit 1</code></pre></div></section><section class="detached"><h3 id="1223070191#logging" data-toc="logging#best-practices.md-logging">Logging</h3><div class="detached code-block" id="1223070191#-7u4ckq_35"><pre><code class="language-bash">#  Configure logging
docker run \
    --log-driver json-file \
    --log-opt max-size=10m \
    --log-opt max-file=3 \
    nginx</code></pre></div></section></section><section class="detached"><h2 id="1223070191#ci-cd-integration" data-toc="ci-cd-integration#best-practices.md-ci-cd-integration">CI/CD Integration <span class="no-bold"></span></h2><section class="detached"><h3 id="1223070191#build-pipeline" data-toc="build-pipeline#best-practices.md-build-pipeline">Build Pipeline</h3><div class="detached code-block" id="1223070191#-7u4ckq_37"><pre><code class="language-yaml">#  GitHub Actions example
name: Docker Build

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Build and test
        run: |
          docker build -t myapp:test .
          docker run myapp:test npm test</code></pre></div></section></section><section class="detached"><h2 id="1223070191#monitoring-maintenance" data-toc="monitoring-maintenance#best-practices.md-monitoring-maintenance">Monitoring &amp; Maintenance <span class="no-bold"></span></h2><section class="detached"><h3 id="1223070191#container-health" data-toc="container-health#best-practices.md-container-health">Container Health</h3><div class="detached code-block" id="1223070191#-7u4ckq_39"><pre><code class="language-bash">#  Regular health checks
docker inspect --format='{{.State.Health.Status}}' container_name

#  Resource monitoring
docker stats --format &quot;table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}&quot;</code></pre></div></section></section><section class="detached"><h2 id="1223070191#do-s-and-don-ts-matrix" data-toc="do-s-and-don-ts-matrix#best-practices.md-do-s-and-don-ts-matrix">DO's and DON'Ts Matrix <span class="no-bold"></span></h2><section class="detached"><h3 id="1223070191#do-s" data-toc="do-s#best-practices.md-do-s">DO's <span class="no-bold"></span></h3><div class="detached code-block" id="1223070191#-7u4ckq_42"><pre><code class="language-none">
 1. Use multi-stage builds      
 2. Set resource limits         
 3. Implement health checks     
 4. Use .dockerignore          
 5. Version control images      
</code></pre></div></section><section class="detached"><h3 id="1223070191#don-ts" data-toc="don-ts#best-practices.md-don-ts">DON'Ts <span class="no-bold"></span></h3><div class="detached code-block" id="1223070191#-7u4ckq_43"><pre><code class="language-none">
 1. Run as root                 
 2. Store secrets in images     
 3. Use latest tag             
 4. Ignore security scans      
 5. Skip health checks         
</code></pre></div></section></section><section class="detached"><h2 id="1223070191#waifu-best-practice-tips" data-toc="waifu-best-practice-tips#best-practices.md-waifu-best-practice-tips">Waifu Best Practice Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1223070191#-7u4ckq_46"><span class="control" id="1223070191#-7u4ckq_47">Security-chan diz:</span> &quot;Nunca confie em imagens n&atilde;o verificadas! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1223070191#-7u4ckq_48"><span class="control" id="1223070191#-7u4ckq_49">Performance-sama avisa:</span> &quot;Containers leves s&atilde;o containers felizes! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="1223070191#checklist-de-qualidade" data-toc="checklist-de-qualidade#best-practices.md-checklist-de-qualidade">Checklist de Qualidade <span class="no-bold"></span></h2><section class="detached"><h3 id="1223070191#antes-do-deploy" data-toc="antes-do-deploy#best-practices.md-antes-do-deploy">Antes do Deploy</h3><ol class="list list-decimal" id="1223070191#-7u4ckq_51" type="1" start="1"><li class="list-item" id="1223070191#-7u4ckq_52"><p id="1223070191#-7u4ckq_59">[ ] Imagem otimizada</p></li><li class="list-item" id="1223070191#-7u4ckq_53"><p id="1223070191#-7u4ckq_60">[ ] Security scan realizado</p></li><li class="list-item" id="1223070191#-7u4ckq_54"><p id="1223070191#-7u4ckq_61">[ ] Resources limits definidos</p></li><li class="list-item" id="1223070191#-7u4ckq_55"><p id="1223070191#-7u4ckq_62">[ ] Health checks implementados</p></li><li class="list-item" id="1223070191#-7u4ckq_56"><p id="1223070191#-7u4ckq_63">[ ] Logs configurados</p></li><li class="list-item" id="1223070191#-7u4ckq_57"><p id="1223070191#-7u4ckq_64">[ ] Backups planejados</p></li><li class="list-item" id="1223070191#-7u4ckq_58"><p id="1223070191#-7u4ckq_65">[ ] Monitoring setup</p></li></ol></section></section><section class="detached"><h2 id="1223070191#troubleshooting-guide" data-toc="troubleshooting-guide#best-practices.md-troubleshooting-guide">Troubleshooting Guide <span class="no-bold"></span></h2><section class="detached"><h3 id="1223070191#common-issues" data-toc="common-issues#best-practices.md-common-issues">Common Issues</h3><div class="detached code-block" id="1223070191#-7u4ckq_67"><pre><code class="language-bash">#  Debug container
docker logs container_name

#  Interactive debug
docker exec -it container_name sh

#  Network debug
docker network inspect bridge</code></pre></div></section></section><section class="detached"><h2 id="1223070191#pr-ximos-passos" data-toc="pr-ximos-passos#best-practices.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="1223070191#-7u4ckq_68" type="1" start="1"><li class="list-item" id="1223070191#-7u4ckq_70"><p id="1223070191#-7u4ckq_73">Laborat&oacute;rio Pr&aacute;tico (<a href="#659198120">Laborat&oacute;rio Pr&aacute;tico: M&atilde;o na Massa! </a>)</p></li><li class="list-item" id="1223070191#-7u4ckq_71"><p id="1223070191#-7u4ckq_75">Guia de Troubleshooting (<a href="#1568904649">Guia de Troubleshooting: Debugando na Matrix </a>)</p></li><li class="list-item" id="1223070191#-7u4ckq_72"><p id="1223070191#-7u4ckq_77"></p></li></ol><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1223070191#-7u4ckq_79"><span class="control" id="1223070191#-7u4ckq_80">Sensei's Note:</span> &quot;As melhores pr&aacute;ticas s&atilde;o como um kata - devem ser praticadas at&eacute; se tornarem naturais.&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="659198120">Laborat&oacute;rio Pr&aacute;tico: M&atilde;o na Massa! <span class="no-bold"></span></h1><div class="detached code-block" id="659198120#-v6qupv_3"><pre><code class="language-none">
 DOCKER LAB SIMULATOR v1.0                                 
                                                          
 STATUS: INICIANDO SIMULAO...                           
 DIFICULDADE: PROGRESSIVA                                 
 OBJETIVO: DOMINAR A MATRIX DOS CONTAINERS                
                                                          
</code></pre></div><section class="detached"><h2 id="659198120#lab-1-primeira-aplica-o" data-toc="lab-1-primeira-aplica-o#hands-on-lab.md-lab-1-primeira-aplica-o">Lab 1: Primeira Aplica&ccedil;&atilde;o <span class="no-bold"></span></h2><section class="detached"><h3 id="659198120#objetivo" data-toc="objetivo#hands-on-lab.md-objetivo">Objetivo</h3><p id="659198120#-v6qupv_15">Criar uma aplica&ccedil;&atilde;o web simples usando Docker</p></section><section class="detached"><h3 id="659198120#passos" data-toc="passos#hands-on-lab.md-passos">Passos</h3><ol class="list list-decimal" id="659198120#-v6qupv_16" type="1" start="1"><li class="list-item" id="659198120#-v6qupv_22"><p id="659198120#-v6qupv_23"><span class="control" id="659198120#-v6qupv_24">Criar Dockerfile</span></p></li></ol><div class="detached code-block" id="659198120#-v6qupv_17"><pre><code class="language-none">FROM python:3.9-slim
WORKDIR /app
COPY app.py requirements.txt ./
RUN pip install -r requirements.txt
CMD [&quot;python&quot;, &quot;app.py&quot;]</code></pre></div><ol class="list list-decimal" id="659198120#-v6qupv_18" type="1" start="2"><li class="list-item" id="659198120#-v6qupv_25"><p id="659198120#-v6qupv_26"><span class="control" id="659198120#-v6qupv_27">Criar Aplica&ccedil;&atilde;o</span></p></li></ol><div class="detached code-block" id="659198120#-v6qupv_19"><pre><code class="language-python">from flask import Flask
app = Flask(__name__)

@app.route('/')
def hello():
    return &quot;Ol, Docker!&quot;

if __name__ == '__main__':
    app.run(host='0.0.0.0')</code></pre></div><ol class="list list-decimal" id="659198120#-v6qupv_20" type="1" start="3"><li class="list-item" id="659198120#-v6qupv_28"><p id="659198120#-v6qupv_29"><span class="control" id="659198120#-v6qupv_30">Build &amp; Run</span></p></li></ol><div class="detached code-block" id="659198120#-v6qupv_21"><pre><code class="language-bash"># Build da imagem
docker build -t minha-app:v1 .

# Executar container
docker run -p 5000:5000 minha-app:v1</code></pre></div></section></section><section class="detached"><h2 id="659198120#lab-2-multi-container-setup" data-toc="lab-2-multi-container-setup#hands-on-lab.md-lab-2-multi-container-setup">Lab 2: Multi-Container Setup <span class="no-bold"></span></h2><section class="detached"><h3 id="659198120#objetivo" data-toc="objetivo#hands-on-lab.md-objetivo">Objetivo</h3><p id="659198120#-v6qupv_34">Criar aplica&ccedil;&atilde;o com frontend, backend e banco de dados</p></section><section class="detached"><h3 id="659198120#docker-compose" data-toc="docker-compose#hands-on-lab.md-docker-compose">Docker Compose</h3><div class="detached code-block" id="659198120#-v6qupv_35"><pre><code class="language-yaml">version: '3.8'
services:
  frontend:
    build: ./frontend
    ports:
      - &quot;80:80&quot;
    depends_on:
      - backend

  backend:
    build: ./backend
    environment:
      - DB_HOST=db
    depends_on:
      - db

  db:
    image: postgres:13
    volumes:
      - pgdata:/var/lib/postgresql/data

volumes:
  pgdata:</code></pre></div></section><section class="detached"><h3 id="659198120#teste-de-integra-o" data-toc="teste-de-integra-o#hands-on-lab.md-teste-de-integra-o">Teste de Integra&ccedil;&atilde;o</h3><div class="detached code-block" id="659198120#-v6qupv_36"><pre><code class="language-bash"># Subir ambiente
docker-compose up -d

# Verificar logs
docker-compose logs -f

# Testar conexes
curl localhost/api/health</code></pre></div></section></section><section class="detached"><h2 id="659198120#lab-3-debugging-troubleshooting" data-toc="lab-3-debugging-troubleshooting#hands-on-lab.md-lab-3-debugging-troubleshooting">Lab 3: Debugging &amp; Troubleshooting <span class="no-bold"></span></h2><section class="detached"><h3 id="659198120#cen-rio-1-container-crashando" data-toc="cen-rio-1-container-crashando#hands-on-lab.md-cen-rio-1-container-crashando">Cen&aacute;rio 1: Container Crashando</h3><div class="detached code-block" id="659198120#-v6qupv_39"><pre><code class="language-bash"># Investigar logs
docker logs container_id

# Acessar container
docker exec -it container_id sh

# Verificar recursos
docker stats container_id</code></pre></div></section><section class="detached"><h3 id="659198120#cen-rio-2-problemas-de-rede" data-toc="cen-rio-2-problemas-de-rede#hands-on-lab.md-cen-rio-2-problemas-de-rede">Cen&aacute;rio 2: Problemas de Rede</h3><div class="detached code-block" id="659198120#-v6qupv_40"><pre><code class="language-bash"># Criar rede
docker network create mynet

# Inspecionar rede
docker network inspect mynet

# Testar conectividade
docker run --network mynet busybox ping service_name</code></pre></div></section></section><section class="detached"><h2 id="659198120#lab-4-otimiza-o-de-imagem" data-toc="lab-4-otimiza-o-de-imagem#hands-on-lab.md-lab-4-otimiza-o-de-imagem">Lab 4: Otimiza&ccedil;&atilde;o de Imagem <span class="no-bold"></span></h2><section class="detached"><h3 id="659198120#antes" data-toc="antes#hands-on-lab.md-antes">Antes</h3><div class="detached code-block" id="659198120#-v6qupv_43"><pre><code class="language-none">FROM ubuntu
RUN apt-get update
RUN apt-get install -y python3
RUN apt-get install -y python3-pip
COPY . /app
RUN pip install -r requirements.txt
CMD [&quot;python3&quot;, &quot;app.py&quot;]</code></pre></div></section><section class="detached"><h3 id="659198120#depois" data-toc="depois#hands-on-lab.md-depois">Depois</h3><div class="detached code-block" id="659198120#-v6qupv_44"><pre><code class="language-none">FROM python:3.9-alpine
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
COPY . .
CMD [&quot;python3&quot;, &quot;app.py&quot;]</code></pre></div></section></section><section class="detached"><h2 id="659198120#lab-5-seguran-a-monitoramento" data-toc="lab-5-seguran-a-monitoramento#hands-on-lab.md-lab-5-seguran-a-monitoramento">Lab 5: Seguran&ccedil;a &amp; Monitoramento <span class="no-bold"></span></h2><section class="detached"><h3 id="659198120#security-scan" data-toc="security-scan#hands-on-lab.md-security-scan">Security Scan</h3><div class="detached code-block" id="659198120#-v6qupv_47"><pre><code class="language-bash"># Scan de vulnerabilidades
docker scan minha-app:v1

# Anlise de configurao
docker bench security</code></pre></div></section><section class="detached"><h3 id="659198120#monitoring-setup" data-toc="monitoring-setup#hands-on-lab.md-monitoring-setup">Monitoring Setup</h3><div class="detached code-block" id="659198120#-v6qupv_48"><pre><code class="language-yaml">version: '3.8'
services:
  prometheus:
    image: prom/prometheus
    ports:
      - &quot;9090:9090&quot;

  grafana:
    image: grafana/grafana
    ports:
      - &quot;3000:3000&quot;</code></pre></div></section></section><section class="detached"><h2 id="659198120#desafios-extras" data-toc="desafios-extras#hands-on-lab.md-desafios-extras">Desafios Extras <span class="no-bold"></span></h2><section class="detached"><h3 id="659198120#challenge-1-high-availability" data-toc="challenge-1-high-availability#hands-on-lab.md-challenge-1-high-availability">Challenge 1: High Availability</h3><ul class="list" id="659198120#-v6qupv_51" start="1"><li class="list-item" id="659198120#-v6qupv_52"><p id="659198120#-v6qupv_55">Implementar load balancing</p></li><li class="list-item" id="659198120#-v6qupv_53"><p id="659198120#-v6qupv_56">Configurar health checks</p></li><li class="list-item" id="659198120#-v6qupv_54"><p id="659198120#-v6qupv_57">Simular failover</p></li></ul></section><section class="detached"><h3 id="659198120#challenge-2-ci-cd-pipeline" data-toc="challenge-2-ci-cd-pipeline#hands-on-lab.md-challenge-2-ci-cd-pipeline">Challenge 2: CI/CD Pipeline</h3><div class="detached code-block" id="659198120#-v6qupv_58"><pre><code class="language-yaml"># .github/workflows/docker.yml
name: Docker CI

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Build
        run: docker build -t app:test .
      - name: Test
        run: docker run app:test pytest</code></pre></div></section></section><section class="detached"><h2 id="659198120#waifu-lab-assistant-tips" data-toc="waifu-lab-assistant-tips#hands-on-lab.md-waifu-lab-assistant-tips">Waifu Lab Assistant Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="659198120#-v6qupv_61"><span class="control" id="659198120#-v6qupv_62">Debug-chan diz:</span> &quot;Quando tudo der errado, <span class="inline-code" id="659198120#-v6qupv_63">docker logs</span> &eacute; seu melhor amigo! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="659198120#-v6qupv_64"><span class="control" id="659198120#-v6qupv_65">Security-sama alerta:</span> &quot;Nunca se esque&ccedil;a de remover as credenciais dos logs! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="659198120#checklist-de-conclus-o" data-toc="checklist-de-conclus-o#hands-on-lab.md-checklist-de-conclus-o">Checklist de Conclus&atilde;o <span class="no-bold"></span></h2><section class="detached"><h3 id="659198120#lab-1" data-toc="lab-1#hands-on-lab.md-lab-1">Lab 1</h3><ul class="list" id="659198120#-v6qupv_71" start="1"><li class="list-item" id="659198120#-v6qupv_72"><p id="659198120#-v6qupv_75">[ ] Dockerfile criado</p></li><li class="list-item" id="659198120#-v6qupv_73"><p id="659198120#-v6qupv_76">[ ] Aplica&ccedil;&atilde;o rodando</p></li><li class="list-item" id="659198120#-v6qupv_74"><p id="659198120#-v6qupv_77">[ ] Portas mapeadas</p></li></ul></section><section class="detached"><h3 id="659198120#lab-2" data-toc="lab-2#hands-on-lab.md-lab-2">Lab 2</h3><ul class="list" id="659198120#-v6qupv_78" start="1"><li class="list-item" id="659198120#-v6qupv_79"><p id="659198120#-v6qupv_82">[ ] Compose configurado</p></li><li class="list-item" id="659198120#-v6qupv_80"><p id="659198120#-v6qupv_83">[ ] Servi&ccedil;os comunicando</p></li><li class="list-item" id="659198120#-v6qupv_81"><p id="659198120#-v6qupv_84">[ ] Volumes persistentes</p></li></ul></section><section class="detached"><h3 id="659198120#lab-3" data-toc="lab-3#hands-on-lab.md-lab-3">Lab 3</h3><ul class="list" id="659198120#-v6qupv_85" start="1"><li class="list-item" id="659198120#-v6qupv_86"><p id="659198120#-v6qupv_89">[ ] Debug realizado</p></li><li class="list-item" id="659198120#-v6qupv_87"><p id="659198120#-v6qupv_90">[ ] Logs analisados</p></li><li class="list-item" id="659198120#-v6qupv_88"><p id="659198120#-v6qupv_91">[ ] Rede configurada</p></li></ul></section><section class="detached"><h3 id="659198120#lab-4" data-toc="lab-4#hands-on-lab.md-lab-4">Lab 4</h3><ul class="list" id="659198120#-v6qupv_92" start="1"><li class="list-item" id="659198120#-v6qupv_93"><p id="659198120#-v6qupv_96">[ ] Imagem otimizada</p></li><li class="list-item" id="659198120#-v6qupv_94"><p id="659198120#-v6qupv_97">[ ] Tamanho reduzido</p></li><li class="list-item" id="659198120#-v6qupv_95"><p id="659198120#-v6qupv_98">[ ] Build mais r&aacute;pido</p></li></ul></section><section class="detached"><h3 id="659198120#lab-5" data-toc="lab-5#hands-on-lab.md-lab-5">Lab 5</h3><ul class="list" id="659198120#-v6qupv_99" start="1"><li class="list-item" id="659198120#-v6qupv_100"><p id="659198120#-v6qupv_103">[ ] Security scan</p></li><li class="list-item" id="659198120#-v6qupv_101"><p id="659198120#-v6qupv_104">[ ] Monitoring ativo</p></li><li class="list-item" id="659198120#-v6qupv_102"><p id="659198120#-v6qupv_105">[ ] Alertas configurados</p></li></ul></section></section><section class="detached"><h2 id="659198120#pr-ximos-passos" data-toc="pr-ximos-passos#hands-on-lab.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="659198120#-v6qupv_106" type="1" start="1"><li class="list-item" id="659198120#-v6qupv_108"><p id="659198120#-v6qupv_111">Guia de Troubleshooting (<a href="#1568904649">Guia de Troubleshooting: Debugando na Matrix </a>)</p></li><li class="list-item" id="659198120#-v6qupv_109"><p id="659198120#-v6qupv_113">Melhores Pr&aacute;ticas (<a href="#1223070191">Melhores Pr&aacute;ticas Docker: O Caminho do Mestre </a>)</p></li><li class="list-item" id="659198120#-v6qupv_110"><p id="659198120#-v6qupv_115"></p></li></ol><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="659198120#-v6qupv_117"><span class="control" id="659198120#-v6qupv_118">Sensei's Note:</span> &quot;A pr&aacute;tica leva &agrave; perfei&ccedil;&atilde;o, mas backups levam &agrave; paz de esp&iacute;rito.&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1568904649">Guia de Troubleshooting: Debugando na Matrix <span class="no-bold"></span></h1><div class="detached code-block" id="1568904649#-f21mro_3"><pre><code class="language-none">
 DOCKER DEBUG MATRIX v1.0                                  
                                                          
 STATUS: SCANNING FOR ISSUES...                           
 LEVEL: FROM BASIC TO ADVANCED                            
 MISSION: RESOLVER PROBLEMAS COMO UM PRO                  
                                                          
</code></pre></div><section class="detached"><h2 id="1568904649#problemas-comuns-e-solu-es" data-toc="problemas-comuns-e-solu-es#troubleshooting-guide.md-problemas-comuns-e-solu-es">Problemas Comuns e Solu&ccedil;&otilde;es <span class="no-bold"></span></h2><section class="detached"><h3 id="1568904649#1-container-n-o-inicia" data-toc="1-container-n-o-inicia#troubleshooting-guide.md-1-container-n-o-inicia">1. Container n&atilde;o Inicia</h3><div class="detached code-block" id="1568904649#-f21mro_15"><pre><code class="language-bash"># Verificar logs
docker logs container_id

# Verificar status
docker ps -a

# Inspecionar configurao
docker inspect container_id</code></pre></div></section><section class="detached"><h3 id="1568904649#2-problemas-de-rede" data-toc="2-problemas-de-rede#troubleshooting-guide.md-2-problemas-de-rede">2. Problemas de Rede</h3><div class="detached code-block" id="1568904649#-f21mro_16"><pre><code class="language-bash"># Verificar redes
docker network ls

# Testar conectividade
docker run --rm busybox ping container_name

# Inspecionar rede
docker network inspect bridge</code></pre></div></section><section class="detached"><h3 id="1568904649#3-problemas-de-volume" data-toc="3-problemas-de-volume#troubleshooting-guide.md-3-problemas-de-volume">3. Problemas de Volume</h3><div class="detached code-block" id="1568904649#-f21mro_17"><pre><code class="language-bash"># Listar volumes
docker volume ls

# Inspecionar volume
docker volume inspect volume_name

# Verificar permisses
ls -la /var/lib/docker/volumes/</code></pre></div></section></section><section class="detached"><h2 id="1568904649#ferramentas-de-debug-avan-adas" data-toc="ferramentas-de-debug-avan-adas#troubleshooting-guide.md-ferramentas-de-debug-avan-adas">Ferramentas de Debug Avan&ccedil;adas <span class="no-bold"></span></h2><section class="detached"><h3 id="1568904649#docker-stats" data-toc="docker-stats#troubleshooting-guide.md-docker-stats">Docker Stats</h3><div class="detached code-block" id="1568904649#-f21mro_21"><pre><code class="language-bash"># Monitorar recursos
docker stats

# Limitar recursos
docker run --memory=512m --cpu-shares=512 image_name</code></pre></div></section><section class="detached"><h3 id="1568904649#docker-events" data-toc="docker-events#troubleshooting-guide.md-docker-events">Docker Events</h3><div class="detached code-block" id="1568904649#-f21mro_22"><pre><code class="language-bash"># Monitorar eventos em tempo real
docker events

# Filtrar eventos
docker events --filter 'type=container'</code></pre></div></section><section class="detached"><h3 id="1568904649#logging-avan-ado" data-toc="logging-avan-ado#troubleshooting-guide.md-logging-avan-ado">Logging Avan&ccedil;ado</h3><div class="detached code-block" id="1568904649#-f21mro_23"><pre><code class="language-bash"># Logs com timestamp
docker logs --timestamps container_id

# Logs em tempo real
docker logs --follow container_id

# ltimas N linhas
docker logs --tail 100 container_id</code></pre></div></section></section><section class="detached"><h2 id="1568904649#t-cnicas-de-investiga-o" data-toc="t-cnicas-de-investiga-o#troubleshooting-guide.md-t-cnicas-de-investiga-o">T&eacute;cnicas de Investiga&ccedil;&atilde;o <span class="no-bold"></span></h2><section class="detached"><h3 id="1568904649#1-container-deep-dive" data-toc="1-container-deep-dive#troubleshooting-guide.md-1-container-deep-dive">1. Container Deep Dive</h3><div class="detached code-block" id="1568904649#-f21mro_27"><pre><code class="language-bash"># Acessar container
docker exec -it container_id sh

# Processos rodando
docker top container_id

# Histrico de comandos
docker history image_name</code></pre></div></section><section class="detached"><h3 id="1568904649#2-network-debugging" data-toc="2-network-debugging#troubleshooting-guide.md-2-network-debugging">2. Network Debugging</h3><div class="detached code-block" id="1568904649#-f21mro_28"><pre><code class="language-bash"># DNS lookup
docker run --rm busybox nslookup container_name

# Trace route
docker run --rm busybox traceroute host.docker.internal

# Port mapping
docker port container_id</code></pre></div></section><section class="detached"><h3 id="1568904649#3-storage-analysis" data-toc="3-storage-analysis#troubleshooting-guide.md-3-storage-analysis">3. Storage Analysis</h3><div class="detached code-block" id="1568904649#-f21mro_29"><pre><code class="language-bash"># Disk usage
docker system df

# Clean up
docker system prune -a

# Volume cleanup
docker volume prune</code></pre></div></section></section><section class="detached"><h2 id="1568904649#waifu-debug-tips" data-toc="waifu-debug-tips#troubleshooting-guide.md-waifu-debug-tips">Waifu Debug Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1568904649#-f21mro_32"><span class="control" id="1568904649#-f21mro_33">Debug-chan diz:</span> &quot;Logs s&atilde;o como pegadas digitais - siga-as e encontrar&aacute; a verdade! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1568904649#-f21mro_34"><span class="control" id="1568904649#-f21mro_35">Network-sama alerta:</span> &quot;Sempre verifique suas configura&ccedil;&otilde;es de rede duas vezes! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="1568904649#checklist-de-debug" data-toc="checklist-de-debug#troubleshooting-guide.md-checklist-de-debug">Checklist de Debug <span class="no-bold"></span></h2><section class="detached"><h3 id="1568904649#b-sico" data-toc="b-sico#troubleshooting-guide.md-b-sico">B&aacute;sico</h3><ul class="list" id="1568904649#-f21mro_38" start="1"><li class="list-item" id="1568904649#-f21mro_39"><p id="1568904649#-f21mro_43">[ ] Verificar logs do container</p></li><li class="list-item" id="1568904649#-f21mro_40"><p id="1568904649#-f21mro_44">[ ] Confirmar status do container</p></li><li class="list-item" id="1568904649#-f21mro_41"><p id="1568904649#-f21mro_45">[ ] Checar configura&ccedil;&otilde;es de rede</p></li><li class="list-item" id="1568904649#-f21mro_42"><p id="1568904649#-f21mro_46">[ ] Validar volumes montados</p></li></ul></section><section class="detached"><h3 id="1568904649#avan-ado" data-toc="avan-ado#troubleshooting-guide.md-avan-ado">Avan&ccedil;ado</h3><ul class="list" id="1568904649#-f21mro_47" start="1"><li class="list-item" id="1568904649#-f21mro_48"><p id="1568904649#-f21mro_52">[ ] Analisar m&eacute;tricas de performance</p></li><li class="list-item" id="1568904649#-f21mro_49"><p id="1568904649#-f21mro_53">[ ] Investigar eventos do sistema</p></li><li class="list-item" id="1568904649#-f21mro_50"><p id="1568904649#-f21mro_54">[ ] Verificar seguran&ccedil;a</p></li><li class="list-item" id="1568904649#-f21mro_51"><p id="1568904649#-f21mro_55">[ ] Validar recursos dispon&iacute;veis</p></li></ul></section></section><section class="detached"><h2 id="1568904649#matriz-de-decis-o" data-toc="matriz-de-decis-o#troubleshooting-guide.md-matriz-de-decis-o">Matriz de Decis&atilde;o <span class="no-bold"></span></h2><div class="table-wrapper detached"><table id="1568904649#-f21mro_56"><tr class="header-row" id="1568904649#-f21mro_57"><th id="1568904649#-f21mro_62"><p>Sintoma</p></th><th id="1568904649#-f21mro_63"><p>Primeira A&ccedil;&atilde;o</p></th><th id="1568904649#-f21mro_64"><p>Pr&oacute;xima A&ccedil;&atilde;o</p></th><th id="1568904649#-f21mro_65"><p>Solu&ccedil;&atilde;o Comum</p></th></tr><tr class="" id="1568904649#-f21mro_58"><td id="1568904649#-f21mro_66"><p>Container Crashando</p></td><td id="1568904649#-f21mro_67"><p><span class="inline-code" id="1568904649#-f21mro_70">docker logs</span></p></td><td id="1568904649#-f21mro_68"><p><span class="inline-code" id="1568904649#-f21mro_71">docker inspect</span></p></td><td id="1568904649#-f21mro_69"><p>Verificar recursos</p></td></tr><tr class="" id="1568904649#-f21mro_59"><td id="1568904649#-f21mro_72"><p>Rede Lenta</p></td><td id="1568904649#-f21mro_73"><p><span class="inline-code" id="1568904649#-f21mro_76">docker network inspect</span></p></td><td id="1568904649#-f21mro_74"><p><span class="inline-code" id="1568904649#-f21mro_77">ping test</span></p></td><td id="1568904649#-f21mro_75"><p>Ajustar DNS</p></td></tr><tr class="" id="1568904649#-f21mro_60"><td id="1568904649#-f21mro_78"><p>Disco Cheio</p></td><td id="1568904649#-f21mro_79"><p><span class="inline-code" id="1568904649#-f21mro_82">docker system df</span></p></td><td id="1568904649#-f21mro_80"><p><span class="inline-code" id="1568904649#-f21mro_83">docker system prune</span></p></td><td id="1568904649#-f21mro_81"><p>Limpar volumes</p></td></tr><tr class="" id="1568904649#-f21mro_61"><td id="1568904649#-f21mro_84"><p>CPU Alta</p></td><td id="1568904649#-f21mro_85"><p><span class="inline-code" id="1568904649#-f21mro_88">docker stats</span></p></td><td id="1568904649#-f21mro_86"><p><span class="inline-code" id="1568904649#-f21mro_89">top</span> no container</p></td><td id="1568904649#-f21mro_87"><p>Limitar recursos</p></td></tr></table></div></section><section class="detached"><h2 id="1568904649#comandos-de-emerg-ncia" data-toc="comandos-de-emerg-ncia#troubleshooting-guide.md-comandos-de-emerg-ncia">Comandos de Emerg&ecirc;ncia <span class="no-bold"></span></h2><section class="detached"><h3 id="1568904649#reset-r-pido" data-toc="reset-r-pido#troubleshooting-guide.md-reset-r-pido">Reset R&aacute;pido</h3><div class="detached code-block" id="1568904649#-f21mro_92"><pre><code class="language-bash"># Parar todos containers
docker stop $(docker ps -q)

# Remover containers parados
docker container prune

# Limpar sistema
docker system prune -af</code></pre></div></section><section class="detached"><h3 id="1568904649#backup-de-emerg-ncia" data-toc="backup-de-emerg-ncia#troubleshooting-guide.md-backup-de-emerg-ncia">Backup de Emerg&ecirc;ncia</h3><div class="detached code-block" id="1568904649#-f21mro_93"><pre><code class="language-bash"># Backup de volume
docker run --rm -v volume_name:/source -v $(pwd):/backup alpine tar -czf /backup/volume_backup.tar.gz -C /source .

# Backup de container
docker commit container_id backup_image</code></pre></div></section></section><section class="detached"><h2 id="1568904649#pr-ximos-passos" data-toc="pr-ximos-passos#troubleshooting-guide.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="1568904649#-f21mro_94" type="1" start="1"><li class="list-item" id="1568904649#-f21mro_96"><p id="1568904649#-f21mro_99">Laborat&oacute;rio Pr&aacute;tico (<a href="#659198120">Laborat&oacute;rio Pr&aacute;tico: M&atilde;o na Massa! </a>)</p></li><li class="list-item" id="1568904649#-f21mro_97"><p id="1568904649#-f21mro_101">Melhores Pr&aacute;ticas (<a href="#1223070191">Melhores Pr&aacute;ticas Docker: O Caminho do Mestre </a>)</p></li><li class="list-item" id="1568904649#-f21mro_98"><p id="1568904649#-f21mro_103">Monitoramento Avan&ccedil;ado (<a href="#1175689492">Container Monitoring: Os Olhos do Sistema </a>)</p></li></ol><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1568904649#-f21mro_105"><span class="control" id="1568904649#-f21mro_106">Sensei's Note:</span> &quot;O melhor debug &eacute; aquele que voc&ecirc; n&atilde;o precisa fazer - monitore proativamente!&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="853611488">Arquitetura Docker: O Blueprint da Matrix <span class="no-bold"></span></h1><div class="detached code-block" id="853611488#l9vx8l_3"><pre><code class="language-none">
  DOCKER ARCHITECTURE BLUEPRINT                                        
                                                                       
  Client  Docker Host  Container Runtime  Registry                  
                                                                       
  &quot;A arquitetura que sustenta o multiverso dos containers&quot;            
                                                                       
</code></pre></div><section class="detached"><h2 id="853611488#componentes-principais" data-toc="componentes-principais#docker-architecture.md-componentes-principais">Componentes Principais <span class="no-bold"></span></h2><section class="detached"><h3 id="853611488#1-docker-client" data-toc="1-docker-client#docker-architecture.md-1-docker-client">1. Docker Client</h3><div class="detached code-block" id="853611488#l9vx8l_19"><pre><code class="language-none">
    Docker CLI       

 - docker build     
 - docker pull      
 - docker run       
 - docker push      
</code></pre></div></section><section class="detached"><h3 id="853611488#2-docker-host" data-toc="2-docker-host#docker-architecture.md-2-docker-host">2. Docker Host</h3><div class="detached code-block" id="853611488#l9vx8l_20"><pre><code class="language-none">
           Docker Daemon              

     
  Containers        Images       
     
     
   Volumes         Networks      
     
</code></pre></div></section><section class="detached"><h3 id="853611488#3-container-runtime" data-toc="3-container-runtime#docker-architecture.md-3-container-runtime">3. Container Runtime</h3><div class="detached code-block" id="853611488#l9vx8l_21"><pre><code class="language-none">
 High-Level Runtime (Docker)     

 Container Engine (containerd)   

 Container Runtime (runc)        

 Linux Kernel                    
</code></pre></div></section><section class="detached"><h3 id="853611488#4-registry" data-toc="4-registry#docker-architecture.md-4-registry">4. Registry</h3><div class="detached code-block" id="853611488#l9vx8l_22"><pre><code class="language-none">
  Docker Registry   

 - Docker Hub      
 - Private Registry
 - Mirror Registry 
</code></pre></div></section></section><section class="detached"><h2 id="853611488#fluxo-de-comunica-o" data-toc="fluxo-de-comunica-o#docker-architecture.md-fluxo-de-comunica-o">Fluxo de Comunica&ccedil;&atilde;o <span class="no-bold"></span></h2><section class="detached"><h3 id="853611488#build-flow" data-toc="build-flow#docker-architecture.md-build-flow">Build Flow</h3><div class="detached code-block" id="853611488#l9vx8l_25"><pre><code class="language-none">[Client] build&gt; [Daemon] create&gt; [Image]
                                         
   push
                      
                   [Registry]</code></pre></div></section><section class="detached"><h3 id="853611488#run-flow" data-toc="run-flow#docker-architecture.md-run-flow">Run Flow</h3><div class="detached code-block" id="853611488#l9vx8l_26"><pre><code class="language-none">[Client] run&gt; [Daemon] pull&gt; [Registry]
                    
                    v
              [Container]</code></pre></div></section></section><section class="detached"><h2 id="853611488#componentes-detalhados" data-toc="componentes-detalhados#docker-architecture.md-componentes-detalhados">Componentes Detalhados <span class="no-bold"></span></h2><section class="detached"><h3 id="853611488#docker-daemon-dockerd" data-toc="docker-daemon-dockerd#docker-architecture.md-docker-daemon-dockerd">Docker Daemon (dockerd)</h3><ul class="list" id="853611488#l9vx8l_30" start="1"><li class="list-item" id="853611488#l9vx8l_31"><p id="853611488#l9vx8l_35">Gerencia objetos Docker</p></li><li class="list-item" id="853611488#l9vx8l_32"><p id="853611488#l9vx8l_36">Manipula API requests</p></li><li class="list-item" id="853611488#l9vx8l_33"><p id="853611488#l9vx8l_37">Gerencia containers</p></li><li class="list-item" id="853611488#l9vx8l_34"><p id="853611488#l9vx8l_38">Controla imagens</p></li></ul></section><section class="detached"><h3 id="853611488#containerd" data-toc="containerd#docker-architecture.md-containerd">containerd</h3><ul class="list" id="853611488#l9vx8l_39" start="1"><li class="list-item" id="853611488#l9vx8l_40"><p id="853611488#l9vx8l_44">Gerenciamento de runtime</p></li><li class="list-item" id="853611488#l9vx8l_41"><p id="853611488#l9vx8l_45">Execu&ccedil;&atilde;o de containers</p></li><li class="list-item" id="853611488#l9vx8l_42"><p id="853611488#l9vx8l_46">Gerenciamento de imagens</p></li><li class="list-item" id="853611488#l9vx8l_43"><p id="853611488#l9vx8l_47">Interface com runc</p></li></ul></section><section class="detached"><h3 id="853611488#runc" data-toc="runc#docker-architecture.md-runc">runc</h3><ul class="list" id="853611488#l9vx8l_48" start="1"><li class="list-item" id="853611488#l9vx8l_49"><p id="853611488#l9vx8l_53">Cria&ccedil;&atilde;o de containers</p></li><li class="list-item" id="853611488#l9vx8l_50"><p id="853611488#l9vx8l_54">Implementa&ccedil;&atilde;o OCI</p></li><li class="list-item" id="853611488#l9vx8l_51"><p id="853611488#l9vx8l_55">Interface com kernel</p></li><li class="list-item" id="853611488#l9vx8l_52"><p id="853611488#l9vx8l_56">Isolamento de recursos</p></li></ul></section></section><section class="detached"><h2 id="853611488#waifu-tech-tips" data-toc="waifu-tech-tips#docker-architecture.md-waifu-tech-tips">Waifu Tech Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="853611488#l9vx8l_59"><span class="control" id="853611488#l9vx8l_60">Architecture-chan diz:</span> &quot;Cada componente tem seu papel! Como em um time de idol, todos precisam trabalhar juntos! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="853611488#l9vx8l_61"><span class="control" id="853611488#l9vx8l_62">Runtime-sama alerta:</span> &quot;Nunca subestime o poder do container runtime - ele &eacute; o verdadeiro MVP! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="853611488#diagrama-de-intera-o" data-toc="diagrama-de-intera-o#docker-architecture.md-diagrama-de-intera-o">Diagrama de Intera&ccedil;&atilde;o <span class="no-bold"></span></h2><div class="detached code-block" id="853611488#l9vx8l_63"><pre><code class="language-none">          
  Docker CLI  &gt;Docker Daemon &gt;  containerd  
          
                                                 
                           v                      v
                         
                       Registry            runc      
                         </code></pre></div></section><section class="detached"><h2 id="853611488#seguran-a-e-isolamento" data-toc="seguran-a-e-isolamento#docker-architecture.md-seguran-a-e-isolamento">Seguran&ccedil;a e Isolamento <span class="no-bold"></span></h2><section class="detached"><h3 id="853611488#namespace-isolation" data-toc="namespace-isolation#docker-architecture.md-namespace-isolation">Namespace Isolation</h3><ul class="list" id="853611488#l9vx8l_66" start="1"><li class="list-item" id="853611488#l9vx8l_67"><p id="853611488#l9vx8l_73">PID Namespace</p></li><li class="list-item" id="853611488#l9vx8l_68"><p id="853611488#l9vx8l_74">Network Namespace</p></li><li class="list-item" id="853611488#l9vx8l_69"><p id="853611488#l9vx8l_75">Mount Namespace</p></li><li class="list-item" id="853611488#l9vx8l_70"><p id="853611488#l9vx8l_76">UTS Namespace</p></li><li class="list-item" id="853611488#l9vx8l_71"><p id="853611488#l9vx8l_77">IPC Namespace</p></li><li class="list-item" id="853611488#l9vx8l_72"><p id="853611488#l9vx8l_78">User Namespace</p></li></ul></section><section class="detached"><h3 id="853611488#control-groups-cgroups" data-toc="control-groups-cgroups#docker-architecture.md-control-groups-cgroups">Control Groups (cgroups)</h3><ul class="list" id="853611488#l9vx8l_79" start="1"><li class="list-item" id="853611488#l9vx8l_80"><p id="853611488#l9vx8l_85">CPU</p></li><li class="list-item" id="853611488#l9vx8l_81"><p id="853611488#l9vx8l_86">Memory</p></li><li class="list-item" id="853611488#l9vx8l_82"><p id="853611488#l9vx8l_87">I/O</p></li><li class="list-item" id="853611488#l9vx8l_83"><p id="853611488#l9vx8l_88">Network</p></li><li class="list-item" id="853611488#l9vx8l_84"><p id="853611488#l9vx8l_89">Devices</p></li></ul></section></section><section class="detached"><h2 id="853611488#networking-architecture" data-toc="networking-architecture#docker-architecture.md-networking-architecture">Networking Architecture <span class="no-bold"></span></h2><section class="detached"><h3 id="853611488#default-networks" data-toc="default-networks#docker-architecture.md-default-networks">Default Networks</h3><div class="detached code-block" id="853611488#l9vx8l_92"><pre><code class="language-none">
     bridge      

      host       

      none       
</code></pre></div></section><section class="detached"><h3 id="853611488#custom-networks" data-toc="custom-networks#docker-architecture.md-custom-networks">Custom Networks</h3><ul class="list" id="853611488#l9vx8l_93" start="1"><li class="list-item" id="853611488#l9vx8l_94"><p id="853611488#l9vx8l_98">Bridge</p></li><li class="list-item" id="853611488#l9vx8l_95"><p id="853611488#l9vx8l_99">Overlay</p></li><li class="list-item" id="853611488#l9vx8l_96"><p id="853611488#l9vx8l_100">Macvlan</p></li><li class="list-item" id="853611488#l9vx8l_97"><p id="853611488#l9vx8l_101">IPvlan</p></li></ul></section></section><section class="detached"><h2 id="853611488#storage-architecture" data-toc="storage-architecture#docker-architecture.md-storage-architecture">Storage Architecture <span class="no-bold"></span></h2><section class="detached"><h3 id="853611488#storage-drivers" data-toc="storage-drivers#docker-architecture.md-storage-drivers">Storage Drivers</h3><ul class="list" id="853611488#l9vx8l_104" start="1"><li class="list-item" id="853611488#l9vx8l_105"><p id="853611488#l9vx8l_110">overlay2</p></li><li class="list-item" id="853611488#l9vx8l_106"><p id="853611488#l9vx8l_111">devicemapper</p></li><li class="list-item" id="853611488#l9vx8l_107"><p id="853611488#l9vx8l_112">btrfs</p></li><li class="list-item" id="853611488#l9vx8l_108"><p id="853611488#l9vx8l_113">zfs</p></li><li class="list-item" id="853611488#l9vx8l_109"><p id="853611488#l9vx8l_114">vfs</p></li></ul></section><section class="detached"><h3 id="853611488#volume-types" data-toc="volume-types#docker-architecture.md-volume-types">Volume Types</h3><div class="detached code-block" id="853611488#l9vx8l_115"><pre><code class="language-none">
 Named Volumes   

 Bind Mounts     

 tmpfs Mounts    
</code></pre></div></section></section><section class="detached"><h2 id="853611488#checkpoint" data-toc="checkpoint#docker-architecture.md-checkpoint">Checkpoint <span class="no-bold"></span></h2><p id="853611488#l9vx8l_116">Voc&ecirc; agora entende:</p><ul class="list" id="853611488#l9vx8l_117" start="1"><li class="list-item" id="853611488#l9vx8l_118"><p id="853611488#l9vx8l_124">[x] Componentes principais</p></li><li class="list-item" id="853611488#l9vx8l_119"><p id="853611488#l9vx8l_125">[x] Fluxo de comunica&ccedil;&atilde;o</p></li><li class="list-item" id="853611488#l9vx8l_120"><p id="853611488#l9vx8l_126">[x] Container runtime</p></li><li class="list-item" id="853611488#l9vx8l_121"><p id="853611488#l9vx8l_127">[x] Networking</p></li><li class="list-item" id="853611488#l9vx8l_122"><p id="853611488#l9vx8l_128">[x] Storage</p></li><li class="list-item" id="853611488#l9vx8l_123"><p id="853611488#l9vx8l_129">[x] Seguran&ccedil;a</p></li></ul></section><section class="detached"><h2 id="853611488#pr-ximos-passos" data-toc="pr-ximos-passos#docker-architecture.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="853611488#l9vx8l_130" type="1" start="1"><li class="list-item" id="853611488#l9vx8l_133"><p id="853611488#l9vx8l_136">Container Runtime (<a href="#2096623244">Container Runtime: O Motor dos Containers </a>)</p></li><li class="list-item" id="853611488#l9vx8l_134"><p id="853611488#l9vx8l_138">Networking (<a href="#-1154622528">Container Networking</a>)</p></li><li class="list-item" id="853611488#l9vx8l_135"><p id="853611488#l9vx8l_140">Storage (<a href="#-1338613457">Container Storage: Cr&ocirc;nicas dos Dados Perdidos </a>)</p></li></ol><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="853611488#l9vx8l_142">&quot;A arquitetura &eacute; como um bonsai - cada componente precisa ser cuidadosamente podado e mantido.&quot;</p><ul class="list" id="853611488#l9vx8l_143" start="1"><li class="list-item" id="853611488#l9vx8l_144"><p id="853611488#l9vx8l_145">Docker Architect-sensei, 2025</p></li></ul></div>
</blockquote>
</section><section class="detached"><h2 id="853611488#refer-ncias" data-toc="refer-ncias#docker-architecture.md-refer-ncias">Refer&ecirc;ncias <span class="no-bold"></span></h2><ul class="list" id="853611488#l9vx8l_146" start="1"><li class="list-item" id="853611488#l9vx8l_147"><p id="853611488#l9vx8l_150">Docker Documentation (<a href="https://docs.docker.com">https://docs.docker.com</a>)</p></li><li class="list-item" id="853611488#l9vx8l_148"><p id="853611488#l9vx8l_152">OCI Specification (<a href="https://opencontainers.org">https://opencontainers.org</a>)</p></li><li class="list-item" id="853611488#l9vx8l_149"><p id="853611488#l9vx8l_154">containerd Documentation (<a href="https://containerd.io">https://containerd.io</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1713301678">CLI Basics: Dominando o Terminal Docker <span class="no-bold"></span></h1><div class="detached code-block" id="-1713301678#suum1f_3"><pre><code class="language-none">
 DOCKER CLI COMMAND STRUCTURE                              
                                                          
 docker [options] command [arguments]                      
                                                          
 Examples:                                                
 docker run nginx                                         
 docker container ls                                      
 docker image build .                                     
</code></pre></div><section class="detached"><h2 id="-1713301678#comandos-essenciais" data-toc="comandos-essenciais#cli-basics.md-comandos-essenciais">Comandos Essenciais <span class="no-bold"></span></h2><section class="detached"><h3 id="-1713301678#sistema-e-informa-es" data-toc="sistema-e-informa-es#cli-basics.md-sistema-e-informa-es">Sistema e Informa&ccedil;&otilde;es</h3><div class="detached code-block" id="-1713301678#suum1f_18"><pre><code class="language-bash"># Verificar verso
docker version

# Informaes do sistema
docker info

# Status do daemon
docker system df

# Limpar recursos no utilizados
docker system prune -a</code></pre></div></section><section class="detached"><h3 id="-1713301678#gerenciamento-de-containers" data-toc="gerenciamento-de-containers#cli-basics.md-gerenciamento-de-containers">Gerenciamento de Containers</h3><div class="detached code-block" id="-1713301678#suum1f_19"><pre><code class="language-bash"># Listar containers
docker ps          # Ativos
docker ps -a       # Todos
docker ps -q       # Apenas IDs
docker ps --size   # Com tamanho

# Criar e executar
docker run nginx
docker run -d --name web nginx    # Detached mode
docker run -it ubuntu bash        # Interativo

# Operaes bsicas
docker start web
docker stop web
docker restart web
docker rm web</code></pre></div></section><section class="detached"><h3 id="-1713301678#gerenciamento-de-imagens" data-toc="gerenciamento-de-imagens#cli-basics.md-gerenciamento-de-imagens">Gerenciamento de Imagens</h3><div class="detached code-block" id="-1713301678#suum1f_20"><pre><code class="language-bash"># Listar imagens
docker images
docker image ls

# Baixar imagem
docker pull nginx:latest

# Remover imagem
docker rmi nginx
docker image rm nginx

# Construir imagem
docker build -t app:1.0 .</code></pre></div></section></section><section class="detached"><h2 id="-1713301678#flags-comuns" data-toc="flags-comuns#cli-basics.md-flags-comuns">Flags Comuns <span class="no-bold"></span></h2><section class="detached"><h3 id="-1713301678#run-flags" data-toc="run-flags#cli-basics.md-run-flags">Run Flags</h3><div class="detached code-block" id="-1713301678#suum1f_23"><pre><code class="language-bash"># Portas
-p 8080:80        # Host:Container

# Volumes
-v /host:/container

# Variveis de ambiente
-e MYSQL_ROOT_PASSWORD=secret

# Recursos
--memory 512m
--cpus 2

# Network
--network bridge</code></pre></div></section><section class="detached"><h3 id="-1713301678#formato-de-sa-da" data-toc="formato-de-sa-da#cli-basics.md-formato-de-sa-da">Formato de Sa&iacute;da</h3><div class="detached code-block" id="-1713301678#suum1f_24"><pre><code class="language-bash"># Formatao JSON
docker ps --format '{{json .}}'

# Tabela customizada
docker ps --format 'table {{.ID}}\t{{.Names}}\t{{.Status}}'</code></pre></div></section></section><section class="detached"><h2 id="-1713301678#network-commands" data-toc="network-commands#cli-basics.md-network-commands">Network Commands <span class="no-bold"></span></h2><div class="detached code-block" id="-1713301678#suum1f_25"><pre><code class="language-bash"># Listar redes
docker network ls

# Criar rede
docker network create mynet

# Conectar container
docker network connect mynet container1

# Inspecionar rede
docker network inspect mynet</code></pre></div></section><section class="detached"><h2 id="-1713301678#volume-commands" data-toc="volume-commands#cli-basics.md-volume-commands">Volume Commands <span class="no-bold"></span></h2><div class="detached code-block" id="-1713301678#suum1f_26"><pre><code class="language-bash"># Listar volumes
docker volume ls

# Criar volume
docker volume create mydata

# Inspecionar volume
docker volume inspect mydata

# Remover volume
docker volume rm mydata</code></pre></div></section><section class="detached"><h2 id="-1713301678#logs-e-debug" data-toc="logs-e-debug#cli-basics.md-logs-e-debug">Logs e Debug <span class="no-bold"></span></h2><div class="detached code-block" id="-1713301678#suum1f_27"><pre><code class="language-bash"># Ver logs
docker logs container1
docker logs -f container1    # Follow
docker logs --tail 100 container1

# Executar comando
docker exec -it container1 bash

# Inspecionar container
docker inspect container1</code></pre></div></section><section class="detached"><h2 id="-1713301678#dicas-de-produtividade" data-toc="dicas-de-produtividade#cli-basics.md-dicas-de-produtividade">Dicas de Produtividade <span class="no-bold"></span></h2><section class="detached"><h3 id="-1713301678#aliases-teis" data-toc="aliases-teis#cli-basics.md-aliases-teis">Aliases &Uacute;teis</h3><div class="detached code-block" id="-1713301678#suum1f_30"><pre><code class="language-bash"># Adicione ao seu .bashrc ou .zshrc
alias d='docker'
alias dc='docker-compose'
alias dps='docker ps'
alias dim='docker images'</code></pre></div></section><section class="detached"><h3 id="-1713301678#one-liners-poderosos" data-toc="one-liners-poderosos#cli-basics.md-one-liners-poderosos">One-Liners Poderosos</h3><div class="detached code-block" id="-1713301678#suum1f_31"><pre><code class="language-bash"># Parar todos containers
docker stop $(docker ps -q)

# Remover containers parados
docker container prune

# Remover imagens no utilizadas
docker image prune -a

# Backup de container
docker commit container1 backup/container1</code></pre></div></section></section><section class="detached"><h2 id="-1713301678#waifu-cli-tips" data-toc="waifu-cli-tips#cli-basics.md-waifu-cli-tips">Waifu CLI Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-1713301678#suum1f_34"><span class="control" id="-1713301678#suum1f_35">CLI-chan diz:</span> &quot;Sempre use <span class="inline-code" id="-1713301678#suum1f_36">--help</span> quando precisar! &Eacute; como ter um manual de bolso! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-1713301678#suum1f_37"><span class="control" id="-1713301678#suum1f_38">Terminal-sama alerta:</span> &quot;Cuidado com <span class="inline-code" id="-1713301678#suum1f_39">docker system prune -a</span>! Ele &eacute; tipo um delete sem recovery! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="-1713301678#troubleshooting-common-issues" data-toc="troubleshooting-common-issues#cli-basics.md-troubleshooting-common-issues">Troubleshooting Common Issues <span class="no-bold"></span></h2><div class="table-wrapper detached"><table id="-1713301678#suum1f_40"><tr class="header-row" id="-1713301678#suum1f_41"><th id="-1713301678#suum1f_46"><p>Erro</p></th><th id="-1713301678#suum1f_47"><p>Causa Prov&aacute;vel</p></th><th id="-1713301678#suum1f_48"><p>Solu&ccedil;&atilde;o</p></th></tr><tr class="" id="-1713301678#suum1f_42"><td id="-1713301678#suum1f_49"><p><span class="inline-code" id="-1713301678#suum1f_52">Cannot connect to Docker daemon</span></p></td><td id="-1713301678#suum1f_50"><p>Docker n&atilde;o est&aacute; rodando</p></td><td id="-1713301678#suum1f_51"><p><span class="inline-code" id="-1713301678#suum1f_53">sudo systemctl start docker</span></p></td></tr><tr class="" id="-1713301678#suum1f_43"><td id="-1713301678#suum1f_54"><p><span class="inline-code" id="-1713301678#suum1f_57">Port is already allocated</span></p></td><td id="-1713301678#suum1f_55"><p>Porta em uso</p></td><td id="-1713301678#suum1f_56"><p>Use outra porta ou libere a atual</p></td></tr><tr class="" id="-1713301678#suum1f_44"><td id="-1713301678#suum1f_58"><p><span class="inline-code" id="-1713301678#suum1f_61">No space left on device</span></p></td><td id="-1713301678#suum1f_59"><p>Disco cheio</p></td><td id="-1713301678#suum1f_60"><p><span class="inline-code" id="-1713301678#suum1f_62">docker system prune</span></p></td></tr><tr class="" id="-1713301678#suum1f_45"><td id="-1713301678#suum1f_63"><p><span class="inline-code" id="-1713301678#suum1f_66">Permission denied</span></p></td><td id="-1713301678#suum1f_64"><p>N&atilde;o est&aacute; no grupo docker</p></td><td id="-1713301678#suum1f_65"><p><span class="inline-code" id="-1713301678#suum1f_67">sudo usermod -aG docker $USER</span></p></td></tr></table></div></section><section class="detached"><h2 id="-1713301678#checkpoint" data-toc="checkpoint#cli-basics.md-checkpoint">Checkpoint <span class="no-bold"></span></h2><p id="-1713301678#suum1f_68">Voc&ecirc; agora sabe:</p><ul class="list" id="-1713301678#suum1f_69" start="1"><li class="list-item" id="-1713301678#suum1f_70"><p id="-1713301678#suum1f_77">[x] Estrutura b&aacute;sica dos comandos</p></li><li class="list-item" id="-1713301678#suum1f_71"><p id="-1713301678#suum1f_78">[x] Gerenciar containers</p></li><li class="list-item" id="-1713301678#suum1f_72"><p id="-1713301678#suum1f_79">[x] Gerenciar imagens</p></li><li class="list-item" id="-1713301678#suum1f_73"><p id="-1713301678#suum1f_80">[x] Trabalhar com redes</p></li><li class="list-item" id="-1713301678#suum1f_74"><p id="-1713301678#suum1f_81">[x] Gerenciar volumes</p></li><li class="list-item" id="-1713301678#suum1f_75"><p id="-1713301678#suum1f_82">[x] Debug e logs</p></li><li class="list-item" id="-1713301678#suum1f_76"><p id="-1713301678#suum1f_83">[x] Aliases e produtividade</p></li></ul></section><section class="detached"><h2 id="-1713301678#quick-reference-card" data-toc="quick-reference-card#cli-basics.md-quick-reference-card">Quick Reference Card <span class="no-bold"></span></h2><div class="detached code-block" id="-1713301678#suum1f_84"><pre><code class="language-none">
 DOCKER CLI CHEAT SHEET                            

 docker run      Criar/Executar container         
 docker ps       Listar containers                
 docker images   Listar imagens                   
 docker build    Construir imagem                 
 docker exec     Executar comando                 
 docker logs     Ver logs                         
 docker inspect  Inspecionar objeto               
 docker prune    Limpar recursos                  
</code></pre></div></section><section class="detached"><h2 id="-1713301678#pr-ximos-passos" data-toc="pr-ximos-passos#cli-basics.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="-1713301678#suum1f_85" type="1" start="1"><li class="list-item" id="-1713301678#suum1f_87"><p id="-1713301678#suum1f_92">Docker Commands (<a href="#-271055979">Docker Commands: O Arsenal Completo </a>)</p></li><li class="list-item" id="-1713301678#suum1f_88"><p id="-1713301678#suum1f_94">Docker Images (<a href="#-143566139">Docker Images: Blueprint do Seu Container </a>)</p></li><li class="list-item" id="-1713301678#suum1f_89"><p id="-1713301678#suum1f_96"></p></li><li class="list-item" id="-1713301678#suum1f_90"><p id="-1713301678#suum1f_98"></p></li><li class="list-item" id="-1713301678#suum1f_91"><p id="-1713301678#suum1f_100"></p></li></ol><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-1713301678#suum1f_102"><span class="control" id="-1713301678#suum1f_103">Sensei's Note:</span> &quot;O CLI &eacute; sua espada no mundo Docker. Mantenha-a afiada e saiba quando us&aacute;-la!&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-271055979">Docker Commands: O Arsenal Completo <span class="no-bold"></span></h1><div class="detached code-block" id="-271055979#z2fln3k_3"><pre><code class="language-none">
 DOCKER COMMAND CATEGORIES                                 
                                                          
 Container  Image  Network  Volume  System  Compose  
</code></pre></div><section class="detached"><h2 id="-271055979#container-commands" data-toc="container-commands#docker-commands.md-container-commands">Container Commands <span class="no-bold"></span></h2><section class="detached"><h3 id="-271055979#lifecycle-management" data-toc="lifecycle-management#docker-commands.md-lifecycle-management">Lifecycle Management</h3><div class="detached code-block" id="-271055979#z2fln3k_19"><pre><code class="language-bash"># Criar e Executar
docker run [options] IMAGE
  -d, --detach          # Modo background
  -it                   # Modo interativo
  --name string         # Nome do container
  --rm                  # Remove aps parar
  -p, --publish        # Mapear portas
  -v, --volume         # Montar volume

# Gerenciamento
docker start CONTAINER   # Iniciar
docker stop CONTAINER    # Parar
docker restart CONTAINER # Reiniciar
docker pause CONTAINER   # Pausar
docker unpause CONTAINER # Despausar
docker rm CONTAINER     # Remover</code></pre></div></section><section class="detached"><h3 id="-271055979#monitoramento-e-debug" data-toc="monitoramento-e-debug#docker-commands.md-monitoramento-e-debug">Monitoramento e Debug</h3><div class="detached code-block" id="-271055979#z2fln3k_20"><pre><code class="language-bash"># Status e Logs
docker ps [options]      # Listar containers
docker logs CONTAINER    # Ver logs
docker stats CONTAINER   # Mtricas em tempo real
docker top CONTAINER     # Processos
docker inspect CONTAINER # Info detalhada

# Execuo
docker exec [options] CONTAINER COMMAND
docker attach CONTAINER  # Conectar ao container
docker cp SRC_PATH CONTAINER:DEST_PATH</code></pre></div></section></section><section class="detached"><h2 id="-271055979#image-commands" data-toc="image-commands#docker-commands.md-image-commands">Image Commands <span class="no-bold"></span></h2><section class="detached"><h3 id="-271055979#gerenciamento-de-imagens" data-toc="gerenciamento-de-imagens#docker-commands.md-gerenciamento-de-imagens">Gerenciamento de Imagens</h3><div class="detached code-block" id="-271055979#z2fln3k_22"><pre><code class="language-bash"># Bsico
docker images         # Listar imagens
docker pull IMAGE     # Baixar imagem
docker push IMAGE     # Enviar imagem
docker rmi IMAGE      # Remover imagem

# Build
docker build [options] PATH
  -t, --tag         # Nomear imagem
  -f, --file        # Dockerfile alternativo
  --no-cache        # Ignorar cache

# Anlise
docker history IMAGE # Ver camadas
docker inspect IMAGE # Info detalhada
docker save IMAGE    # Exportar
docker load         # Importar</code></pre></div></section></section><section class="detached"><h2 id="-271055979#network-commands" data-toc="network-commands#docker-commands.md-network-commands">Network Commands <span class="no-bold"></span></h2><section class="detached"><h3 id="-271055979#networking" data-toc="networking#docker-commands.md-networking">Networking</h3><div class="detached code-block" id="-271055979#z2fln3k_24"><pre><code class="language-bash"># Gerenciamento
docker network create  # Criar rede
docker network ls     # Listar redes
docker network rm     # Remover rede
docker network prune  # Limpar no usadas

# Conexes
docker network connect    # Conectar container
docker network disconnect # Desconectar
docker network inspect   # Inspecionar</code></pre></div></section></section><section class="detached"><h2 id="-271055979#volume-commands" data-toc="volume-commands#docker-commands.md-volume-commands">Volume Commands <span class="no-bold"></span></h2><section class="detached"><h3 id="-271055979#storage" data-toc="storage#docker-commands.md-storage">Storage</h3><div class="detached code-block" id="-271055979#z2fln3k_26"><pre><code class="language-bash"># Volumes
docker volume create  # Criar volume
docker volume ls     # Listar volumes
docker volume rm     # Remover volume
docker volume prune  # Limpar no usados

# Inspeo
docker volume inspect # Info detalhada</code></pre></div></section></section><section class="detached"><h2 id="-271055979#system-commands" data-toc="system-commands#docker-commands.md-system-commands">System Commands <span class="no-bold"></span></h2><section class="detached"><h3 id="-271055979#manuten-o" data-toc="manuten-o#docker-commands.md-manuten-o">Manuten&ccedil;&atilde;o</h3><div class="detached code-block" id="-271055979#z2fln3k_28"><pre><code class="language-bash"># Sistema
docker info        # Info do sistema
docker version     # Verso
docker events      # Eventos em tempo real

# Limpeza
docker system prune     # Limpar tudo
docker system df       # Uso de disco
docker system info     # Info do sistema</code></pre></div></section></section><section class="detached"><h2 id="-271055979#compose-commands" data-toc="compose-commands#docker-commands.md-compose-commands">Compose Commands <span class="no-bold"></span></h2><section class="detached"><h3 id="-271055979#orquestra-o" data-toc="orquestra-o#docker-commands.md-orquestra-o">Orquestra&ccedil;&atilde;o</h3><div class="detached code-block" id="-271055979#z2fln3k_30"><pre><code class="language-bash"># Bsico
docker-compose up    # Criar e iniciar
docker-compose down  # Parar e remover
docker-compose ps    # Listar servios

# Lifecycle
docker-compose start  # Iniciar servios
docker-compose stop   # Parar servios
docker-compose restart # Reiniciar</code></pre></div></section></section><section class="detached"><h2 id="-271055979#command-flags-matrix" data-toc="command-flags-matrix#docker-commands.md-command-flags-matrix">Command Flags Matrix <span class="no-bold"></span></h2><div class="table-wrapper detached"><table id="-271055979#z2fln3k_31"><tr class="header-row" id="-271055979#z2fln3k_32"><th id="-271055979#z2fln3k_38"><p>Flag</p></th><th id="-271055979#z2fln3k_39"><p>Uso</p></th><th id="-271055979#z2fln3k_40"><p>Exemplo</p></th></tr><tr class="" id="-271055979#z2fln3k_33"><td id="-271055979#z2fln3k_41"><p><span class="inline-code" id="-271055979#z2fln3k_44">-d</span></p></td><td id="-271055979#z2fln3k_42"><p>Background</p></td><td id="-271055979#z2fln3k_43"><p><span class="inline-code" id="-271055979#z2fln3k_45">docker run -d nginx</span></p></td></tr><tr class="" id="-271055979#z2fln3k_34"><td id="-271055979#z2fln3k_46"><p><span class="inline-code" id="-271055979#z2fln3k_49">-p</span></p></td><td id="-271055979#z2fln3k_47"><p>Portas</p></td><td id="-271055979#z2fln3k_48"><p><span class="inline-code" id="-271055979#z2fln3k_50">docker run -p 80:80 nginx</span></p></td></tr><tr class="" id="-271055979#z2fln3k_35"><td id="-271055979#z2fln3k_51"><p><span class="inline-code" id="-271055979#z2fln3k_54">-v</span></p></td><td id="-271055979#z2fln3k_52"><p>Volumes</p></td><td id="-271055979#z2fln3k_53"><p><span class="inline-code" id="-271055979#z2fln3k_55">docker run -v /host:/container nginx</span></p></td></tr><tr class="" id="-271055979#z2fln3k_36"><td id="-271055979#z2fln3k_56"><p><span class="inline-code" id="-271055979#z2fln3k_59">-e</span></p></td><td id="-271055979#z2fln3k_57"><p>Env vars</p></td><td id="-271055979#z2fln3k_58"><p><span class="inline-code" id="-271055979#z2fln3k_60">docker run -e VAR=value nginx</span></p></td></tr><tr class="" id="-271055979#z2fln3k_37"><td id="-271055979#z2fln3k_61"><p><span class="inline-code" id="-271055979#z2fln3k_64">--rm</span></p></td><td id="-271055979#z2fln3k_62"><p>Auto-remove</p></td><td id="-271055979#z2fln3k_63"><p><span class="inline-code" id="-271055979#z2fln3k_65">docker run --rm alpine</span></p></td></tr></table></div></section><section class="detached"><h2 id="-271055979#one-liners-poderosos" data-toc="one-liners-poderosos#docker-commands.md-one-liners-poderosos">One-Liners Poderosos <span class="no-bold"></span></h2><div class="detached code-block" id="-271055979#z2fln3k_66"><pre><code class="language-bash"># Parar todos containers
docker stop $(docker ps -aq)

# Remover tudo
docker system prune -af --volumes

# Backup de container
docker commit container backup/container:v1

# Container efmero
docker run --rm -it alpine sh</code></pre></div></section><section class="detached"><h2 id="-271055979#waifu-command-tips" data-toc="waifu-command-tips#docker-commands.md-waifu-command-tips">Waifu Command Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-271055979#z2fln3k_69"><span class="control" id="-271055979#z2fln3k_70">Command-chan diz:</span> &quot;Use <span class="inline-code" id="-271055979#z2fln3k_71">--help</span> com qualquer comando para ver todas as op&ccedil;&otilde;es! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-271055979#z2fln3k_72"><span class="control" id="-271055979#z2fln3k_73">Docker-sama alerta:</span> &quot;Cuidado com comandos destrutivos como <span class="inline-code" id="-271055979#z2fln3k_74">prune</span> e <span class="inline-code" id="-271055979#z2fln3k_75">rm -f</span>! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="-271055979#debug-arsenal" data-toc="debug-arsenal#docker-commands.md-debug-arsenal">Debug Arsenal <span class="no-bold"></span></h2><section class="detached"><h3 id="-271055979#troubleshooting-commands" data-toc="troubleshooting-commands#docker-commands.md-troubleshooting-commands">Troubleshooting Commands</h3><div class="detached code-block" id="-271055979#z2fln3k_77"><pre><code class="language-bash"># Logs em tempo real
docker logs -f container

# Mtricas live
docker stats container

# Processos do container
docker top container

# Dump completo
docker inspect container &gt; debug.json</code></pre></div></section></section><section class="detached"><h2 id="-271055979#quick-reference-card" data-toc="quick-reference-card#docker-commands.md-quick-reference-card">Quick Reference Card <span class="no-bold"></span></h2><div class="detached code-block" id="-271055979#z2fln3k_78"><pre><code class="language-none">
 DOCKER COMMANDS CHEAT SHEET                       

 Container  run, ps, start, stop, rm              
 Image     build, pull, push, rmi                
 Network   network create, connect, inspect       
 Volume    volume create, ls, rm                 
 System    info, version, prune                  
 Compose   up, down, ps                          
</code></pre></div></section><section class="detached"><h2 id="-271055979#checkpoint" data-toc="checkpoint#docker-commands.md-checkpoint">Checkpoint <span class="no-bold"></span></h2><p id="-271055979#z2fln3k_79">Voc&ecirc; agora domina:</p><ul class="list" id="-271055979#z2fln3k_80" start="1"><li class="list-item" id="-271055979#z2fln3k_81"><p id="-271055979#z2fln3k_88">[x] Comandos de container</p></li><li class="list-item" id="-271055979#z2fln3k_82"><p id="-271055979#z2fln3k_89">[x] Gerenciamento de imagens</p></li><li class="list-item" id="-271055979#z2fln3k_83"><p id="-271055979#z2fln3k_90">[x] Networking</p></li><li class="list-item" id="-271055979#z2fln3k_84"><p id="-271055979#z2fln3k_91">[x] Volumes</p></li><li class="list-item" id="-271055979#z2fln3k_85"><p id="-271055979#z2fln3k_92">[x] Manuten&ccedil;&atilde;o do sistema</p></li><li class="list-item" id="-271055979#z2fln3k_86"><p id="-271055979#z2fln3k_93">[x] Docker Compose basics</p></li><li class="list-item" id="-271055979#z2fln3k_87"><p id="-271055979#z2fln3k_94">[x] Troubleshooting</p></li></ul></section><section class="detached"><h2 id="-271055979#pr-ximos-passos" data-toc="pr-ximos-passos#docker-commands.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="-271055979#z2fln3k_95" type="1" start="1"><li class="list-item" id="-271055979#z2fln3k_97"><p id="-271055979#z2fln3k_102">Container Operations (<a href="#-672215880">Opera&ccedil;&otilde;es com Containers: O Manual do Operador </a>)</p></li><li class="list-item" id="-271055979#z2fln3k_98"><p id="-271055979#z2fln3k_104"></p></li><li class="list-item" id="-271055979#z2fln3k_99"><p id="-271055979#z2fln3k_106"></p></li><li class="list-item" id="-271055979#z2fln3k_100"><p id="-271055979#z2fln3k_108"></p></li><li class="list-item" id="-271055979#z2fln3k_101"><p id="-271055979#z2fln3k_110"></p></li></ol><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-271055979#z2fln3k_112"><span class="control" id="-271055979#z2fln3k_113">Sensei's Note:</span> &quot;Um verdadeiro mestre Docker conhece seus comandos como um samurai conhece sua espada!&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-143566139">Docker Images: Blueprint do Seu Container <span class="no-bold"></span></h1><div class="detached code-block" id="-143566139#bwm2gw_3"><pre><code class="language-none">
 IMAGE ARCHITECTURE MATRIX                                 
                                                          
    Base Image Layer        [Alpine/Ubuntu/Debian]        
                                                         
    Dependencies Layer      [Runtime/Libraries]           
                                                         
    Application Layer       [Your Code/Apps]              
                                                         
    Configuration Layer     [ENV/Settings]                
                                                         
    Runtime Layer          [CMD/ENTRYPOINT]              
</code></pre></div><section class="detached"><h2 id="-143566139#fundamentos-de-imagens" data-toc="fundamentos-de-imagens#docker-images.md-fundamentos-de-imagens">Fundamentos de Imagens <span class="no-bold"></span></h2><section class="detached"><h3 id="-143566139#conceitos-b-sicos" data-toc="conceitos-b-sicos#docker-images.md-conceitos-b-sicos">Conceitos B&aacute;sicos</h3><ul class="list" id="-143566139#bwm2gw_22" start="1"><li class="list-item" id="-143566139#bwm2gw_23"><p id="-143566139#bwm2gw_29"><span class="control" id="-143566139#bwm2gw_30">Imagem</span>: Template read-only para containers</p></li><li class="list-item" id="-143566139#bwm2gw_24"><p id="-143566139#bwm2gw_31"><span class="control" id="-143566139#bwm2gw_32">Container</span>: Inst&acirc;ncia execut&aacute;vel de uma imagem</p></li><li class="list-item" id="-143566139#bwm2gw_25"><p id="-143566139#bwm2gw_33"><span class="control" id="-143566139#bwm2gw_34">Layer</span>: Camada incremental de mudan&ccedil;as</p></li><li class="list-item" id="-143566139#bwm2gw_26"><p id="-143566139#bwm2gw_35"><span class="control" id="-143566139#bwm2gw_36">Registry</span>: Reposit&oacute;rio de imagens</p></li><li class="list-item" id="-143566139#bwm2gw_27"><p id="-143566139#bwm2gw_37"><span class="control" id="-143566139#bwm2gw_38">Tag</span>: Identificador de vers&atilde;o</p></li><li class="list-item" id="-143566139#bwm2gw_28"><p id="-143566139#bwm2gw_39"><span class="control" id="-143566139#bwm2gw_40">Digest</span>: Hash SHA256 &uacute;nico da imagem</p></li></ul></section><section class="detached"><h3 id="-143566139#tipos-de-imagens" data-toc="tipos-de-imagens#docker-images.md-tipos-de-imagens">Tipos de Imagens</h3><ol class="list list-decimal" id="-143566139#bwm2gw_41" type="1" start="1"><li class="list-item" id="-143566139#bwm2gw_42"><p id="-143566139#bwm2gw_45"><span class="control" id="-143566139#bwm2gw_47">Base Images</span></p><ul class="list" id="-143566139#bwm2gw_46" start="1"><li class="list-item" id="-143566139#bwm2gw_48"><p id="-143566139#bwm2gw_52">Scratch</p></li><li class="list-item" id="-143566139#bwm2gw_49"><p id="-143566139#bwm2gw_53">Alpine (5MB)</p></li><li class="list-item" id="-143566139#bwm2gw_50"><p id="-143566139#bwm2gw_54">Debian Slim (80MB)</p></li><li class="list-item" id="-143566139#bwm2gw_51"><p id="-143566139#bwm2gw_55">Ubuntu (120MB)</p></li></ul></li><li class="list-item" id="-143566139#bwm2gw_43"><p id="-143566139#bwm2gw_56"><span class="control" id="-143566139#bwm2gw_58">Runtime Images</span></p><ul class="list" id="-143566139#bwm2gw_57" start="1"><li class="list-item" id="-143566139#bwm2gw_59"><p id="-143566139#bwm2gw_62">node:alpine</p></li><li class="list-item" id="-143566139#bwm2gw_60"><p id="-143566139#bwm2gw_63">python:slim</p></li><li class="list-item" id="-143566139#bwm2gw_61"><p id="-143566139#bwm2gw_64">openjdk:slim</p></li></ul></li><li class="list-item" id="-143566139#bwm2gw_44"><p id="-143566139#bwm2gw_65"><span class="control" id="-143566139#bwm2gw_67">Application Images</span></p><ul class="list" id="-143566139#bwm2gw_66" start="1"><li class="list-item" id="-143566139#bwm2gw_68"><p id="-143566139#bwm2gw_71">nginx:alpine</p></li><li class="list-item" id="-143566139#bwm2gw_69"><p id="-143566139#bwm2gw_72">postgres:alpine</p></li><li class="list-item" id="-143566139#bwm2gw_70"><p id="-143566139#bwm2gw_73">redis:alpine</p></li></ul></li></ol></section></section><section class="detached"><h2 id="-143566139#anatomia-detalhada" data-toc="anatomia-detalhada#docker-images.md-anatomia-detalhada">Anatomia Detalhada <span class="no-bold"></span></h2><section class="detached"><h3 id="-143566139#sistema-de-camadas" data-toc="sistema-de-camadas#docker-images.md-sistema-de-camadas">Sistema de Camadas</h3><div class="detached code-block" id="-143566139#bwm2gw_76"><pre><code class="language-bash"># Anlise de camadas
docker history --no-trunc nginx:latest

# Metadata detalhada
docker inspect --format='{{.RootFS.Layers}}' nginx:latest

# Exportar imagem
docker save nginx:latest | tar -tvf -</code></pre></div></section><section class="detached"><h3 id="-143566139#estrutura-interna" data-toc="estrutura-interna#docker-images.md-estrutura-interna">Estrutura Interna</h3><div class="detached code-block" id="-143566139#bwm2gw_77"><pre><code class="language-none"># Exemplo de construo em camadas
FROM alpine:3.14
# Layer 1: Base OS

RUN apk add --no-cache python3
# Layer 2: Runtime

COPY ./app /app
# Layer 3: Application

ENV APP_ENV=production
# Layer 4: Configuration

CMD [&quot;python3&quot;, &quot;/app/main.py&quot;]
# Layer 5: Runtime command</code></pre></div></section></section><section class="detached"><h2 id="-143566139#gerenciamento-avan-ado" data-toc="gerenciamento-avan-ado#docker-images.md-gerenciamento-avan-ado">Gerenciamento Avan&ccedil;ado <span class="no-bold"></span></h2><section class="detached"><h3 id="-143566139#image-operations" data-toc="image-operations#docker-images.md-image-operations">Image Operations</h3><div class="detached code-block" id="-143566139#bwm2gw_80"><pre><code class="language-bash"># Criar tag local
docker tag source:latest target:v1.0

# Salvar imagem como tar
docker save myapp:latest &gt; myapp.tar

# Carregar imagem de tar
docker load &lt; myapp.tar

# Filtrar imagens
docker images --filter &quot;dangling=true&quot;
docker images --filter &quot;label=environment=prod&quot;</code></pre></div></section><section class="detached"><h3 id="-143566139#batch-operations" data-toc="batch-operations#docker-images.md-batch-operations">Batch Operations</h3><div class="detached code-block" id="-143566139#bwm2gw_81"><pre><code class="language-bash"># Remover todas imagens no utilizadas
docker image prune --all --force

# Remover por padro
docker images -q &quot;python*&quot; | xargs docker rmi

# Limpar imagens antigas
docker images --format &quot;{{.ID}}\t{{.CreatedAt}}&quot; | sort -k 2 | head -n 5 | cut -f1 | xargs docker rmi</code></pre></div></section></section><section class="detached"><h2 id="-143566139#sistema-de-tags" data-toc="sistema-de-tags#docker-images.md-sistema-de-tags">Sistema de Tags <span class="no-bold"></span></h2><section class="detached"><h3 id="-143566139#conven-es-de-versionamento" data-toc="conven-es-de-versionamento#docker-images.md-conven-es-de-versionamento">Conven&ccedil;&otilde;es de Versionamento</h3><div class="detached code-block" id="-143566139#bwm2gw_83"><pre><code class="language-bash"># Tags especficas
registry.example.com/app:1.0.0
username/app:latest
custom/app:dev-build

# Multi-arquitetura
docker pull --platform linux/amd64 nginx
docker pull --platform linux/arm64 nginx</code></pre></div></section></section><section class="detached"><h2 id="-143566139#boas-pr-ticas" data-toc="boas-pr-ticas#docker-images.md-boas-pr-ticas">Boas Pr&aacute;ticas <span class="no-bold"></span></h2><section class="detached"><h3 id="-143566139#do-s" data-toc="do-s#docker-images.md-do-s">DO's <span class="no-bold"></span></h3><ul class="list" id="-143566139#bwm2gw_86" start="1"><li class="list-item" id="-143566139#bwm2gw_87"><p id="-143566139#bwm2gw_92">Use tags espec&iacute;ficas</p></li><li class="list-item" id="-143566139#bwm2gw_88"><p id="-143566139#bwm2gw_93">Minimize camadas</p></li><li class="list-item" id="-143566139#bwm2gw_89"><p id="-143566139#bwm2gw_94">Otimize cache</p></li><li class="list-item" id="-143566139#bwm2gw_90"><p id="-143566139#bwm2gw_95">Documente depend&ecirc;ncias</p></li><li class="list-item" id="-143566139#bwm2gw_91"><p id="-143566139#bwm2gw_96">Implemente multi-stage builds</p></li></ul></section><section class="detached"><h3 id="-143566139#don-ts" data-toc="don-ts#docker-images.md-don-ts">DON'Ts <span class="no-bold"></span></h3><ul class="list" id="-143566139#bwm2gw_97" start="1"><li class="list-item" id="-143566139#bwm2gw_98"><p id="-143566139#bwm2gw_103">Evite <span class="inline-code" id="-143566139#bwm2gw_104">latest</span> em produ&ccedil;&atilde;o</p></li><li class="list-item" id="-143566139#bwm2gw_99"><p id="-143566139#bwm2gw_105">N&atilde;o armazene secrets</p></li><li class="list-item" id="-143566139#bwm2gw_100"><p id="-143566139#bwm2gw_106">N&atilde;o instale pacotes desnecess&aacute;rios</p></li><li class="list-item" id="-143566139#bwm2gw_101"><p id="-143566139#bwm2gw_107">N&atilde;o ignore <span class="inline-code" id="-143566139#bwm2gw_108">.dockerignore</span></p></li><li class="list-item" id="-143566139#bwm2gw_102"><p id="-143566139#bwm2gw_109">N&atilde;o use imagens n&atilde;o oficiais sem verifica&ccedil;&atilde;o</p></li></ul></section></section><section class="detached"><h2 id="-143566139#image-operations-matrix" data-toc="image-operations-matrix#docker-images.md-image-operations-matrix">Image Operations Matrix <span class="no-bold"></span></h2><div class="table-wrapper detached"><table id="-143566139#bwm2gw_110"><tr class="header-row" id="-143566139#bwm2gw_111"><th id="-143566139#bwm2gw_119"><p>Opera&ccedil;&atilde;o</p></th><th id="-143566139#bwm2gw_120"><p>Comando</p></th><th id="-143566139#bwm2gw_121"><p>Uso Comum</p></th></tr><tr class="" id="-143566139#bwm2gw_112"><td id="-143566139#bwm2gw_122"><p>Build</p></td><td id="-143566139#bwm2gw_123"><p><span class="inline-code" id="-143566139#bwm2gw_125">docker build</span></p></td><td id="-143566139#bwm2gw_124"><p>Criar nova imagem</p></td></tr><tr class="" id="-143566139#bwm2gw_113"><td id="-143566139#bwm2gw_126"><p>Pull</p></td><td id="-143566139#bwm2gw_127"><p><span class="inline-code" id="-143566139#bwm2gw_129">docker pull</span></p></td><td id="-143566139#bwm2gw_128"><p>Baixar do registry</p></td></tr><tr class="" id="-143566139#bwm2gw_114"><td id="-143566139#bwm2gw_130"><p>Push</p></td><td id="-143566139#bwm2gw_131"><p><span class="inline-code" id="-143566139#bwm2gw_133">docker push</span></p></td><td id="-143566139#bwm2gw_132"><p>Enviar para registry</p></td></tr><tr class="" id="-143566139#bwm2gw_115"><td id="-143566139#bwm2gw_134"><p>Tag</p></td><td id="-143566139#bwm2gw_135"><p><span class="inline-code" id="-143566139#bwm2gw_137">docker tag</span></p></td><td id="-143566139#bwm2gw_136"><p>Criar alias/vers&atilde;o</p></td></tr><tr class="" id="-143566139#bwm2gw_116"><td id="-143566139#bwm2gw_138"><p>Remove</p></td><td id="-143566139#bwm2gw_139"><p><span class="inline-code" id="-143566139#bwm2gw_141">docker rmi</span></p></td><td id="-143566139#bwm2gw_140"><p>Deletar imagem</p></td></tr><tr class="" id="-143566139#bwm2gw_117"><td id="-143566139#bwm2gw_142"><p>Inspect</p></td><td id="-143566139#bwm2gw_143"><p><span class="inline-code" id="-143566139#bwm2gw_145">docker inspect</span></p></td><td id="-143566139#bwm2gw_144"><p>Ver metadata</p></td></tr><tr class="" id="-143566139#bwm2gw_118"><td id="-143566139#bwm2gw_146"><p>Prune</p></td><td id="-143566139#bwm2gw_147"><p><span class="inline-code" id="-143566139#bwm2gw_149">docker image prune</span></p></td><td id="-143566139#bwm2gw_148"><p>Limpar n&atilde;o usadas</p></td></tr></table></div></section><section class="detached"><h2 id="-143566139#otimiza-o-de-imagens" data-toc="otimiza-o-de-imagens#docker-images.md-otimiza-o-de-imagens">Otimiza&ccedil;&atilde;o de Imagens <span class="no-bold"></span></h2><section class="detached"><h3 id="-143566139#redu-o-de-tamanho" data-toc="redu-o-de-tamanho#docker-images.md-redu-o-de-tamanho">Redu&ccedil;&atilde;o de Tamanho</h3><div class="detached code-block" id="-143566139#bwm2gw_152"><pre><code class="language-none"># Multi-stage build
FROM node:alpine AS builder
WORKDIR /app
COPY . .
RUN npm ci &amp;&amp; npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html</code></pre></div></section><section class="detached"><h3 id="-143566139#cache-optimization" data-toc="cache-optimization#docker-images.md-cache-optimization">Cache Optimization</h3><div class="detached code-block" id="-143566139#bwm2gw_153"><pre><code class="language-none"># Ordem eficiente
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build</code></pre></div></section></section><section class="detached"><h2 id="-143566139#registry-management" data-toc="registry-management#docker-images.md-registry-management">Registry Management <span class="no-bold"></span></h2><section class="detached"><h3 id="-143566139#docker-hub" data-toc="docker-hub#docker-images.md-docker-hub">Docker Hub</h3><div class="detached code-block" id="-143566139#bwm2gw_155"><pre><code class="language-bash"># Login
docker login [options] [SERVER]

# Logout
docker logout [SERVER]

# Pull de registry privado
docker pull private-registry.com/app:tag</code></pre></div></section></section><section class="detached"><h2 id="-143566139#advanced-security" data-toc="advanced-security#docker-images.md-advanced-security">Advanced Security <span class="no-bold"></span></h2><section class="detached"><h3 id="-143566139#image-signing" data-toc="image-signing#docker-images.md-image-signing">Image Signing</h3><div class="detached code-block" id="-143566139#bwm2gw_158"><pre><code class="language-bash"># Configurar DCT (Docker Content Trust)
export DOCKER_CONTENT_TRUST=1

# Gerar chaves
docker trust key generate mykey

# Assinar imagem
docker trust sign myregistry/myimage:tag

# Verificar assinatura
docker trust inspect --pretty myregistry/myimage:tag</code></pre></div></section><section class="detached"><h3 id="-143566139#security-scanning" data-toc="security-scanning#docker-images.md-security-scanning">Security Scanning</h3><div class="detached code-block" id="-143566139#bwm2gw_159"><pre><code class="language-bash"># Trivy scan
trivy image python:3.9-alpine

# Snyk scan
snyk container test nginx:latest

# Anchore scan
anchore-cli image add nginx:latest
anchore-cli image wait nginx:latest
anchore-cli image vuln nginx:latest os</code></pre></div></section></section><section class="detached"><h2 id="-143566139#monitoring-metrics" data-toc="monitoring-metrics#docker-images.md-monitoring-metrics">Monitoring &amp; Metrics <span class="no-bold"></span></h2><section class="detached"><h3 id="-143566139#image-analytics" data-toc="image-analytics#docker-images.md-image-analytics">Image Analytics</h3><div class="detached code-block" id="-143566139#bwm2gw_162"><pre><code class="language-bash"># Tamanho das camadas
docker history --no-trunc --format &quot;{{.Size}}\t{{.CreatedBy}}&quot; nginx:latest

# Uso de disco
docker system df -v --format &quot;{{.Type}}\t{{.TotalCount}}\t{{.Size}}&quot;

# Cache status
docker builder prune -f --filter until=24h</code></pre></div></section><section class="detached"><h3 id="-143566139#performance-tracking" data-toc="performance-tracking#docker-images.md-performance-tracking">Performance Tracking</h3><div class="detached code-block" id="-143566139#bwm2gw_163"><pre><code class="language-bash"># Build time analysis
time docker build --no-cache .

# Layer size tracking
docker image inspect myapp:latest -f '{{.RootFS.Layers}}'

# Pull time metrics
time docker pull large-image:latest</code></pre></div></section></section><section class="detached"><h2 id="-143566139#advanced-troubleshooting" data-toc="advanced-troubleshooting#docker-images.md-advanced-troubleshooting">Advanced Troubleshooting <span class="no-bold"></span></h2><section class="detached"><h3 id="-143566139#debug-techniques" data-toc="debug-techniques#docker-images.md-debug-techniques">Debug Techniques</h3><div class="detached code-block" id="-143566139#bwm2gw_166"><pre><code class="language-bash"># Debug build
DOCKER_BUILDKIT=1 docker build --progress=plain .

# Layer inspection
docker save myimage:latest | tar -xC /tmp/image-layers

# Network issues
docker pull --verbose registry.example.com/image:tag</code></pre></div></section><section class="detached"><h3 id="-143566139#common-issues-matrix" data-toc="common-issues-matrix#docker-images.md-common-issues-matrix">Common Issues Matrix</h3><div class="table-wrapper detached"><table id="-143566139#bwm2gw_167"><tr class="header-row" id="-143566139#bwm2gw_168"><th id="-143566139#bwm2gw_173"><p>Problema</p></th><th id="-143566139#bwm2gw_174"><p>Diagn&oacute;stico</p></th><th id="-143566139#bwm2gw_175"><p>Solu&ccedil;&atilde;o</p></th></tr><tr class="" id="-143566139#bwm2gw_169"><td id="-143566139#bwm2gw_176"><p>Pull Timeout</p></td><td id="-143566139#bwm2gw_177"><p><span class="inline-code" id="-143566139#bwm2gw_179">docker pull -v</span></p></td><td id="-143566139#bwm2gw_178"><p>Verificar rede/proxy</p></td></tr><tr class="" id="-143566139#bwm2gw_170"><td id="-143566139#bwm2gw_180"><p>Build Failure</p></td><td id="-143566139#bwm2gw_181"><p><span class="inline-code" id="-143566139#bwm2gw_183">--no-cache</span></p></td><td id="-143566139#bwm2gw_182"><p>Limpar cache/deps</p></td></tr><tr class="" id="-143566139#bwm2gw_171"><td id="-143566139#bwm2gw_184"><p>Layer Issues</p></td><td id="-143566139#bwm2gw_185"><p><span class="inline-code" id="-143566139#bwm2gw_187">docker history</span></p></td><td id="-143566139#bwm2gw_186"><p>Otimizar Dockerfile</p></td></tr><tr class="" id="-143566139#bwm2gw_172"><td id="-143566139#bwm2gw_188"><p>Space Issues</p></td><td id="-143566139#bwm2gw_189"><p><span class="inline-code" id="-143566139#bwm2gw_191">docker system df</span></p></td><td id="-143566139#bwm2gw_190"><p>Prune/cleanup</p></td></tr></table></div></section></section><section class="detached"><h2 id="-143566139#automation-ci-cd" data-toc="automation-ci-cd#docker-images.md-automation-ci-cd">Automation &amp; CI/CD <span class="no-bold"></span></h2><section class="detached"><h3 id="-143566139#github-actions" data-toc="github-actions#docker-images.md-github-actions">GitHub Actions</h3><div class="detached code-block" id="-143566139#bwm2gw_194"><pre><code class="language-yaml">name: Docker Build

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: Set up QEMU
        uses: docker/setup-qemu-action@v1
      
      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v1
      
      - name: Login to DockerHub
        uses: docker/login-action@v1
        with:
          username: ${{ secrets.DOCKERHUB_USERNAME }}
          password: ${{ secrets.DOCKERHUB_TOKEN }}
      
      - name: Build and push
        uses: docker/build-push-action@v2
        with:
          context: .
          platforms: linux/amd64,linux/arm64
          push: true
          tags: user/app:latest</code></pre></div></section><section class="detached"><h3 id="-143566139#automated-testing" data-toc="automated-testing#docker-images.md-automated-testing">Automated Testing</h3><div class="detached code-block" id="-143566139#bwm2gw_195"><pre><code class="language-bash"># Test script
#!/bin/bash
set -e

# Build image
docker build -t test-image .

# Run container tests
docker run --rm test-image npm test

# Security scan
trivy image test-image

# Cleanup
docker rmi test-image</code></pre></div></section></section><section class="detached"><h2 id="-143566139#waifu-advanced-tips" data-toc="waifu-advanced-tips#docker-images.md-waifu-advanced-tips">Waifu Advanced Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-143566139#bwm2gw_199"><span class="control" id="-143566139#bwm2gw_200">Registry-chan diz:</span> &quot;Mantenha seus registries organizados como uma cole&ccedil;&atilde;o de mang&aacute;s! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-143566139#bwm2gw_201"><span class="control" id="-143566139#bwm2gw_202">Build-sama alerta:</span> &quot;Multi-stage builds s&atilde;o como transforma&ccedil;&otilde;es de magical girls - mais leves e poderosas! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-143566139#bwm2gw_203"><span class="control" id="-143566139#bwm2gw_204">Cache-kun ensina:</span> &quot;Cache &eacute; como um bento box - organize bem para reutilizar depois! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="-143566139#quick-reference-pro" data-toc="quick-reference-pro#docker-images.md-quick-reference-pro">Quick Reference Pro <span class="no-bold"></span></h2><div class="detached code-block" id="-143566139#bwm2gw_205"><pre><code class="language-none">
 ADVANCED IMAGE MANAGEMENT                          

 Multi-arch  docker buildx build --platform all    
 Sign        docker trust sign image:tag          
 Scan        trivy image nginx:latest             
 Analyze     docker history --no-trunc image      
 Debug       DOCKER_BUILDKIT=1 docker build .     
 Optimize    docker build --squash .              
 Monitor     docker events --filter type=image    
</code></pre></div></section><section class="detached"><h2 id="-143566139#advanced-checkpoint" data-toc="advanced-checkpoint#docker-images.md-advanced-checkpoint">Advanced Checkpoint <span class="no-bold"></span></h2><p id="-143566139#bwm2gw_206">Voc&ecirc; agora domina:</p><ul class="list" id="-143566139#bwm2gw_207" start="1"><li class="list-item" id="-143566139#bwm2gw_208"><p id="-143566139#bwm2gw_215">[x] Arquitetura interna de imagens</p></li><li class="list-item" id="-143566139#bwm2gw_209"><p id="-143566139#bwm2gw_216">[x] Multi-stage builds avan&ccedil;ados</p></li><li class="list-item" id="-143566139#bwm2gw_210"><p id="-143566139#bwm2gw_217">[x] Registry privado e autentica&ccedil;&atilde;o</p></li><li class="list-item" id="-143566139#bwm2gw_211"><p id="-143566139#bwm2gw_218">[x] Signing e scanning</p></li><li class="list-item" id="-143566139#bwm2gw_212"><p id="-143566139#bwm2gw_219">[x] Debug e troubleshooting</p></li><li class="list-item" id="-143566139#bwm2gw_213"><p id="-143566139#bwm2gw_220">[x] CI/CD integration</p></li><li class="list-item" id="-143566139#bwm2gw_214"><p id="-143566139#bwm2gw_221">[x] Performance optimization</p></li></ul></section><section class="detached"><h2 id="-143566139#next-level-steps" data-toc="next-level-steps#docker-images.md-next-level-steps">Next Level Steps <span class="no-bold"></span></h2><ol class="list list-decimal" id="-143566139#bwm2gw_222" type="1" start="1"><li class="list-item" id="-143566139#bwm2gw_224"><p id="-143566139#bwm2gw_229"></p></li><li class="list-item" id="-143566139#bwm2gw_225"><p id="-143566139#bwm2gw_231"></p></li><li class="list-item" id="-143566139#bwm2gw_226"><p id="-143566139#bwm2gw_233"></p></li><li class="list-item" id="-143566139#bwm2gw_227"><p id="-143566139#bwm2gw_235"></p></li><li class="list-item" id="-143566139#bwm2gw_228"><p id="-143566139#bwm2gw_237"></p></li></ol><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-143566139#bwm2gw_239"><span class="control" id="-143566139#bwm2gw_240">Sensei's Final Note:</span> &quot;Uma imagem Docker &eacute; como um kata perfeito - cada movimento tem prop&oacute;sito, precis&atilde;o e efici&ecirc;ncia! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="91498782">Ciclo de Vida dos Containers: Do Nascimento &agrave; Transcend&ecirc;ncia <span class="no-bold"></span></h1><div class="detached code-block" id="91498782#z6ck9hj_3"><pre><code class="language-none">
 CONTAINER LIFECYCLE STATES                                
                                                          
    created  running  paused                       
                                                       
                  stopped                          
                                                        
         removed                         
                                                          
</code></pre></div><section class="detached"><h2 id="91498782#estados-fundamentais" data-toc="estados-fundamentais#container-lifecycle.md-estados-fundamentais">Estados Fundamentais <span class="no-bold"></span></h2><section class="detached"><h3 id="91498782#1-created" data-toc="1-created#container-lifecycle.md-1-created">1. Created</h3><div class="detached code-block" id="91498782#z6ck9hj_20"><pre><code class="language-bash"># Criar container sem iniciar
docker create --name meu-container nginx

# Verificar estado
docker ps -a | grep meu-container

# Criar com configuraes especficas
docker create \
  --name web-app \
  --memory 512m \
  --cpus 2 \
  --network bridge \
  nginx:latest</code></pre></div></section><section class="detached"><h3 id="91498782#2-running" data-toc="2-running#container-lifecycle.md-2-running">2. Running</h3><div class="detached code-block" id="91498782#z6ck9hj_21"><pre><code class="language-bash"># Iniciar container
docker start meu-container

# Criar e iniciar imediatamente
docker run -d --name outro-container nginx

# Executar com limites e variveis
docker run -d \
  --name app \
  -p 8080:80 \
  -v /data:/app/data \
  -e NODE_ENV=production \
  --restart unless-stopped \
  node:alpine</code></pre></div></section><section class="detached"><h3 id="91498782#3-paused" data-toc="3-paused#container-lifecycle.md-3-paused">3. Paused</h3><div class="detached code-block" id="91498782#z6ck9hj_22"><pre><code class="language-bash"># Pausar container
docker pause meu-container

# Despausar container
docker unpause meu-container

# Pausar mltiplos containers
docker pause $(docker ps -q)</code></pre></div></section><section class="detached"><h3 id="91498782#4-stopped" data-toc="4-stopped#container-lifecycle.md-4-stopped">4. Stopped</h3><div class="detached code-block" id="91498782#z6ck9hj_23"><pre><code class="language-bash"># Parar container gracefully
docker stop meu-container

# Parar container imediatamente
docker kill meu-container

# Parar com timeout personalizado
docker stop --time 30 meu-container</code></pre></div></section><section class="detached"><h3 id="91498782#5-removed" data-toc="5-removed#container-lifecycle.md-5-removed">5. Removed</h3><div class="detached code-block" id="91498782#z6ck9hj_24"><pre><code class="language-bash"># Remover container parado
docker rm meu-container

# Forar remoo
docker rm -f meu-container

# Remover todos containers parados
docker container prune</code></pre></div></section></section><section class="detached"><h2 id="91498782#transi-es-de-estado-avan-adas" data-toc="transi-es-de-estado-avan-adas#container-lifecycle.md-transi-es-de-estado-avan-adas">Transi&ccedil;&otilde;es de Estado Avan&ccedil;adas <span class="no-bold"></span></h2><section class="detached"><h3 id="91498782#restart-policies" data-toc="restart-policies#container-lifecycle.md-restart-policies">Restart Policies</h3><div class="detached code-block" id="91498782#z6ck9hj_27"><pre><code class="language-bash"># No - no reinicia automaticamente
docker run --restart no nginx

# Always - sempre reinicia
docker run --restart always nginx

# On-failure - reinicia em caso de erro
docker run --restart on-failure:3 nginx

# Unless-stopped - reinicia exceto se parado manualmente
docker run --restart unless-stopped nginx</code></pre></div></section><section class="detached"><h3 id="91498782#gerenciamento-de-recursos" data-toc="gerenciamento-de-recursos#container-lifecycle.md-gerenciamento-de-recursos">Gerenciamento de Recursos</h3><div class="detached code-block" id="91498782#z6ck9hj_28"><pre><code class="language-bash"># Limitar memria e CPU
docker run \
  --memory 512m \
  --memory-swap 1g \
  --cpus 2 \
  --cpu-shares 1024 \
  nginx

# Atualizar limites em runtime
docker update \
  --memory 1g \
  --cpus 4 \
  container_id</code></pre></div></section></section><section class="detached"><h2 id="91498782#monitoramento-avan-ado" data-toc="monitoramento-avan-ado#container-lifecycle.md-monitoramento-avan-ado">Monitoramento Avan&ccedil;ado <span class="no-bold"></span></h2><section class="detached"><h3 id="91498782#eventos-detalhados" data-toc="eventos-detalhados#container-lifecycle.md-eventos-detalhados">Eventos Detalhados</h3><div class="detached code-block" id="91498782#z6ck9hj_31"><pre><code class="language-bash"># Monitorar eventos especficos
docker events \
  --filter 'type=container' \
  --filter 'event=start' \
  --filter 'event=die' \
  --filter 'event=stop' \
  --format '{{.Time}} {{.Actor.ID}} {{.Action}}'

# Stream de eventos em JSON
docker events --format '{{json .}}'</code></pre></div></section><section class="detached"><h3 id="91498782#m-tricas-em-tempo-real" data-toc="m-tricas-em-tempo-real#container-lifecycle.md-m-tricas-em-tempo-real">M&eacute;tricas em Tempo Real</h3><div class="detached code-block" id="91498782#z6ck9hj_32"><pre><code class="language-bash"># Stats formatados
docker stats --format &quot;table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}\t{{.NetIO}}&quot;

# Stats especficos
docker stats \
  --no-stream \
  --format &quot;{{.Container}}: CPU={{.CPUPerc}} MEM={{.MemPerc}}&quot;</code></pre></div></section></section><section class="detached"><h2 id="91498782#health-checks-avan-ados" data-toc="health-checks-avan-ados#container-lifecycle.md-health-checks-avan-ados">Health Checks Avan&ccedil;ados <span class="no-bold"></span></h2><section class="detached"><h3 id="91498782#configura-o-detalhada" data-toc="configura-o-detalhada#container-lifecycle.md-configura-o-detalhada">Configura&ccedil;&atilde;o Detalhada</h3><div class="detached code-block" id="91498782#z6ck9hj_35"><pre><code class="language-bash"># Health check com mltiplas condies
docker run -d \
  --name web \
  --health-cmd=&quot;curl -f http://localhost/ || exit 1&quot; \
  --health-interval=5s \
  --health-retries=3 \
  --health-timeout=2s \
  --health-start-period=30s \
  nginx

# Health check via shell script
docker run -d \
  --health-cmd='sh -c &quot;curl -f http://localhost/ || exit 1&quot;' \
  nginx</code></pre></div></section><section class="detached"><h3 id="91498782#monitoramento-de-sa-de" data-toc="monitoramento-de-sa-de#container-lifecycle.md-monitoramento-de-sa-de">Monitoramento de Sa&uacute;de</h3><div class="detached code-block" id="91498782#z6ck9hj_36"><pre><code class="language-bash"># Verificar status detalhado
docker inspect \
  --format='{{json .State.Health}}' \
  container_id | jq

# Histrico de checks
docker inspect \
  --format='{{range .State.Health.Log}}{{.Start}}: {{.ExitCode}}{{&quot;\n&quot;}}{{end}}' \
  container_id</code></pre></div></section></section><section class="detached"><h2 id="91498782#logging-avan-ado" data-toc="logging-avan-ado#container-lifecycle.md-logging-avan-ado">Logging Avan&ccedil;ado <span class="no-bold"></span></h2><section class="detached"><h3 id="91498782#configura-o-de-logs" data-toc="configura-o-de-logs#container-lifecycle.md-configura-o-de-logs">Configura&ccedil;&atilde;o de Logs</h3><div class="detached code-block" id="91498782#z6ck9hj_39"><pre><code class="language-bash"># Configurar driver de log
docker run \
  --log-driver json-file \
  --log-opt max-size=10m \
  --log-opt max-file=3 \
  nginx

# Usar driver syslog
docker run \
  --log-driver syslog \
  --log-opt syslog-address=udp://logserver:514 \
  nginx</code></pre></div></section><section class="detached"><h3 id="91498782#coleta-de-logs" data-toc="coleta-de-logs#container-lifecycle.md-coleta-de-logs">Coleta de Logs</h3><div class="detached code-block" id="91498782#z6ck9hj_40"><pre><code class="language-bash"># Logs com timestamp
docker logs --timestamps container_id

# Logs desde especfico timestamp
docker logs --since 2023-01-01T00:00:00 container_id

# Logs em formato JSON
docker logs --details container_id</code></pre></div></section></section><section class="detached"><h2 id="91498782#automa-o-e-orquestra-o" data-toc="automa-o-e-orquestra-o#container-lifecycle.md-automa-o-e-orquestra-o">Automa&ccedil;&atilde;o e Orquestra&ccedil;&atilde;o <span class="no-bold"></span></h2><section class="detached"><h3 id="91498782#scripts-de-manuten-o-avan-ados" data-toc="scripts-de-manuten-o-avan-ados#container-lifecycle.md-scripts-de-manuten-o-avan-ados">Scripts de Manuten&ccedil;&atilde;o Avan&ccedil;ados</h3><div class="detached code-block" id="91498782#z6ck9hj_43"><pre><code class="language-bash">#!/bin/bash

# Reiniciar containers com base em uso de memria
docker stats --no-stream --format &quot;{{.Container}} {{.MemPerc}}&quot; | \
while read container memory; do
  if [ &quot;${memory%.*}&quot; -gt 90 ]; then
    echo &quot;Reiniciando $container (Memria: $memory)&quot;
    docker restart $container
  fi
done

# Backup de containers
for container in $(docker ps -q); do
  name=$(docker inspect --format='{{.Name}}' $container | sed 's/\///')
  docker commit $container &quot;${name}_backup&quot;
  docker save &quot;${name}_backup&quot; &gt; &quot;${name}_$(date +%Y%m%d).tar&quot;
done</code></pre></div></section><section class="detached"><h3 id="91498782#integra-o-com-docker-compose" data-toc="integra-o-com-docker-compose#container-lifecycle.md-integra-o-com-docker-compose">Integra&ccedil;&atilde;o com Docker Compose</h3><div class="detached code-block" id="91498782#z6ck9hj_44"><pre><code class="language-yaml">version: '3.8'
services:
  web:
    image: nginx
    deploy:
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
        window: 120s
    healthcheck:
      test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost&quot;]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s</code></pre></div></section></section><section class="detached"><h2 id="91498782#troubleshooting-matrix" data-toc="troubleshooting-matrix#container-lifecycle.md-troubleshooting-matrix">Troubleshooting Matrix <span class="no-bold"></span></h2><section class="detached"><h3 id="91498782#problemas-comuns" data-toc="problemas-comuns#container-lifecycle.md-problemas-comuns">Problemas Comuns</h3><div class="table-wrapper detached"><table id="91498782#z6ck9hj_47"><tr class="header-row" id="91498782#z6ck9hj_48"><th id="91498782#z6ck9hj_53"><p>Problema</p></th><th id="91498782#z6ck9hj_54"><p>Sintoma</p></th><th id="91498782#z6ck9hj_55"><p>Solu&ccedil;&atilde;o</p></th><th id="91498782#z6ck9hj_56"><p>Comando</p></th></tr><tr class="" id="91498782#z6ck9hj_49"><td id="91498782#z6ck9hj_57"><p>OOM Kill</p></td><td id="91498782#z6ck9hj_58"><p>Container morre</p></td><td id="91498782#z6ck9hj_59"><p>Aumentar mem&oacute;ria</p></td><td id="91498782#z6ck9hj_60"><p><span class="inline-code" id="91498782#z6ck9hj_61">docker update --memory 1g</span></p></td></tr><tr class="" id="91498782#z6ck9hj_50"><td id="91498782#z6ck9hj_62"><p>CPU Alto</p></td><td id="91498782#z6ck9hj_63"><p>Performance baixa</p></td><td id="91498782#z6ck9hj_64"><p>Limitar CPU</p></td><td id="91498782#z6ck9hj_65"><p><span class="inline-code" id="91498782#z6ck9hj_66">docker update --cpus 2</span></p></td></tr><tr class="" id="91498782#z6ck9hj_51"><td id="91498782#z6ck9hj_67"><p>Zombie Process</p></td><td id="91498782#z6ck9hj_68"><p>Processos &oacute;rf&atilde;os</p></td><td id="91498782#z6ck9hj_69"><p>Reiniciar container</p></td><td id="91498782#z6ck9hj_70"><p><span class="inline-code" id="91498782#z6ck9hj_71">docker restart</span></p></td></tr><tr class="" id="91498782#z6ck9hj_52"><td id="91498782#z6ck9hj_72"><p>Network Issue</p></td><td id="91498782#z6ck9hj_73"><p>Sem conectividade</p></td><td id="91498782#z6ck9hj_74"><p>Recriar rede</p></td><td id="91498782#z6ck9hj_75"><p><span class="inline-code" id="91498782#z6ck9hj_76">docker network reconnect</span></p></td></tr></table></div></section><section class="detached"><h3 id="91498782#debug-commands" data-toc="debug-commands#container-lifecycle.md-debug-commands">Debug Commands</h3><div class="detached code-block" id="91498782#z6ck9hj_77"><pre><code class="language-bash"># Inspecionar processo init
docker top container_id

# Ver alteraes no filesystem
docker diff container_id

# Debug de rede
docker exec container_id netstat -tulpn</code></pre></div></section></section><section class="detached"><h2 id="91498782#lifecycle-hooks" data-toc="lifecycle-hooks#container-lifecycle.md-lifecycle-hooks">Lifecycle Hooks <span class="no-bold"></span></h2><section class="detached"><h3 id="91498782#pre-start-hook" data-toc="pre-start-hook#container-lifecycle.md-pre-start-hook">Pre-start Hook</h3><div class="detached code-block" id="91498782#z6ck9hj_80"><pre><code class="language-bash">docker run \
  --hook-spec='{&quot;prestart&quot;: [{&quot;path&quot;: &quot;/usr/local/bin/prestart.sh&quot;}]}' \
  nginx</code></pre></div></section><section class="detached"><h3 id="91498782#post-stop-hook" data-toc="post-stop-hook#container-lifecycle.md-post-stop-hook">Post-stop Hook</h3><div class="detached code-block" id="91498782#z6ck9hj_81"><pre><code class="language-bash">docker run \
  --hook-spec='{&quot;poststop&quot;: [{&quot;path&quot;: &quot;/usr/local/bin/cleanup.sh&quot;}]}' \
  nginx</code></pre></div></section></section><section class="detached"><h2 id="91498782#waifu-container-tips" data-toc="waifu-container-tips#container-lifecycle.md-waifu-container-tips">Waifu Container Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="91498782#z6ck9hj_85"><span class="control" id="91498782#z6ck9hj_86">Lifecycle-chan diz:</span> &quot;Containers s&atilde;o ef&ecirc;meros! Trate-os como borboletas digitais! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="91498782#z6ck9hj_87"><span class="control" id="91498782#z6ck9hj_88">State-sama alerta:</span> &quot;Sempre use stop antes de rm para um graceful shutdown! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="91498782#z6ck9hj_89"><span class="control" id="91498782#z6ck9hj_90">Debug-chan sugere:</span> &quot;Logs s&atilde;o como pegadas digitais - siga-as para encontrar problemas! <span class="no-bold"></span>&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="91498782#checkpoint-final" data-toc="checkpoint-final#container-lifecycle.md-checkpoint-final">Checkpoint Final <span class="no-bold"></span></h2><p id="91498782#z6ck9hj_91">Voc&ecirc; agora domina:</p><ul class="list" id="91498782#z6ck9hj_92" start="1"><li class="list-item" id="91498782#z6ck9hj_93"><p id="91498782#z6ck9hj_101">[x] Estados e transi&ccedil;&otilde;es dos containers</p></li><li class="list-item" id="91498782#z6ck9hj_94"><p id="91498782#z6ck9hj_102">[x] Pol&iacute;ticas de restart</p></li><li class="list-item" id="91498782#z6ck9hj_95"><p id="91498782#z6ck9hj_103">[x] Monitoramento avan&ccedil;ado</p></li><li class="list-item" id="91498782#z6ck9hj_96"><p id="91498782#z6ck9hj_104">[x] Health checks</p></li><li class="list-item" id="91498782#z6ck9hj_97"><p id="91498782#z6ck9hj_105">[x] Logging</p></li><li class="list-item" id="91498782#z6ck9hj_98"><p id="91498782#z6ck9hj_106">[x] Automa&ccedil;&atilde;o</p></li><li class="list-item" id="91498782#z6ck9hj_99"><p id="91498782#z6ck9hj_107">[x] Troubleshooting</p></li><li class="list-item" id="91498782#z6ck9hj_100"><p id="91498782#z6ck9hj_108">[x] Lifecycle hooks</p></li></ul></section><section class="detached"><h2 id="91498782#pr-ximos-passos" data-toc="pr-ximos-passos#container-lifecycle.md-pr-ximos-passos">Pr&oacute;ximos Passos <span class="no-bold"></span></h2><ol class="list list-decimal" id="91498782#z6ck9hj_109" type="1" start="1"><li class="list-item" id="91498782#z6ck9hj_111"><p id="91498782#z6ck9hj_116">Container Operations (<a href="#-672215880">Opera&ccedil;&otilde;es com Containers: O Manual do Operador </a>)</p></li><li class="list-item" id="91498782#z6ck9hj_112"><p id="91498782#z6ck9hj_118">Container Runtime (<a href="#2096623244">Container Runtime: O Motor dos Containers </a>)</p></li><li class="list-item" id="91498782#z6ck9hj_113"><p id="91498782#z6ck9hj_120">Container Monitoring (<a href="#1175689492">Container Monitoring: Os Olhos do Sistema </a>)</p></li><li class="list-item" id="91498782#z6ck9hj_114"><p id="91498782#z6ck9hj_122">Container Networking (<a href="#-1154622528">Container Networking</a>)</p></li><li class="list-item" id="91498782#z6ck9hj_115"><p id="91498782#z6ck9hj_124">Container Security (<a href="#684732172">Seguran&ccedil;a de Containers </a>)</p></li></ol><blockquote class="prompt flex bordered-element-rounded note detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9zM10.5 7.5A1.5 1.5 0 1 0 12 6a1.5 1.5 0 0 0-1.5 1.5zm-.5 3.54v1h1V18h2v-6a.96.96 0 0 0-.96-.96z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="91498782#z6ck9hj_126"><span class="control" id="91498782#z6ck9hj_127">Sensei's Note:</span> &quot;Dominar o ciclo de vida dos containers &eacute; como se tornar um mestre Jedi - requer paci&ecirc;ncia, pr&aacute;tica e sabedoria.&quot;</p></div>
</blockquote>
</section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1154622528">Container Networking</h1><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-1154622528#-tyyazf_12">&quot;Em um mundo onde bits dan&ccedil;am atrav&eacute;s de cabos et&eacute;reos e pacotes viajam na velocidade da luz, eis que surge a mais intrigante das artes: a networking de containers.&quot; - Manifesto de um SRE Desiludido</p></div>
</blockquote>
<section class="detached"><h2 id="-1154622528#a-anatomia-do-caos-digital" data-toc="a-anatomia-do-caos-digital#container-networking.md-a-anatomia-do-caos-digital">A Anatomia do Caos Digital <span class="no-bold"></span></h2><p id="-1154622528#-tyyazf_13">Ah, caro leitor! Permita-me gui&aacute;-lo atrav&eacute;s deste labirinto digital onde containers, qual habitantes de uma metr&oacute;pole cyberpunk, comunicam-se atrav&eacute;s de pontes invis&iacute;veis e t&uacute;neis et&eacute;reos.</p><section class="detached"><h3 id="-1154622528#o-teatro-das-sombras-digitais" data-toc="o-teatro-das-sombras-digitais#container-networking.md-o-teatro-das-sombras-digitais">O Teatro das Sombras Digitais</h3><div class="detached code-block" id="-1154622528#-tyyazf_16"><pre><code class="language-none">
         A MATRIX DOS CONTAINERS   
     
                           
[Container A]  [Container B]
                       
                       
                       
[Network Namespace]  [Network Bridge]
          
     [Host Network]
 &quot;Onde os pacotes vo para morrer&quot;</code></pre></div><p id="-1154622528#-tyyazf_17">Imagine, se puder, um teatro onde cada container &eacute; um ator mascarado, interpretando seu papel em um palco virtual. Cada um possui sua pr&oacute;pria identidade (IP), seu pr&oacute;prio camarim (namespace), e suas pr&oacute;prias linhas de comunica&ccedil;&atilde;o (veth pairs).</p></section><section class="detached"><h3 id="-1154622528#os-fantasmas-da-m-quina" data-toc="os-fantasmas-da-m-quina#container-networking.md-os-fantasmas-da-m-quina">Os Fantasmas da M&aacute;quina</h3><ul class="list" id="-1154622528#-tyyazf_18" start="1"><li class="list-item" id="-1154622528#-tyyazf_19"><p id="-1154622528#-tyyazf_22"><span class="control" id="-1154622528#-tyyazf_23">Network Namespaces</span>: Como apartamentos em um arranha-c&eacute;u cyberpunk, cada container possui seu pr&oacute;prio espa&ccedil;o isolado. &quot;Meu IP, minhas regras!&quot;</p></li><li class="list-item" id="-1154622528#-tyyazf_20"><p id="-1154622528#-tyyazf_24"><span class="control" id="-1154622528#-tyyazf_25">Bridges Virtuais</span>: Pontes suspensas no vazio digital, conectando realidades paralelas. &quot;A ponte para lugar nenhum, e ao mesmo tempo, para todo lugar.&quot;</p></li><li class="list-item" id="-1154622528#-tyyazf_21"><p id="-1154622528#-tyyazf_26"><span class="control" id="-1154622528#-tyyazf_27">veth pairs</span>: Cord&otilde;es umbilicais digitais, nutrido bits e bytes. &quot;Unidos na vida, unidos na morte.&quot;</p></li></ul></section></section><section class="detached"><h2 id="-1154622528#os-drivers-pilotos-do-submundo-digital" data-toc="os-drivers-pilotos-do-submundo-digital#container-networking.md-os-drivers-pilotos-do-submundo-digital">Os Drivers: Pilotos do Submundo Digital <span class="no-bold"></span></h2><section class="detached"><h3 id="-1154622528#bridge-network-o-submundo-comum" data-toc="bridge-network-o-submundo-comum#container-networking.md-bridge-network-o-submundo-comum">Bridge Network: O Submundo Comum</h3><p id="-1154622528#-tyyazf_32">Como becos escuros de uma cidade neon, a bridge network &eacute; onde a maioria dos containers vive - n&atilde;o &eacute; bonito, mas &eacute; funcional.</p><div class="detached code-block" id="-1154622528#-tyyazf_33"><pre><code class="language-none">
  BRIDGE NETWORK: O GUETO DIGITAL  

          
  Bot     Bot     Bot       
  #127    #254    #666      
          
             
        [Bridge-01]                
</code></pre></div></section><section class="detached"><h3 id="-1154622528#host-network-a-liberdade-perigosa" data-toc="host-network-a-liberdade-perigosa#container-networking.md-host-network-a-liberdade-perigosa">Host Network: A Liberdade Perigosa</h3><p id="-1154622528#-tyyazf_34">Ah, a rede do host! Como um mergulho sem paraquedas em Neo-Tokyo. Performance m&aacute;xima, seguran&ccedil;a m&iacute;nima. Viva perigosamente!</p><div class="detached code-block" id="-1154622528#-tyyazf_35"><pre><code class="language-bash"># Para os corajosos (ou loucos)
docker run --network host nginx
# &quot;Quem precisa de isolamento quando se tem velocidade?&quot; - DevOps antes do incidente</code></pre></div></section><section class="detached"><h3 id="-1154622528#overlay-network-a-teia-da-ilus-o" data-toc="overlay-network-a-teia-da-ilus-o#container-networking.md-overlay-network-a-teia-da-ilus-o">Overlay Network: A Teia da Ilus&atilde;o</h3><p id="-1154622528#-tyyazf_36">Multi-host networking, ou como gosto de chamar: &quot;A arte de fazer containers acreditarem que est&atilde;o na mesma rede quando, na verdade, est&atilde;o separados por um abismo digital.&quot;</p><section class="detached"><h4 id="-1154622528#configura-o-multi-host" data-toc="configura-o-multi-host#container-networking.md-configura-o-multi-host">Configura&ccedil;&atilde;o Multi-host</h4><div class="detached code-block" id="-1154622528#-tyyazf_38"><pre><code class="language-bash"># Inicializar swarm
docker swarm init

# Criar rede overlay
docker network create \
  --driver overlay \
  --attachable \
  --subnet=10.0.9.0/24 \
  --gateway=10.0.9.1 \
  overlay_net

# Criptografia
docker network create \
  --driver overlay \
  --opt encrypted=true \
  secure_overlay</code></pre></div></section></section><section class="detached"><h3 id="-1154622528#macvlan" data-toc="macvlan#container-networking.md-macvlan">Macvlan</h3><ul class="list" id="-1154622528#-tyyazf_39" start="1"><li class="list-item" id="-1154622528#-tyyazf_41"><p id="-1154622528#-tyyazf_44">Interfaces MAC dedicadas</p></li><li class="list-item" id="-1154622528#-tyyazf_42"><p id="-1154622528#-tyyazf_45">Performance pr&oacute;xima ao bare metal</p></li><li class="list-item" id="-1154622528#-tyyazf_43"><p id="-1154622528#-tyyazf_46">Integra&ccedil;&atilde;o com redes f&iacute;sicas</p></li></ul><section class="detached"><h4 id="-1154622528#modos-de-opera-o" data-toc="modos-de-opera-o#container-networking.md-modos-de-opera-o">Modos de Opera&ccedil;&atilde;o</h4><div class="detached code-block" id="-1154622528#-tyyazf_47"><pre><code class="language-bash"># Modo Bridge
docker network create -d macvlan \
  --subnet=192.168.32.0/24 \
  --gateway=192.168.32.1 \
  -o parent=eth0 \
  -o macvlan_mode=bridge \
  macvlan_bridge

# Modo 802.1q trunk
docker network create -d macvlan \
  --subnet=192.168.32.0/24 \
  --gateway=192.168.32.1 \
  -o parent=eth0.10 \
  macvlan_trunk</code></pre></div></section></section></section><section class="detached"><h2 id="-1154622528#container-network-interface-cni" data-toc="container-network-interface-cni#container-networking.md-container-network-interface-cni">Container Network Interface (CNI)</h2><section class="detached"><h3 id="-1154622528#arquitetura-cni" data-toc="arquitetura-cni#container-networking.md-arquitetura-cni">Arquitetura CNI</h3><div class="detached code-block" id="-1154622528#-tyyazf_50"><pre><code class="language-none">
 CNI Pipeline                       

 ADD  CHECK  DEL                  
</code></pre></div></section><section class="detached"><h3 id="-1154622528#plugins-cni" data-toc="plugins-cni#container-networking.md-plugins-cni">Plugins CNI</h3><section class="detached"><h4 id="-1154622528#b-sicos" data-toc="b-sicos#container-networking.md-b-sicos">B&aacute;sicos</h4><ul class="list" id="-1154622528#-tyyazf_54" start="1"><li class="list-item" id="-1154622528#-tyyazf_55"><p id="-1154622528#-tyyazf_59">bridge</p></li><li class="list-item" id="-1154622528#-tyyazf_56"><p id="-1154622528#-tyyazf_60">host-local</p></li><li class="list-item" id="-1154622528#-tyyazf_57"><p id="-1154622528#-tyyazf_61">loopback</p></li><li class="list-item" id="-1154622528#-tyyazf_58"><p id="-1154622528#-tyyazf_62">dhcp</p></li></ul></section><section class="detached"><h4 id="-1154622528#metaplugins" data-toc="metaplugins#container-networking.md-metaplugins">Metaplugins</h4><ul class="list" id="-1154622528#-tyyazf_63" start="1"><li class="list-item" id="-1154622528#-tyyazf_64"><p id="-1154622528#-tyyazf_68">flannel</p></li><li class="list-item" id="-1154622528#-tyyazf_65"><p id="-1154622528#-tyyazf_69">tuning</p></li><li class="list-item" id="-1154622528#-tyyazf_66"><p id="-1154622528#-tyyazf_70">portmap</p></li><li class="list-item" id="-1154622528#-tyyazf_67"><p id="-1154622528#-tyyazf_71">bandwidth</p></li></ul></section><section class="detached"><h4 id="-1154622528#plugins-avan-ados" data-toc="plugins-avan-ados#container-networking.md-plugins-avan-ados">Plugins Avan&ccedil;ados</h4><ul class="list" id="-1154622528#-tyyazf_72" start="1"><li class="list-item" id="-1154622528#-tyyazf_73"><p id="-1154622528#-tyyazf_76">Calico</p><ul class="list" id="-1154622528#-tyyazf_77" start="1"><li class="list-item" id="-1154622528#-tyyazf_78"><p id="-1154622528#-tyyazf_81">BGP networking</p></li><li class="list-item" id="-1154622528#-tyyazf_79"><p id="-1154622528#-tyyazf_82">Network policies</p></li><li class="list-item" id="-1154622528#-tyyazf_80"><p id="-1154622528#-tyyazf_83">IPAM</p></li></ul></li><li class="list-item" id="-1154622528#-tyyazf_74"><p id="-1154622528#-tyyazf_84">Cilium</p><ul class="list" id="-1154622528#-tyyazf_85" start="1"><li class="list-item" id="-1154622528#-tyyazf_86"><p id="-1154622528#-tyyazf_89">eBPF-based networking</p></li><li class="list-item" id="-1154622528#-tyyazf_87"><p id="-1154622528#-tyyazf_90">L7 policies</p></li><li class="list-item" id="-1154622528#-tyyazf_88"><p id="-1154622528#-tyyazf_91">Observability</p></li></ul></li><li class="list-item" id="-1154622528#-tyyazf_75"><p id="-1154622528#-tyyazf_92">Weave</p><ul class="list" id="-1154622528#-tyyazf_93" start="1"><li class="list-item" id="-1154622528#-tyyazf_94"><p id="-1154622528#-tyyazf_97">Encrypted networking</p></li><li class="list-item" id="-1154622528#-tyyazf_95"><p id="-1154622528#-tyyazf_98">Service discovery</p></li><li class="list-item" id="-1154622528#-tyyazf_96"><p id="-1154622528#-tyyazf_99">Fast datapath</p></li></ul></li></ul></section></section></section><section class="detached"><h2 id="-1154622528#configura-o-de-rede" data-toc="configura-o-de-rede#container-networking.md-configura-o-de-rede">Configura&ccedil;&atilde;o de Rede</h2><section class="detached"><h3 id="-1154622528#port-mapping" data-toc="port-mapping#container-networking.md-port-mapping">Port Mapping</h3><div class="detached code-block" id="-1154622528#-tyyazf_102"><pre><code class="language-bash"># Exposio bsica
docker run -p 8080:80 nginx

# UDP ports
docker run -p 53:53/udp dns-server

# Mltiplos ports
docker run \
  -p 80:80 \
  -p 443:443 \
  -p 8080:8080 \
  web-server

# Range de portas
docker run -p 8080-8090:80-90 nginx</code></pre></div></section><section class="detached"><h3 id="-1154622528#dns-e-service-discovery" data-toc="dns-e-service-discovery#container-networking.md-dns-e-service-discovery">DNS e Service Discovery</h3><section class="detached"><h4 id="-1154622528#configura-o-dns" data-toc="configura-o-dns#container-networking.md-configura-o-dns">Configura&ccedil;&atilde;o DNS</h4><div class="detached code-block" id="-1154622528#-tyyazf_105"><pre><code class="language-yaml"># /etc/docker/daemon.json
{
  &quot;dns&quot;: [&quot;8.8.8.8&quot;, &quot;8.8.4.4&quot;],
  &quot;dns-search&quot;: [&quot;example.com&quot;],
  &quot;dns-opts&quot;: [&quot;ndots:2&quot;, &quot;timeout:2&quot;]
}</code></pre></div></section><section class="detached"><h4 id="-1154622528#docker-compose" data-toc="docker-compose#container-networking.md-docker-compose">Docker Compose</h4><div class="detached code-block" id="-1154622528#-tyyazf_106"><pre><code class="language-yaml">version: '3.8'
services:
  web:
    networks:
      frontend:
        aliases:
          - web.local
      backend:
        aliases:
          - web.internal
  api:
    networks:
      backend:
        ipv4_address: 172.16.238.10
        
networks:
  frontend:
    driver: bridge
    enable_ipv6: true
    ipam:
      driver: default
      config:
        - subnet: 172.16.238.0/24
        - subnet: &quot;2001:db8:1::/64&quot;
  backend:
    internal: true
    driver: bridge</code></pre></div></section></section></section><section class="detached"><h2 id="-1154622528#seguran-a-de-rede" data-toc="seguran-a-de-rede#container-networking.md-seguran-a-de-rede">Seguran&ccedil;a de Rede</h2><section class="detached"><h3 id="-1154622528#network-policies" data-toc="network-policies#container-networking.md-network-policies">Network Policies</h3><section class="detached"><h4 id="-1154622528#isolamento-b-sico" data-toc="isolamento-b-sico#container-networking.md-isolamento-b-sico">Isolamento B&aacute;sico</h4><div class="detached code-block" id="-1154622528#-tyyazf_111"><pre><code class="language-yaml">apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: default-deny
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress</code></pre></div></section><section class="detached"><h4 id="-1154622528#pol-ticas-avan-adas" data-toc="pol-ticas-avan-adas#container-networking.md-pol-ticas-avan-adas">Pol&iacute;ticas Avan&ccedil;adas</h4><div class="detached code-block" id="-1154622528#-tyyazf_112"><pre><code class="language-yaml">apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: api-allow
spec:
  podSelector:
    matchLabels:
      role: api
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          purpose: production
    ports:
    - protocol: TCP
      port: 8080
  egress:
  - to:
    - ipBlock:
        cidr: 10.0.0.0/24
        except:
        - 10.0.0.1/32
    ports:
    - protocol: TCP
      port: 5432</code></pre></div></section></section><section class="detached"><h3 id="-1154622528#isolamento" data-toc="isolamento#container-networking.md-isolamento">Isolamento</h3><section class="detached"><h4 id="-1154622528#t-cnicas-de-isolamento" data-toc="t-cnicas-de-isolamento#container-networking.md-t-cnicas-de-isolamento">T&eacute;cnicas de Isolamento</h4><ul class="list" id="-1154622528#-tyyazf_115" start="1"><li class="list-item" id="-1154622528#-tyyazf_116"><p id="-1154622528#-tyyazf_120">Network namespaces</p></li><li class="list-item" id="-1154622528#-tyyazf_117"><p id="-1154622528#-tyyazf_121">Bridge isolation</p></li><li class="list-item" id="-1154622528#-tyyazf_118"><p id="-1154622528#-tyyazf_122">VLAN tagging</p></li><li class="list-item" id="-1154622528#-tyyazf_119"><p id="-1154622528#-tyyazf_123">Security groups</p></li></ul></section><section class="detached"><h4 id="-1154622528#firewall-rules" data-toc="firewall-rules#container-networking.md-firewall-rules">Firewall Rules</h4><div class="detached code-block" id="-1154622528#-tyyazf_124"><pre><code class="language-bash"># Bloquear acesso externo
iptables -I DOCKER-USER -i ext_if ! -s 192.168.1.0/24 -j DROP

# Permitir apenas portas especficas
iptables -I DOCKER-USER -i ext_if -p tcp --dport 80 -j ACCEPT
iptables -I DOCKER-USER -i ext_if -p tcp --dport 443 -j ACCEPT</code></pre></div></section></section></section><section class="detached"><h2 id="-1154622528#troubleshooting" data-toc="troubleshooting#container-networking.md-troubleshooting">Troubleshooting</h2><section class="detached"><h3 id="-1154622528#ferramentas-de-diagn-stico" data-toc="ferramentas-de-diagn-stico#container-networking.md-ferramentas-de-diagn-stico">Ferramentas de Diagn&oacute;stico</h3><section class="detached"><h4 id="-1154622528#network-inspection" data-toc="network-inspection#container-networking.md-network-inspection">Network Inspection</h4><div class="detached code-block" id="-1154622528#-tyyazf_129"><pre><code class="language-bash"># Detalhes da rede
docker network inspect bridge

# Lista de endpoints
docker network inspect -f '{{range .Containers}}{{.Name}} {{.IPv4Address}}{{end}}' bridge

# Estatsticas de rede
docker stats --no-stream --format &quot;table {{.Container}}\t{{.NetIO}}&quot;</code></pre></div></section><section class="detached"><h4 id="-1154622528#debugging-tools" data-toc="debugging-tools#container-networking.md-debugging-tools">Debugging Tools</h4><div class="detached code-block" id="-1154622528#-tyyazf_130"><pre><code class="language-bash"># tcpdump
docker run --net=container:target \
  --privileged \
  nicolaka/netshoot \
  tcpdump -i any port 80

# netstat
docker exec container netstat -tulpn

# iptables
docker run --net=host --privileged \
  nicolaka/netshoot \
  iptables -nvL</code></pre></div></section></section><section class="detached"><h3 id="-1154622528#problemas-comuns" data-toc="problemas-comuns#container-networking.md-problemas-comuns">Problemas Comuns</h3><section class="detached"><h4 id="-1154622528#matriz-de-troubleshooting" data-toc="matriz-de-troubleshooting#container-networking.md-matriz-de-troubleshooting">Matriz de Troubleshooting</h4><div class="table-wrapper detached"><table id="-1154622528#-tyyazf_132"><tr class="header-row" id="-1154622528#-tyyazf_133"><th id="-1154622528#-tyyazf_138"><p>Problema</p></th><th id="-1154622528#-tyyazf_139"><p>Diagn&oacute;stico</p></th><th id="-1154622528#-tyyazf_140"><p>Solu&ccedil;&atilde;o</p></th><th id="-1154622528#-tyyazf_141"><p>Comando</p></th></tr><tr class="" id="-1154622528#-tyyazf_134"><td id="-1154622528#-tyyazf_142"><p>DNS</p></td><td id="-1154622528#-tyyazf_143"><p><span class="inline-code" id="-1154622528#-tyyazf_146">nslookup</span></p></td><td id="-1154622528#-tyyazf_144"><p>Verificar resolv.conf</p></td><td id="-1154622528#-tyyazf_145"><p><span class="inline-code" id="-1154622528#-tyyazf_147">docker exec container cat /etc/resolv.conf</span></p></td></tr><tr class="" id="-1154622528#-tyyazf_135"><td id="-1154622528#-tyyazf_148"><p>Conectividade</p></td><td id="-1154622528#-tyyazf_149"><p><span class="inline-code" id="-1154622528#-tyyazf_152">ping</span></p></td><td id="-1154622528#-tyyazf_150"><p>Verificar firewall</p></td><td id="-1154622528#-tyyazf_151"><p><span class="inline-code" id="-1154622528#-tyyazf_153">iptables -nvL</span></p></td></tr><tr class="" id="-1154622528#-tyyazf_136"><td id="-1154622528#-tyyazf_154"><p>Portas</p></td><td id="-1154622528#-tyyazf_155"><p><span class="inline-code" id="-1154622528#-tyyazf_158">netstat</span></p></td><td id="-1154622528#-tyyazf_156"><p>Verificar binding</p></td><td id="-1154622528#-tyyazf_157"><p><span class="inline-code" id="-1154622528#-tyyazf_159">netstat -tulpn</span></p></td></tr><tr class="" id="-1154622528#-tyyazf_137"><td id="-1154622528#-tyyazf_160"><p>Performance</p></td><td id="-1154622528#-tyyazf_161"><p><span class="inline-code" id="-1154622528#-tyyazf_164">iperf</span></p></td><td id="-1154622528#-tyyazf_162"><p>Testar bandwidth</p></td><td id="-1154622528#-tyyazf_163"><p><span class="inline-code" id="-1154622528#-tyyazf_165">iperf -c target</span></p></td></tr></table></div></section></section></section><section class="detached"><h2 id="-1154622528#monitoramento" data-toc="monitoramento#container-networking.md-monitoramento">Monitoramento</h2><section class="detached"><h3 id="-1154622528#m-tricas-de-rede" data-toc="m-tricas-de-rede#container-networking.md-m-tricas-de-rede">M&eacute;tricas de Rede</h3><section class="detached"><h4 id="-1154622528#b-sicas" data-toc="b-sicas#container-networking.md-b-sicas">B&aacute;sicas</h4><div class="detached code-block" id="-1154622528#-tyyazf_170"><pre><code class="language-bash"># Estatsticas bsicas
docker stats --format &quot;table {{.Name}}\t{{.NetIO}}&quot;

# IO detalhado
docker stats --no-stream --format &quot;table {{.Container}}\t{{.NetIO}}\t{{.BlockIO}}&quot;</code></pre></div></section><section class="detached"><h4 id="-1154622528#avan-adas" data-toc="avan-adas#container-networking.md-avan-adas">Avan&ccedil;adas</h4><div class="detached code-block" id="-1154622528#-tyyazf_171"><pre><code class="language-bash"># Monitoramento com cAdvisor
docker run \
  --volume=/:/rootfs:ro \
  --volume=/var/run:/var/run:ro \
  --volume=/sys:/sys:ro \
  --volume=/var/lib/docker/:/var/lib/docker:ro \
  --publish=8080:8080 \
  --detach=true \
  --name=cadvisor \
  google/cadvisor:latest</code></pre></div></section></section><section class="detached"><h3 id="-1154622528#logging" data-toc="logging#container-networking.md-logging">Logging</h3><section class="detached"><h4 id="-1154622528#configura-o-de-log" data-toc="configura-o-de-log#container-networking.md-configura-o-de-log">Configura&ccedil;&atilde;o de Log</h4><div class="detached code-block" id="-1154622528#-tyyazf_174"><pre><code class="language-json">{
  &quot;log-driver&quot;: &quot;json-file&quot;,
  &quot;log-opts&quot;: {
    &quot;max-size&quot;: &quot;10m&quot;,
    &quot;max-file&quot;: &quot;3&quot;
  }
}</code></pre></div></section><section class="detached"><h4 id="-1154622528#coleta-de-logs" data-toc="coleta-de-logs#container-networking.md-coleta-de-logs">Coleta de Logs</h4><div class="detached code-block" id="-1154622528#-tyyazf_175"><pre><code class="language-bash"># Logs de rede
docker logs --tail 100 -f container

# Eventos de rede
docker events --filter 'type=network'</code></pre></div></section></section></section><section class="detached"><h2 id="-1154622528#refer-ncias" data-toc="refer-ncias#container-networking.md-refer-ncias">Refer&ecirc;ncias</h2><section class="detached"><h3 id="-1154622528#documenta-o" data-toc="documenta-o#container-networking.md-documenta-o">Documenta&ccedil;&atilde;o</h3><ul class="list" id="-1154622528#-tyyazf_180" start="1"><li class="list-item" id="-1154622528#-tyyazf_181"><p id="-1154622528#-tyyazf_184">Docker Networking Overview (<a href="https://docs.docker.com/network/">https://docs.docker.com/network/</a>)</p></li><li class="list-item" id="-1154622528#-tyyazf_182"><p id="-1154622528#-tyyazf_186">CNI Specification (<a href="https://github.com/containernetworking/cni/blob/master/SPEC.md">https://github.com/containernetworking/cni/blob/master/SPEC.md</a>)</p></li><li class="list-item" id="-1154622528#-tyyazf_183"><p id="-1154622528#-tyyazf_188">Libnetwork Design (<a href="https://github.com/docker/libnetwork/blob/master/docs/design.md">https://github.com/docker/libnetwork/blob/master/docs/design.md</a>)</p></li></ul></section><section class="detached"><h3 id="-1154622528#ferramentas" data-toc="ferramentas#container-networking.md-ferramentas">Ferramentas</h3><ul class="list" id="-1154622528#-tyyazf_190" start="1"><li class="list-item" id="-1154622528#-tyyazf_191"><p id="-1154622528#-tyyazf_194">Netshoot (<a href="https://github.com/nicolaka/netshoot">https://github.com/nicolaka/netshoot</a>)</p></li><li class="list-item" id="-1154622528#-tyyazf_192"><p id="-1154622528#-tyyazf_196">Network Debug Tools (<a href="https://github.com/docker/docker-diagnose">https://github.com/docker/docker-diagnose</a>)</p></li><li class="list-item" id="-1154622528#-tyyazf_193"><p id="-1154622528#-tyyazf_198">Network Plugins (<a href="https://github.com/containernetworking/plugins">https://github.com/containernetworking/plugins</a>)</p></li></ul></section><section class="detached"><h3 id="-1154622528#tutoriais-avan-ados" data-toc="tutoriais-avan-ados#container-networking.md-tutoriais-avan-ados">Tutoriais Avan&ccedil;ados</h3><ul class="list" id="-1154622528#-tyyazf_200" start="1"><li class="list-item" id="-1154622528#-tyyazf_201"><p id="-1154622528#-tyyazf_204">Multi-host Networking (<a href="https://docs.docker.com/network/overlay/">https://docs.docker.com/network/overlay/</a>)</p></li><li class="list-item" id="-1154622528#-tyyazf_202"><p id="-1154622528#-tyyazf_206">Network Security (<a href="https://docs.docker.com/network/security/">https://docs.docker.com/network/security/</a>)</p></li><li class="list-item" id="-1154622528#-tyyazf_203"><p id="-1154622528#-tyyazf_208">Custom Network Plugins (<a href="https://docs.docker.com/engine/extend/plugins_network/">https://docs.docker.com/engine/extend/plugins_network/</a>)</p></li></ul></section><section class="detached"><h3 id="-1154622528#recursos-adicionais" data-toc="recursos-adicionais#container-networking.md-recursos-adicionais">Recursos Adicionais</h3><ul class="list" id="-1154622528#-tyyazf_210" start="1"><li class="list-item" id="-1154622528#-tyyazf_211"><p id="-1154622528#-tyyazf_214">Docker Network Troubleshooting Guide (<a href="https://success.docker.com/article/troubleshooting-container-networking">https://success.docker.com/article/troubleshooting-container-networking</a>)</p></li><li class="list-item" id="-1154622528#-tyyazf_212"><p id="-1154622528#-tyyazf_216">Container Network Interface Specification (<a href="https://github.com/containernetworking/cni/blob/master/SPEC.md">https://github.com/containernetworking/cni/blob/master/SPEC.md</a>)</p></li><li class="list-item" id="-1154622528#-tyyazf_213"><p id="-1154622528#-tyyazf_218">Docker Network Architecture (<a href="https://docs.docker.com/engine/userguide/networking/dockernetworks/">https://docs.docker.com/engine/userguide/networking/dockernetworks/</a>)</p></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1338613457">Container Storage: Cr&ocirc;nicas dos Dados Perdidos <span class="no-bold"></span></h1><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-1338613457#-rbrtey_13">&quot;Em um mundo onde dados s&atilde;o mais valiosos que cr&eacute;ditos digitais, a arte do armazenamento em containers &eacute; como dan&ccedil;a macabra entre persist&ecirc;ncia e efemeridade.&quot; - Mem&oacute;rias de um DBA Cybern&eacute;tico</p></div>
</blockquote>
<section class="detached"><h2 id="-1338613457#o-teatro-das-sombras-bin-rias" data-toc="o-teatro-das-sombras-bin-rias#container-storage.md-o-teatro-das-sombras-bin-rias">O Teatro das Sombras Bin&aacute;rias <span class="no-bold"></span></h2><div class="detached code-block" id="-1338613457#-rbrtey_14"><pre><code class="language-none">
  STORAGE MATRIX: O PARADOXO DA PERSISTNCIA   
                                               
  &quot;Todos os dados so efmeros,               
   at que precisemos deles novamente&quot;         
                                               
</code></pre></div><section class="detached"><h3 id="-1338613457#a-anatomia-do-vazio-digital" data-toc="a-anatomia-do-vazio-digital#container-storage.md-a-anatomia-do-vazio-digital">A Anatomia do Vazio Digital</h3><p id="-1338613457#-rbrtey_16">Ah, caro aventureiro dos bytes! Permita-me gui&aacute;-lo atrav&eacute;s deste labirinto de dados, onde containers nascem e morrem como sonhos em uma noite de ne&oacute;n, levando consigo seus preciosos dados... ou ser&aacute; que n&atilde;o?</p><div class="detached code-block" id="-1338613457#-rbrtey_17"><pre><code class="language-none">
    Container Life &amp; Death       

       
  Efmero  vs Persistente   
       
    &quot;Memento Mori Digital&quot;      
</code></pre></div></section></section><section class="detached"><h2 id="-1338613457#os-tr-s-cavaleiros-do-armazenamento" data-toc="os-tr-s-cavaleiros-do-armazenamento#container-storage.md-os-tr-s-cavaleiros-do-armazenamento">Os Tr&ecirc;s Cavaleiros do Armazenamento <span class="no-bold"></span></h2><section class="detached"><h3 id="-1338613457#1-volumes-o-imortal-digital" data-toc="1-volumes-o-imortal-digital#container-storage.md-1-volumes-o-imortal-digital">1. Volumes: O Imortal Digital</h3><p id="-1338613457#-rbrtey_21">Como vampiros em um romance g&oacute;tico-tech, os volumes Docker persistem al&eacute;m da morte de seus containers.</p><div class="detached code-block" id="-1338613457#-rbrtey_22"><pre><code class="language-bash"># Invocando o ritual do volume
docker volume create dados-imortais
docker run -v dados-imortais:/data nginx
# &quot;Nem mesmo um 'docker rm -f' pode matar estes dados&quot;</code></pre></div></section><section class="detached"><h3 id="-1338613457#2-bind-mounts-as-correntes-digitais" data-toc="2-bind-mounts-as-correntes-digitais#container-storage.md-2-bind-mounts-as-correntes-digitais">2. Bind Mounts: As Correntes Digitais</h3><p id="-1338613457#-rbrtey_23">Como fantasmas acorrentados a uma mans&atilde;o antiga, bind mounts ligam seu container ao mundo mortal do host.</p><div class="detached code-block" id="-1338613457#-rbrtey_24"><pre><code class="language-bash"># O ritual de ligao
docker run -v /home/user/dados:/app/dados nginx
# &quot;Presos para sempre ao sistema host, como uma maldio digital&quot;</code></pre></div></section><section class="detached"><h3 id="-1338613457#3-tmpfs-o-sussurro-ef-mero" data-toc="3-tmpfs-o-sussurro-ef-mero#container-storage.md-3-tmpfs-o-sussurro-ef-mero">3. tmpfs: O Sussurro Ef&ecirc;mero</h3><p id="-1338613457#-rbrtey_25">Como pensamentos em uma mente cibern&eacute;tica, tmpfs existe apenas na mem&oacute;ria vol&aacute;til.</p><div class="detached code-block" id="-1338613457#-rbrtey_26"><pre><code class="language-bash"># A dana do esquecimento
docker run --tmpfs /app/temp nginx
# &quot;Aqui jazem dados temporrios, que viveram rpido e morreram jovens&quot;</code></pre></div></section></section><section class="detached"><h2 id="-1338613457#o-overlay2-dan-a-das-camadas" data-toc="o-overlay2-dan-a-das-camadas#container-storage.md-o-overlay2-dan-a-das-camadas">O Overlay2: Dan&ccedil;a das Camadas <span class="no-bold"></span></h2><section class="detached"><h3 id="-1338613457#a-valsa-das-camadas" data-toc="a-valsa-das-camadas#container-storage.md-a-valsa-das-camadas">A Valsa das Camadas</h3><p id="-1338613457#-rbrtey_28">Como um baile de m&aacute;scaras digital, onde cada camada esconde segredos:</p><div class="detached code-block" id="-1338613457#-rbrtey_29"><pre><code class="language-none">
    Container Layer         

    Upper Layer (RW)       

    Lower Layer (RO)       

    Base Image             

&quot;Cada camada, uma histria no contada&quot;</code></pre></div></section></section><section class="detached"><h2 id="-1338613457#storage-drivers-os-necromantes" data-toc="storage-drivers-os-necromantes#container-storage.md-storage-drivers-os-necromantes">Storage Drivers: Os Necromantes <span class="no-bold"></span>&zwj;</h2><section class="detached"><h3 id="-1338613457#o-pante-o-dos-drivers" data-toc="o-pante-o-dos-drivers#container-storage.md-o-pante-o-dos-drivers">O Pante&atilde;o dos Drivers</h3><ul class="list" id="-1338613457#-rbrtey_31" start="1"><li class="list-item" id="-1338613457#-rbrtey_33"><p id="-1338613457#-rbrtey_38"><span class="control" id="-1338613457#-rbrtey_39">overlay2</span>: O pr&iacute;ncipe herdeiro, elegante e eficiente</p></li><li class="list-item" id="-1338613457#-rbrtey_34"><p id="-1338613457#-rbrtey_40"><span class="control" id="-1338613457#-rbrtey_41">devicemapper</span>: O velho rei, complexo mas poderoso</p></li><li class="list-item" id="-1338613457#-rbrtey_35"><p id="-1338613457#-rbrtey_42"><span class="control" id="-1338613457#-rbrtey_43">btrfs</span>: O m&iacute;stico incompreendido</p></li><li class="list-item" id="-1338613457#-rbrtey_36"><p id="-1338613457#-rbrtey_44"><span class="control" id="-1338613457#-rbrtey_45">zfs</span>: O mago das pools</p></li><li class="list-item" id="-1338613457#-rbrtey_37"><p id="-1338613457#-rbrtey_46"><span class="control" id="-1338613457#-rbrtey_47">aufs</span>: O ancestral aposentado</p></li></ul><div class="detached code-block" id="-1338613457#-rbrtey_32"><pre><code class="language-none">
  DRIVER SELECTION MATRIX       
                                
  &quot;Escolha seu veneno digital&quot;  
</code></pre></div></section></section><section class="detached"><h2 id="-1338613457#waifu-storage-tips" data-toc="waifu-storage-tips#container-storage.md-waifu-storage-tips">Waifu Storage Tips <span class="no-bold"></span></h2><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-1338613457#-rbrtey_50"><span class="control" id="-1338613457#-rbrtey_51">Volume-chan avisa</span>: &quot;Seus dados s&atilde;o como primeiros amores - guarde-os em volumes, ou chore sua perda eternamente! uwu&quot;</p></div>
</blockquote>
<blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-1338613457#-rbrtey_52"><span class="control" id="-1338613457#-rbrtey_53">Backup-sama declara</span>: &quot;Na matrix dos containers, n&atilde;o existem segundas chances... a menos que voc&ecirc; tenha um backup. Ara ara~&quot;</p></div>
</blockquote>
</section><section class="detached"><h2 id="-1338613457#rituais-de-performance" data-toc="rituais-de-performance#container-storage.md-rituais-de-performance">Rituais de Performance <span class="no-bold"></span>&zwj;</h2><section class="detached"><h3 id="-1338613457#o-cache-dance" data-toc="o-cache-dance#container-storage.md-o-cache-dance">O Cache Dance</h3><div class="detached code-block" id="-1338613457#-rbrtey_56"><pre><code class="language-bash"># O ritual do cache
--volume-opt size=20G
--volume-opt o=size=20G
# &quot;Dana mais rpido, meu precioso cache!&quot;</code></pre></div></section><section class="detached"><h3 id="-1338613457#a-arte-da-otimiza-o" data-toc="a-arte-da-otimiza-o#container-storage.md-a-arte-da-otimiza-o">A Arte da Otimiza&ccedil;&atilde;o</h3><div class="detached code-block" id="-1338613457#-rbrtey_57"><pre><code class="language-yaml">volumes:
  data:
    driver: local
    driver_opts:
      type: 'none'
      o: 'bind'
      device: '/data/mysql'
# &quot;Configurao  poesia em YAML&quot;</code></pre></div></section></section><section class="detached"><h2 id="-1338613457#troubleshooting-necropsia-digital" data-toc="troubleshooting-necropsia-digital#container-storage.md-troubleshooting-necropsia-digital">Troubleshooting: Necropsia Digital <span class="no-bold"></span></h2><section class="detached"><h3 id="-1338613457#sinais-do-al-m" data-toc="sinais-do-al-m#container-storage.md-sinais-do-al-m">Sinais do Al&eacute;m</h3><div class="detached code-block" id="-1338613457#-rbrtey_59"><pre><code class="language-bash"># Investigando anomalias
docker volume ls
docker volume inspect meu-volume
# &quot;Cada erro conta uma histria macabra&quot;</code></pre></div></section></section><section class="detached"><h2 id="-1338613457#exerc-cios-para-os-destemidos" data-toc="exerc-cios-para-os-destemidos#container-storage.md-exerc-cios-para-os-destemidos">Exerc&iacute;cios Para os Destemidos <span class="no-bold"></span></h2><ol class="list list-decimal" id="-1338613457#-rbrtey_60" type="1" start="1"><li class="list-item" id="-1338613457#-rbrtey_61"><p id="-1338613457#-rbrtey_64"><span class="control" id="-1338613457#-rbrtey_65">A Cripta</span>: Configure um volume persistente sem perder dados</p></li><li class="list-item" id="-1338613457#-rbrtey_62"><p id="-1338613457#-rbrtey_66"><span class="control" id="-1338613457#-rbrtey_67">O Espelho</span>: Sincronize dados entre host e container</p></li><li class="list-item" id="-1338613457#-rbrtey_63"><p id="-1338613457#-rbrtey_68"><span class="control" id="-1338613457#-rbrtey_69">O Vazio</span>: Gerencie tmpfs sem crashar a mem&oacute;ria</p></li></ol></section><section class="detached"><h2 id="-1338613457#palavras-finais" data-toc="palavras-finais#container-storage.md-palavras-finais">Palavras Finais</h2><p id="-1338613457#-rbrtey_70">Como diria o enigm&aacute;tico DevOps Poe: &quot;Em cada container mora um dado, esperando para ser perdido ou salvo. A escolha, meu caro operador, &eacute; sua.&quot;</p><blockquote class="prompt flex bordered-element-rounded tip detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="-1338613457#-rbrtey_73">&quot;E assim terminamos nossa jornada pelos calabou&ccedil;os do armazenamento. Lembre-se: na pr&oacute;xima vez que seus dados desaparecerem com um container, n&atilde;o foi um bug - foi apenas o karma digital cobrando seu pre&ccedil;o.&quot; - Chronicles of a Storage Engineer, 2084</p></div>
</blockquote>
</section></article></div></section></div></body></html>